{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport { createCustomIcon, createBrandLogo } from '../utils/iconHelpers';\nimport { guardarCoordenadaCorregida } from '../services/apiService';\nconst IconMarkersLayer = ({\n  markers,\n  markersForMercado,\n  selectedRegion,\n  baseCompData\n}) => {\n  _s();\n  const map = useMap();\n  const markersRef = useRef({});\n  const zoomUpdateRef = useRef(null);\n  const [showingAssociated, setShowingAssociated] = useState(false);\n  const [modoCorreccion, setModoCorreccion] = useState(null); // ‚úÖ NUEVO\n\n  // ‚úÖ FUNCIONES GLOBALES PARA CORRECCI√ìN DE COORDENADAS\n  useEffect(() => {\n    window.activarCorreccionCoordenadas = (pbl, eds) => {\n      console.log('üéØ Modo correcci√≥n activado para PBL:', pbl);\n      if (map) {\n        map.getContainer().style.cursor = 'crosshair';\n      }\n      setModoCorreccion({\n        pbl,\n        eds,\n        lat: null,\n        lng: null\n      });\n      const btnGuardar = document.getElementById(`guardar-coord-${pbl}`);\n      if (btnGuardar) {\n        btnGuardar.disabled = true;\n        btnGuardar.style.opacity = '0.5';\n      }\n      const btnActivar = document.getElementById(`activar-coord-${pbl}`);\n      if (btnActivar) {\n        btnActivar.textContent = 'Click en mapa...';\n        btnActivar.style.background = '#ffc107';\n      }\n    };\n    window.guardarCorreccionCoordenadas = async (pbl, eds) => {\n      if (!modoCorreccion || !modoCorreccion.lat || !modoCorreccion.lng) {\n        alert('‚ö†Ô∏è Primero selecciona una ubicaci√≥n en el mapa');\n        return;\n      }\n      try {\n        const coordenada = {\n          pbl: pbl,\n          eds: eds,\n          lat_corregida: modoCorreccion.lat,\n          lon_corregida: modoCorreccion.lng\n        };\n        await guardarCoordenadaCorregida(coordenada);\n        console.log('‚úÖ Coordenada guardada:', coordenada);\n        alert('‚úÖ Coordenada guardada correctamente');\n        setModoCorreccion(null);\n        if (map) {\n          map.getContainer().style.cursor = '';\n        }\n        window.location.reload();\n      } catch (error) {\n        console.error('‚ùå Error al guardar:', error);\n        alert('‚ùå Error al guardar coordenada');\n      }\n    };\n    return () => {\n      delete window.activarCorreccionCoordenadas;\n      delete window.guardarCorreccionCoordenadas;\n    };\n  }, [map, modoCorreccion]);\n\n  // ‚úÖ EVENTO: Click en el mapa para capturar coordenadas\n  useEffect(() => {\n    if (!map || !modoCorreccion) return;\n    const handleMapClick = e => {\n      const {\n        lat,\n        lng\n      } = e.latlng;\n      console.log('üìç Coordenadas seleccionadas:', {\n        lat,\n        lng\n      });\n      setModoCorreccion(prev => ({\n        ...prev,\n        lat: lat,\n        lng: lng\n      }));\n      const latSpan = document.getElementById(`lat-actual-${modoCorreccion.pbl}`);\n      const lngSpan = document.getElementById(`lon-actual-${modoCorreccion.pbl}`);\n      if (latSpan) latSpan.textContent = lat.toFixed(6);\n      if (lngSpan) lngSpan.textContent = lng.toFixed(6);\n      const btnGuardar = document.getElementById(`guardar-coord-${modoCorreccion.pbl}`);\n      if (btnGuardar) {\n        btnGuardar.disabled = false;\n        btnGuardar.style.opacity = '1';\n      }\n      const btnActivar = document.getElementById(`activar-coord-${modoCorreccion.pbl}`);\n      if (btnActivar) {\n        btnActivar.textContent = 'Coord. Seleccionada ‚úì';\n        btnActivar.style.background = '#28a745';\n      }\n      map.getContainer().style.cursor = '';\n    };\n    map.on('click', handleMapClick);\n    return () => {\n      map.off('click', handleMapClick);\n    };\n  }, [map, modoCorreccion]);\n  const clearMarkers = useCallback(() => {\n    if (!map) return;\n    Object.values(markersRef.current).forEach(marker => {\n      try {\n        if (map.hasLayer(marker)) map.removeLayer(marker);\n      } catch {}\n    });\n    markersRef.current = {};\n  }, [map]);\n  const makeDraggable = useCallback(popup => {\n    if (!map || !popup || !popup.getElement) return;\n    const el = popup.getElement();\n    if (!el) return;\n    try {\n      const wrapper = el.querySelector('.leaflet-popup-content-wrapper');\n      if (!wrapper) return;\n      const draggable = new L.Draggable(el, wrapper);\n      draggable.enable();\n    } catch {}\n  }, [map]);\n  const generarPopupContent = useCallback((marker, datosTabla, tablaPreciosHtml, variant = 'primary') => {\n    const isSecondary = variant === 'secondary';\n    const logoUrl = marker.logo ? marker.logo.startsWith('http') ? marker.logo : `https://api.bencinaenlinea.cl${marker.logo}` : '';\n    let content = `\n      <div class=\"icon-markers-popup-content\">\n        <div class=\"popup-info-header\" style=\"position: relative;\">\n          ${logoUrl ? `\n            <img \n              src=\"${logoUrl}\" \n              alt=\"Logo ${marker.Marca}\" \n              class=\"popup-logo\"\n              onerror=\"this.style.display='none';\"\n            />\n          ` : ''}\n          \n          <div class=\"popup-info-row\">\n            <span class=\"popup-label\">PBL:</span>\n            <span class=\"popup-value\">${marker.pbl || '-'}</span>\n          </div>\n          <div class=\"popup-info-row\">\n            <span class=\"popup-label\">Estaci√≥n:</span>\n            <span class=\"popup-value\">${marker.nombre || '-'}</span>\n          </div>\n          <div class=\"popup-info-row\">\n            <span class=\"popup-label\">Jefe Zona:</span>\n            <span class=\"popup-value\">${marker.Marca || '-'}</span>\n          </div>\n          <div class=\"popup-info-row\">\n            <span class=\"popup-label\">Operaci√≥n:</span>\n            <span class=\"popup-value\">Comisionista</span>\n          </div>\n        </div>\n\n        <div class=\"popup-tabs-container\">\n          <div class=\"popup-tabs-header\">\n            <button class=\"popup-tab-button active\" data-tab=\"precios\">Precios</button>\n            <button class=\"popup-tab-button\" data-tab=\"coordenadas\">Coordenadas</button>\n            <button class=\"popup-tab-button\" data-tab=\"informacion\">Informaci√≥n</button>\n          </div>\n\n          <div class=\"popup-tabs-content\">\n            <!-- TAB 1: PRECIOS -->\n            <div class=\"popup-tab-pane active\" data-tab=\"precios\">\n              ${tablaPreciosHtml}\n            </div>\n\n            <!-- TAB 2: COORDENADAS ‚úÖ MODIFICADO -->\n            <div class=\"popup-tab-pane\" data-tab=\"coordenadas\">\n              <div class=\"popup-info-box\">\n                <p><strong>Lat corregida:</strong> <span id=\"lat-actual-${marker.pbl}\">${marker.lat.toFixed(6)}</span></p>\n                <p><strong>Lon corregida:</strong> <span id=\"lon-actual-${marker.pbl}\">${marker.lng.toFixed(6)}</span></p>\n                <hr style=\"margin: 8px 0; border: none; border-top: 1px solid #dee2e6;\">\n                <p><strong>Lat original:</strong> ${marker.lat_original ? marker.lat_original.toFixed(6) : '-'}</p>\n                <p><strong>Lon original:</strong> ${marker.lng_original ? marker.lng_original.toFixed(6) : '-'}</p>\n              </div>\n              \n              <div style=\"display: flex; gap: 8px; margin-top: 10px;\">\n                <button \n                  id=\"activar-coord-${marker.pbl}\"\n                  style=\"flex: 1; padding: 8px; background: #17a2b8; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;\"\n                  onclick=\"window.activarCorreccionCoordenadas('${marker.pbl}', '${marker.eds}')\"\n                >\n                  Activar Coord\n                </button>\n                \n                <button \n                  id=\"guardar-coord-${marker.pbl}\"\n                  style=\"flex: 1; padding: 8px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; opacity: 0.5;\"\n                  onclick=\"window.guardarCorreccionCoordenadas('${marker.pbl}', '${marker.eds}')\"\n                  disabled\n                >\n                  Guardar\n                </button>\n              </div>\n            </div>\n\n            <!-- TAB 3: INFORMACI√ìN -->\n            <div class=\"popup-tab-pane\" data-tab=\"informacion\">\n              <div class=\"popup-info-box\">\n                <p><strong>EDS:</strong> ${marker.eds || '-'}</p>\n                <p><strong>Direcci√≥n:</strong> ${marker.direccion || '-'}</p>\n                ${marker.Guerra_Precio === 'Si' ? `<p><strong style=\"color: #d9534f;\">‚ö†Ô∏è Guerra de Precio Activa</strong></p>` : ''}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    `;\n    if (marker.pbl && (marker.Marca === 'Aramco' || marker.Marca === 'Petrobras')) {\n      content += `<button class=\"popup-button-mercado ${isSecondary ? 'secondary' : ''}\" onclick=\"window.showAssociatedIds && window.showAssociatedIds(${marker.pbl}, ${marker.lat}, ${marker.lng}, '${marker.id}')\">Mercado</button>`;\n    }\n    return content;\n  }, []);\n  const bindPopupWithMercado = useCallback((leafletMarker, marker) => {\n    const preciosHistoricos = marker.preciosHistoricos || [];\n    let tablaPreciosHtml = '<div class=\"popup-table-wrapper\"><table class=\"popup-table\"><thead><tr>';\n    tablaPreciosHtml += '<th>Fecha</th><th>G93</th><th>G95</th><th>G97</th><th>Diesel</th><th>Kero</th></tr></thead><tbody>';\n    if (preciosHistoricos.length > 0) {\n      preciosHistoricos.forEach(precio => {\n        tablaPreciosHtml += `<tr>\n          <td>${precio.Actualizacion || '-'}</td>\n          <td>${precio.G93 || '-'}</td>\n          <td>${precio.G95 || '-'}</td>\n          <td>${precio.G97 || '-'}</td>\n          <td>${precio.Diesel || '-'}</td>\n          <td>${precio.Kerosene || '-'}</td>\n        </tr>`;\n      });\n    } else {\n      tablaPreciosHtml += '<tr><td colspan=\"6\">No hay datos disponibles</td></tr>';\n    }\n    tablaPreciosHtml += '</tbody></table></div>';\n    const popupHtml = generarPopupContent(marker, null, tablaPreciosHtml, 'primary');\n    leafletMarker.bindPopup(popupHtml, {\n      maxWidth: 500,\n      className: 'custom-popup'\n    });\n    leafletMarker.on('popupopen', e => {\n      const popup = e.popup;\n      makeDraggable(popup);\n      setTimeout(() => {\n        const tabButtons = document.querySelectorAll('.popup-tab-button');\n        const tabPanes = document.querySelectorAll('.popup-tab-pane');\n        tabButtons.forEach(button => {\n          button.addEventListener('click', () => {\n            tabButtons.forEach(btn => btn.classList.remove('active'));\n            tabPanes.forEach(pane => pane.classList.remove('active'));\n            button.classList.add('active');\n            const tab = button.getAttribute('data-tab');\n            const pane = document.querySelector(`.popup-tab-pane[data-tab=\"${tab}\"]`);\n            if (pane) pane.classList.add('active');\n          });\n        });\n      }, 100);\n    });\n  }, [generarPopupContent, makeDraggable]);\n  useEffect(() => {\n    if (!map || !markers) return;\n    clearMarkers();\n    markers.forEach(marker => {\n      try {\n        const icon = createCustomIcon(marker);\n        const leafletMarker = L.marker([marker.lat, marker.lng], {\n          icon\n        });\n        bindPopupWithMercado(leafletMarker, marker);\n        leafletMarker.addTo(map);\n        markersRef.current[marker.id] = leafletMarker;\n      } catch (error) {\n        console.error('Error creating marker:', error);\n      }\n    });\n    return () => clearMarkers();\n  }, [map, markers, bindPopupWithMercado, clearMarkers]);\n  useEffect(() => {\n    window.showAssociatedIds = (pbl, lat, lng, mainId) => {\n      if (!map || !markersForMercado) return;\n      clearMarkers();\n      setShowingAssociated(true);\n      const filtered = markersForMercado.filter(m => m.pbl === pbl);\n      if (filtered.length === 0) {\n        console.warn('No associated markers found for PBL:', pbl);\n        return;\n      }\n      filtered.forEach(marker => {\n        try {\n          const isMain = marker.id === mainId;\n          const variant = isMain ? 'primary' : 'secondary';\n          const icon = isMain ? createCustomIcon(marker) : createBrandLogo(marker.Marca, marker);\n          const leafletMarker = L.marker([marker.lat, marker.lng], {\n            icon\n          });\n          const preciosHistoricos = marker.preciosHistoricos || [];\n          let tablaPreciosHtml = `<div class=\"popup-table-wrapper ${variant === 'secondary' ? 'secondary' : ''}\"><table class=\"popup-table ${variant === 'secondary' ? 'secondary' : ''}\"><thead><tr>`;\n          tablaPreciosHtml += '<th>Fecha</th><th>G93</th><th>G95</th><th>G97</th><th>Diesel</th><th>Kero</th></tr></thead><tbody>';\n          if (preciosHistoricos.length > 0) {\n            preciosHistoricos.forEach(precio => {\n              tablaPreciosHtml += `<tr>\n                <td>${precio.Actualizacion || '-'}</td>\n                <td>${precio.G93 || '-'}</td>\n                <td>${precio.G95 || '-'}</td>\n                <td>${precio.G97 || '-'}</td>\n                <td>${precio.Diesel || '-'}</td>\n                <td>${precio.Kerosene || '-'}</td>\n              </tr>`;\n            });\n          } else {\n            tablaPreciosHtml += '<tr><td colspan=\"6\">No hay datos disponibles</td></tr>';\n          }\n          tablaPreciosHtml += '</tbody></table></div>';\n          const popupHtml = generarPopupContent(marker, null, tablaPreciosHtml, variant);\n          leafletMarker.bindPopup(popupHtml, {\n            maxWidth: 500,\n            className: 'custom-popup'\n          });\n          leafletMarker.on('popupopen', e => {\n            const popup = e.popup;\n            makeDraggable(popup);\n            setTimeout(() => {\n              const tabButtons = document.querySelectorAll('.popup-tab-button');\n              const tabPanes = document.querySelectorAll('.popup-tab-pane');\n              tabButtons.forEach(button => {\n                button.addEventListener('click', () => {\n                  tabButtons.forEach(btn => btn.classList.remove('active'));\n                  tabPanes.forEach(pane => pane.classList.remove('active'));\n                  button.classList.add('active');\n                  const tab = button.getAttribute('data-tab');\n                  const pane = document.querySelector(`.popup-tab-pane[data-tab=\"${tab}\"]`);\n                  if (pane) pane.classList.add('active');\n                });\n              });\n            }, 100);\n          });\n          leafletMarker.addTo(map);\n          markersRef.current[marker.id] = leafletMarker;\n        } catch (error) {\n          console.error('Error creating associated marker:', error);\n        }\n      });\n      if (lat && lng) {\n        map.setView([lat, lng], 15);\n      }\n    };\n    return () => {\n      delete window.showAssociatedIds;\n    };\n  }, [map, markersForMercado, generarPopupContent, makeDraggable, clearMarkers]);\n  return null;\n};\n_s(IconMarkersLayer, \"t7W0uARBQIs1rU72DCYKVlkw+x0=\", false, function () {\n  return [useMap];\n});\n_c = IconMarkersLayer;\nexport default IconMarkersLayer;\nvar _c;\n$RefreshReg$(_c, \"IconMarkersLayer\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","useMap","L","createCustomIcon","createBrandLogo","guardarCoordenadaCorregida","IconMarkersLayer","markers","markersForMercado","selectedRegion","baseCompData","_s","map","markersRef","zoomUpdateRef","showingAssociated","setShowingAssociated","modoCorreccion","setModoCorreccion","window","activarCorreccionCoordenadas","pbl","eds","console","log","getContainer","style","cursor","lat","lng","btnGuardar","document","getElementById","disabled","opacity","btnActivar","textContent","background","guardarCorreccionCoordenadas","alert","coordenada","lat_corregida","lon_corregida","location","reload","error","handleMapClick","e","latlng","prev","latSpan","lngSpan","toFixed","on","off","clearMarkers","Object","values","current","forEach","marker","hasLayer","removeLayer","makeDraggable","popup","getElement","el","wrapper","querySelector","draggable","Draggable","enable","generarPopupContent","datosTabla","tablaPreciosHtml","variant","isSecondary","logoUrl","logo","startsWith","content","Marca","nombre","lat_original","lng_original","direccion","Guerra_Precio","id","bindPopupWithMercado","leafletMarker","preciosHistoricos","length","precio","Actualizacion","G93","G95","G97","Diesel","Kerosene","popupHtml","bindPopup","maxWidth","className","setTimeout","tabButtons","querySelectorAll","tabPanes","button","addEventListener","btn","classList","remove","pane","add","tab","getAttribute","icon","addTo","showAssociatedIds","mainId","filtered","filter","m","warn","isMain","setView","_c","$RefreshReg$"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/IconMarkersLayer.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { useMap } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport { createCustomIcon, createBrandLogo } from '../utils/iconHelpers';\r\nimport { guardarCoordenadaCorregida } from '../services/apiService';\r\n\r\nconst IconMarkersLayer = ({ \r\n  markers,\r\n  markersForMercado,\r\n  selectedRegion,\r\n  baseCompData \r\n}) => {\r\n  const map = useMap();\r\n  const markersRef = useRef({});\r\n  const zoomUpdateRef = useRef(null);\r\n  const [showingAssociated, setShowingAssociated] = useState(false);\r\n  const [modoCorreccion, setModoCorreccion] = useState(null); // ‚úÖ NUEVO\r\n\r\n  // ‚úÖ FUNCIONES GLOBALES PARA CORRECCI√ìN DE COORDENADAS\r\n  useEffect(() => {\r\n    window.activarCorreccionCoordenadas = (pbl, eds) => {\r\n      console.log('üéØ Modo correcci√≥n activado para PBL:', pbl);\r\n      \r\n      if (map) {\r\n        map.getContainer().style.cursor = 'crosshair';\r\n      }\r\n      \r\n      setModoCorreccion({ pbl, eds, lat: null, lng: null });\r\n      \r\n      const btnGuardar = document.getElementById(`guardar-coord-${pbl}`);\r\n      if (btnGuardar) {\r\n        btnGuardar.disabled = true;\r\n        btnGuardar.style.opacity = '0.5';\r\n      }\r\n      \r\n      const btnActivar = document.getElementById(`activar-coord-${pbl}`);\r\n      if (btnActivar) {\r\n        btnActivar.textContent = 'Click en mapa...';\r\n        btnActivar.style.background = '#ffc107';\r\n      }\r\n    };\r\n\r\n    window.guardarCorreccionCoordenadas = async (pbl, eds) => {\r\n      if (!modoCorreccion || !modoCorreccion.lat || !modoCorreccion.lng) {\r\n        alert('‚ö†Ô∏è Primero selecciona una ubicaci√≥n en el mapa');\r\n        return;\r\n      }\r\n\r\n      try {\r\n        const coordenada = {\r\n          pbl: pbl,\r\n          eds: eds,\r\n          lat_corregida: modoCorreccion.lat,\r\n          lon_corregida: modoCorreccion.lng\r\n        };\r\n\r\n        await guardarCoordenadaCorregida(coordenada);\r\n        \r\n        console.log('‚úÖ Coordenada guardada:', coordenada);\r\n        alert('‚úÖ Coordenada guardada correctamente');\r\n        \r\n        setModoCorreccion(null);\r\n        if (map) {\r\n          map.getContainer().style.cursor = '';\r\n        }\r\n        \r\n        window.location.reload();\r\n        \r\n      } catch (error) {\r\n        console.error('‚ùå Error al guardar:', error);\r\n        alert('‚ùå Error al guardar coordenada');\r\n      }\r\n    };\r\n\r\n    return () => {\r\n      delete window.activarCorreccionCoordenadas;\r\n      delete window.guardarCorreccionCoordenadas;\r\n    };\r\n  }, [map, modoCorreccion]);\r\n\r\n  // ‚úÖ EVENTO: Click en el mapa para capturar coordenadas\r\n  useEffect(() => {\r\n    if (!map || !modoCorreccion) return;\r\n\r\n    const handleMapClick = (e) => {\r\n      const { lat, lng } = e.latlng;\r\n      \r\n      console.log('üìç Coordenadas seleccionadas:', { lat, lng });\r\n      \r\n      setModoCorreccion(prev => ({\r\n        ...prev,\r\n        lat: lat,\r\n        lng: lng\r\n      }));\r\n      \r\n      const latSpan = document.getElementById(`lat-actual-${modoCorreccion.pbl}`);\r\n      const lngSpan = document.getElementById(`lon-actual-${modoCorreccion.pbl}`);\r\n      \r\n      if (latSpan) latSpan.textContent = lat.toFixed(6);\r\n      if (lngSpan) lngSpan.textContent = lng.toFixed(6);\r\n      \r\n      const btnGuardar = document.getElementById(`guardar-coord-${modoCorreccion.pbl}`);\r\n      if (btnGuardar) {\r\n        btnGuardar.disabled = false;\r\n        btnGuardar.style.opacity = '1';\r\n      }\r\n      \r\n      const btnActivar = document.getElementById(`activar-coord-${modoCorreccion.pbl}`);\r\n      if (btnActivar) {\r\n        btnActivar.textContent = 'Coord. Seleccionada ‚úì';\r\n        btnActivar.style.background = '#28a745';\r\n      }\r\n      \r\n      map.getContainer().style.cursor = '';\r\n    };\r\n\r\n    map.on('click', handleMapClick);\r\n\r\n    return () => {\r\n      map.off('click', handleMapClick);\r\n    };\r\n  }, [map, modoCorreccion]);\r\n\r\n  const clearMarkers = useCallback(() => {\r\n    if (!map) return;\r\n    Object.values(markersRef.current).forEach((marker) => {\r\n      try {\r\n        if (map.hasLayer(marker)) map.removeLayer(marker);\r\n      } catch {}\r\n    });\r\n    markersRef.current = {};\r\n  }, [map]);\r\n\r\n  const makeDraggable = useCallback((popup) => {\r\n    if (!map || !popup || !popup.getElement) return;\r\n    const el = popup.getElement();\r\n    if (!el) return;\r\n    try {\r\n      const wrapper = el.querySelector('.leaflet-popup-content-wrapper');\r\n      if (!wrapper) return;\r\n      const draggable = new L.Draggable(el, wrapper);\r\n      draggable.enable();\r\n    } catch {}\r\n  }, [map]);\r\n\r\n  const generarPopupContent = useCallback((marker, datosTabla, tablaPreciosHtml, variant = 'primary') => {\r\n    const isSecondary = variant === 'secondary';\r\n    \r\n    const logoUrl = marker.logo \r\n      ? (marker.logo.startsWith('http') \r\n          ? marker.logo \r\n          : `https://api.bencinaenlinea.cl${marker.logo}`)\r\n      : '';\r\n\r\n    let content = `\r\n      <div class=\"icon-markers-popup-content\">\r\n        <div class=\"popup-info-header\" style=\"position: relative;\">\r\n          ${logoUrl ? `\r\n            <img \r\n              src=\"${logoUrl}\" \r\n              alt=\"Logo ${marker.Marca}\" \r\n              class=\"popup-logo\"\r\n              onerror=\"this.style.display='none';\"\r\n            />\r\n          ` : ''}\r\n          \r\n          <div class=\"popup-info-row\">\r\n            <span class=\"popup-label\">PBL:</span>\r\n            <span class=\"popup-value\">${marker.pbl || '-'}</span>\r\n          </div>\r\n          <div class=\"popup-info-row\">\r\n            <span class=\"popup-label\">Estaci√≥n:</span>\r\n            <span class=\"popup-value\">${marker.nombre || '-'}</span>\r\n          </div>\r\n          <div class=\"popup-info-row\">\r\n            <span class=\"popup-label\">Jefe Zona:</span>\r\n            <span class=\"popup-value\">${marker.Marca || '-'}</span>\r\n          </div>\r\n          <div class=\"popup-info-row\">\r\n            <span class=\"popup-label\">Operaci√≥n:</span>\r\n            <span class=\"popup-value\">Comisionista</span>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"popup-tabs-container\">\r\n          <div class=\"popup-tabs-header\">\r\n            <button class=\"popup-tab-button active\" data-tab=\"precios\">Precios</button>\r\n            <button class=\"popup-tab-button\" data-tab=\"coordenadas\">Coordenadas</button>\r\n            <button class=\"popup-tab-button\" data-tab=\"informacion\">Informaci√≥n</button>\r\n          </div>\r\n\r\n          <div class=\"popup-tabs-content\">\r\n            <!-- TAB 1: PRECIOS -->\r\n            <div class=\"popup-tab-pane active\" data-tab=\"precios\">\r\n              ${tablaPreciosHtml}\r\n            </div>\r\n\r\n            <!-- TAB 2: COORDENADAS ‚úÖ MODIFICADO -->\r\n            <div class=\"popup-tab-pane\" data-tab=\"coordenadas\">\r\n              <div class=\"popup-info-box\">\r\n                <p><strong>Lat corregida:</strong> <span id=\"lat-actual-${marker.pbl}\">${marker.lat.toFixed(6)}</span></p>\r\n                <p><strong>Lon corregida:</strong> <span id=\"lon-actual-${marker.pbl}\">${marker.lng.toFixed(6)}</span></p>\r\n                <hr style=\"margin: 8px 0; border: none; border-top: 1px solid #dee2e6;\">\r\n                <p><strong>Lat original:</strong> ${marker.lat_original ? marker.lat_original.toFixed(6) : '-'}</p>\r\n                <p><strong>Lon original:</strong> ${marker.lng_original ? marker.lng_original.toFixed(6) : '-'}</p>\r\n              </div>\r\n              \r\n              <div style=\"display: flex; gap: 8px; margin-top: 10px;\">\r\n                <button \r\n                  id=\"activar-coord-${marker.pbl}\"\r\n                  style=\"flex: 1; padding: 8px; background: #17a2b8; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600;\"\r\n                  onclick=\"window.activarCorreccionCoordenadas('${marker.pbl}', '${marker.eds}')\"\r\n                >\r\n                  Activar Coord\r\n                </button>\r\n                \r\n                <button \r\n                  id=\"guardar-coord-${marker.pbl}\"\r\n                  style=\"flex: 1; padding: 8px; background: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 11px; font-weight: 600; opacity: 0.5;\"\r\n                  onclick=\"window.guardarCorreccionCoordenadas('${marker.pbl}', '${marker.eds}')\"\r\n                  disabled\r\n                >\r\n                  Guardar\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- TAB 3: INFORMACI√ìN -->\r\n            <div class=\"popup-tab-pane\" data-tab=\"informacion\">\r\n              <div class=\"popup-info-box\">\r\n                <p><strong>EDS:</strong> ${marker.eds || '-'}</p>\r\n                <p><strong>Direcci√≥n:</strong> ${marker.direccion || '-'}</p>\r\n                ${marker.Guerra_Precio === 'Si' ? `<p><strong style=\"color: #d9534f;\">‚ö†Ô∏è Guerra de Precio Activa</strong></p>` : ''}\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    `;\r\n\r\n    if (marker.pbl && (marker.Marca === 'Aramco' || marker.Marca === 'Petrobras')) {\r\n      content += `<button class=\"popup-button-mercado ${isSecondary ? 'secondary' : ''}\" onclick=\"window.showAssociatedIds && window.showAssociatedIds(${marker.pbl}, ${marker.lat}, ${marker.lng}, '${marker.id}')\">Mercado</button>`;\r\n    }\r\n\r\n    return content;\r\n  }, []);\r\n\r\n  const bindPopupWithMercado = useCallback((leafletMarker, marker) => {\r\n    const preciosHistoricos = marker.preciosHistoricos || [];\r\n    \r\n    let tablaPreciosHtml = '<div class=\"popup-table-wrapper\"><table class=\"popup-table\"><thead><tr>';\r\n    tablaPreciosHtml += '<th>Fecha</th><th>G93</th><th>G95</th><th>G97</th><th>Diesel</th><th>Kero</th></tr></thead><tbody>';\r\n    \r\n    if (preciosHistoricos.length > 0) {\r\n      preciosHistoricos.forEach(precio => {\r\n        tablaPreciosHtml += `<tr>\r\n          <td>${precio.Actualizacion || '-'}</td>\r\n          <td>${precio.G93 || '-'}</td>\r\n          <td>${precio.G95 || '-'}</td>\r\n          <td>${precio.G97 || '-'}</td>\r\n          <td>${precio.Diesel || '-'}</td>\r\n          <td>${precio.Kerosene || '-'}</td>\r\n        </tr>`;\r\n      });\r\n    } else {\r\n      tablaPreciosHtml += '<tr><td colspan=\"6\">No hay datos disponibles</td></tr>';\r\n    }\r\n    \r\n    tablaPreciosHtml += '</tbody></table></div>';\r\n\r\n    const popupHtml = generarPopupContent(marker, null, tablaPreciosHtml, 'primary');\r\n\r\n    leafletMarker.bindPopup(popupHtml, { maxWidth: 500, className: 'custom-popup' });\r\n\r\n    leafletMarker.on('popupopen', (e) => {\r\n      const popup = e.popup;\r\n      makeDraggable(popup);\r\n      \r\n      setTimeout(() => {\r\n        const tabButtons = document.querySelectorAll('.popup-tab-button');\r\n        const tabPanes = document.querySelectorAll('.popup-tab-pane');\r\n        \r\n        tabButtons.forEach(button => {\r\n          button.addEventListener('click', () => {\r\n            tabButtons.forEach(btn => btn.classList.remove('active'));\r\n            tabPanes.forEach(pane => pane.classList.remove('active'));\r\n            \r\n            button.classList.add('active');\r\n            const tab = button.getAttribute('data-tab');\r\n            const pane = document.querySelector(`.popup-tab-pane[data-tab=\"${tab}\"]`);\r\n            if (pane) pane.classList.add('active');\r\n          });\r\n        });\r\n      }, 100);\r\n    });\r\n  }, [generarPopupContent, makeDraggable]);\r\n\r\n  useEffect(() => {\r\n    if (!map || !markers) return;\r\n\r\n    clearMarkers();\r\n\r\n    markers.forEach((marker) => {\r\n      try {\r\n        const icon = createCustomIcon(marker);\r\n        const leafletMarker = L.marker([marker.lat, marker.lng], { icon });\r\n        bindPopupWithMercado(leafletMarker, marker);\r\n        leafletMarker.addTo(map);\r\n        markersRef.current[marker.id] = leafletMarker;\r\n      } catch (error) {\r\n        console.error('Error creating marker:', error);\r\n      }\r\n    });\r\n\r\n    return () => clearMarkers();\r\n  }, [map, markers, bindPopupWithMercado, clearMarkers]);\r\n\r\n  useEffect(() => {\r\n    window.showAssociatedIds = (pbl, lat, lng, mainId) => {\r\n      if (!map || !markersForMercado) return;\r\n\r\n      clearMarkers();\r\n      setShowingAssociated(true);\r\n\r\n      const filtered = markersForMercado.filter(m => m.pbl === pbl);\r\n\r\n      if (filtered.length === 0) {\r\n        console.warn('No associated markers found for PBL:', pbl);\r\n        return;\r\n      }\r\n\r\n      filtered.forEach(marker => {\r\n        try {\r\n          const isMain = marker.id === mainId;\r\n          const variant = isMain ? 'primary' : 'secondary';\r\n          const icon = isMain ? createCustomIcon(marker) : createBrandLogo(marker.Marca, marker);\r\n\r\n          const leafletMarker = L.marker([marker.lat, marker.lng], { icon });\r\n\r\n          const preciosHistoricos = marker.preciosHistoricos || [];\r\n          let tablaPreciosHtml = `<div class=\"popup-table-wrapper ${variant === 'secondary' ? 'secondary' : ''}\"><table class=\"popup-table ${variant === 'secondary' ? 'secondary' : ''}\"><thead><tr>`;\r\n          tablaPreciosHtml += '<th>Fecha</th><th>G93</th><th>G95</th><th>G97</th><th>Diesel</th><th>Kero</th></tr></thead><tbody>';\r\n\r\n          if (preciosHistoricos.length > 0) {\r\n            preciosHistoricos.forEach(precio => {\r\n              tablaPreciosHtml += `<tr>\r\n                <td>${precio.Actualizacion || '-'}</td>\r\n                <td>${precio.G93 || '-'}</td>\r\n                <td>${precio.G95 || '-'}</td>\r\n                <td>${precio.G97 || '-'}</td>\r\n                <td>${precio.Diesel || '-'}</td>\r\n                <td>${precio.Kerosene || '-'}</td>\r\n              </tr>`;\r\n            });\r\n          } else {\r\n            tablaPreciosHtml += '<tr><td colspan=\"6\">No hay datos disponibles</td></tr>';\r\n          }\r\n\r\n          tablaPreciosHtml += '</tbody></table></div>';\r\n\r\n          const popupHtml = generarPopupContent(marker, null, tablaPreciosHtml, variant);\r\n\r\n          leafletMarker.bindPopup(popupHtml, { maxWidth: 500, className: 'custom-popup' });\r\n\r\n          leafletMarker.on('popupopen', (e) => {\r\n            const popup = e.popup;\r\n            makeDraggable(popup);\r\n            \r\n            setTimeout(() => {\r\n              const tabButtons = document.querySelectorAll('.popup-tab-button');\r\n              const tabPanes = document.querySelectorAll('.popup-tab-pane');\r\n              \r\n              tabButtons.forEach(button => {\r\n                button.addEventListener('click', () => {\r\n                  tabButtons.forEach(btn => btn.classList.remove('active'));\r\n                  tabPanes.forEach(pane => pane.classList.remove('active'));\r\n                  \r\n                  button.classList.add('active');\r\n                  const tab = button.getAttribute('data-tab');\r\n                  const pane = document.querySelector(`.popup-tab-pane[data-tab=\"${tab}\"]`);\r\n                  if (pane) pane.classList.add('active');\r\n                });\r\n              });\r\n            }, 100);\r\n          });\r\n\r\n          leafletMarker.addTo(map);\r\n          markersRef.current[marker.id] = leafletMarker;\r\n        } catch (error) {\r\n          console.error('Error creating associated marker:', error);\r\n        }\r\n      });\r\n\r\n      if (lat && lng) {\r\n        map.setView([lat, lng], 15);\r\n      }\r\n    };\r\n\r\n    return () => {\r\n      delete window.showAssociatedIds;\r\n    };\r\n  }, [map, markersForMercado, generarPopupContent, makeDraggable, clearMarkers]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default IconMarkersLayer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}