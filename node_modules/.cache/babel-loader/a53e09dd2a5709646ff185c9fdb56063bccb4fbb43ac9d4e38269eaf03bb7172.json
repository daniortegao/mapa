{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport { createCustomIcon, createBrandLogo } from '../utils/iconHelpers';\nimport { getDataBaseComp } from '../services/apiService';\nconst IconMarkersLayer = ({\n  markers,\n  selectedRegion\n}) => {\n  _s();\n  const map = useMap();\n  const markersRef = useRef({});\n  const competenciaMarkersRef = useRef({});\n  const updateInProgressRef = useRef(false);\n  const [baseCompData, setBaseCompData] = useState([]);\n  const [showingCompetencia, setShowingCompetencia] = useState(false);\n  const [currentPbl, setCurrentPbl] = useState(null);\n\n  // Cargar base_comp\n  useEffect(() => {\n    const loadBaseComp = async () => {\n      try {\n        const data = await getDataBaseComp();\n        console.log('‚úÖ Base competencia:', data);\n        let compData = [];\n        if (Array.isArray(data)) {\n          compData = data;\n        } else if (data && data.base_comp && Array.isArray(data.base_comp)) {\n          compData = data.base_comp;\n        } else if (data && data.data && Array.isArray(data.data)) {\n          compData = data.data;\n        }\n        setBaseCompData(compData);\n      } catch (error) {\n        console.error('‚ùå Error base_comp:', error);\n        setBaseCompData([]);\n      }\n    };\n    loadBaseComp();\n  }, []);\n\n  // Hacer draggable\n  const makeDraggable = useCallback(popup => {\n    if (!map || !popup || !popup._container) return;\n    try {\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\n      L.DomUtil.setPosition(popup._wrapper.parentNode, pos);\n      const draggable = new L.Draggable(popup._container, popup._wrapper);\n      draggable.enable();\n    } catch (error) {\n      console.error('Error draggable:', error);\n    }\n  }, [map]);\n\n  // Limpiar competencia\n  const clearCompetenciaMarkers = useCallback(() => {\n    Object.values(competenciaMarkersRef.current).forEach(marker => {\n      try {\n        if (map && map.hasLayer(marker)) {\n          map.removeLayer(marker);\n        }\n      } catch (error) {\n        console.error('Error removiendo:', error);\n      }\n    });\n    competenciaMarkersRef.current = {};\n  }, [map]);\n\n  // Ver/Ocultar competencia\n  const handleShowCompetencia = useCallback(pbl => {\n    console.log(`üîç Competencia PBL: ${pbl}`);\n    if (!Array.isArray(baseCompData)) return;\n    if (showingCompetencia && currentPbl === pbl) {\n      // Ocultar\n      clearCompetenciaMarkers();\n      setShowingCompetencia(false);\n      setCurrentPbl(null);\n      return;\n    }\n    clearCompetenciaMarkers();\n\n    // Obtener competencia de este PBL\n    const competencia = baseCompData.filter(item => String(item.pbl).trim() === String(pbl).trim());\n    console.log(`üìç Competencia encontrada: ${competencia.length}`);\n\n    // Agregar cada competidor como marcador\n    competencia.forEach(comp => {\n      try {\n        // Buscar coordenadas del marcador original\n        const originalMarker = markers.find(m => m.id === comp.id);\n        if (!originalMarker) return;\n        const compId = `comp-${comp.id}`;\n        const leafletMarker = L.marker([originalMarker.lat, originalMarker.lng], {\n          icon: createCustomIcon(comp.Marca),\n          title: `${comp.Marca} - ${comp.id}`\n        });\n        const popupContent = `\n          <div class=\"popup-container\">\n            <div class=\"popup-header\">\n              <img \n                src=\"${createBrandLogo(comp.Marca)}\"\n                alt=\"${comp.Marca}\"\n                style=\"width: 30px; height: 30px; border-radius: 50%; object-fit: cover; margin-right: 8px;\"\n                onerror=\"this.style.display='none'\"\n              />\n              <h3 style=\"margin: 0;\">üè™ ${comp.Marca}</h3>\n            </div>\n            <div class=\"popup-content\">\n              <div class=\"popup-data\">\n                <strong>ID:</strong> ${comp.id}<br />\n                <strong>PBL:</strong> ${comp.pbl}<br />\n                <strong>Marca:</strong> ${comp.Marca}<br />\n                ${comp.direccion ? `<strong>Direcci√≥n:</strong> ${comp.direccion}<br />` : ''}\n              </div>\n              <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\n              <div class=\"popup-data\">\n                <strong>Precios Actuales:</strong><br />\n                G93: ${comp.precio_g93 ? `$${comp.precio_g93}` : 'N/A'}<br />\n                G95: ${comp.precio_g95 ? `$${comp.precio_g95}` : 'N/A'}<br />\n                Diesel: ${comp.precio_diesel ? `$${comp.precio_diesel}` : 'N/A'}<br />\n              </div>\n            </div>\n          </div>\n        `;\n        const popup = L.popup({\n          maxWidth: 300,\n          autoClose: false,\n          closeOnClick: false\n        }).setContent(popupContent);\n        leafletMarker.bindPopup(popup);\n        leafletMarker.on('popupopen', () => {\n          makeDraggable(leafletMarker.getPopup());\n        });\n        leafletMarker.on('click', function () {\n          leafletMarker.openPopup();\n        });\n        leafletMarker.addTo(map);\n        competenciaMarkersRef.current[compId] = leafletMarker;\n      } catch (error) {\n        console.error('Error competencia:', error);\n      }\n    });\n    setShowingCompetencia(true);\n    setCurrentPbl(pbl);\n  }, [baseCompData, markers, map, clearCompetenciaMarkers, makeDraggable, showingCompetencia, currentPbl]);\n\n  // Actualizar marcadores principales\n  const updateMarkers = useCallback(markersToShow => {\n    if (!map || updateInProgressRef.current) return;\n    updateInProgressRef.current = true;\n\n    // Limpiar anteriores\n    Object.values(markersRef.current).forEach(marker => {\n      try {\n        if (map.hasLayer(marker)) {\n          map.removeLayer(marker);\n        }\n      } catch (error) {\n        console.error('Error removiendo:', error);\n      }\n    });\n    markersRef.current = {};\n\n    // Limpiar competencia\n    clearCompetenciaMarkers();\n    setShowingCompetencia(false);\n    setCurrentPbl(null);\n    console.log(`üìç Agregando ${markersToShow.length} marcadores`);\n    markersToShow.forEach(marker => {\n      try {\n        const markerId = `${marker.id}-${marker.Marca}`;\n        const uniqueId = `marker-${Date.now()}-${Math.random()}`;\n        if (markersRef.current[markerId]) return;\n        const leafletMarker = L.marker([marker.lat, marker.lng], {\n          icon: createCustomIcon(marker.Marca),\n          title: marker.nombre\n        });\n        const popupContent = `\n          <div class=\"popup-container\">\n            <div class=\"popup-header\">\n              <img \n                src=\"${createBrandLogo(marker.Marca)}\"\n                alt=\"${marker.Marca}\"\n                style=\"width: 30px; height: 30px; border-radius: 50%; object-fit: cover; margin-right: 8px;\"\n                onerror=\"this.style.display='none'\"\n              />\n              <h3 style=\"margin: 0;\">${marker.nombre}</h3>\n            </div>\n            <div class=\"popup-content\">\n              <div class=\"popup-data\">\n                <strong>Marca:</strong> ${marker.Marca}<br />\n                <strong>PBL:</strong> ${marker.pbl || '-'}<br />\n                <strong>Region:</strong> ${marker.Region}<br />\n                <strong>Comuna:</strong> ${marker.Comuna}<br />\n                ${marker.direccion ? `<strong>Direcci√≥n:</strong> ${marker.direccion}<br />` : ''}\n                ${marker.eds ? `<strong>EDS:</strong> ${marker.eds}<br />` : ''}\n              </div>\n              <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\n              <div class=\"popup-data\">\n                <strong>Precios:</strong><br />\n                G93: ${marker.precio_g93 ? `$${marker.precio_g93}` : 'N/A'}<br />\n                G95: ${marker.precio_g95 ? `$${marker.precio_g95}` : 'N/A'}<br />\n                Diesel: ${marker.precio_diesel ? `$${marker.precio_diesel}` : 'N/A'}<br />\n              </div>\n              ${marker.Guerra_Precio === 'Si' ? `\n                <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\n                <div class=\"popup-data\" style=\"color: #d32f2f; font-weight: bold;\">\n                  ‚ö†Ô∏è Guerra de Precio Activa\n                </div>\n              ` : ''}\n              <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\n              <div id=\"competencia-${uniqueId}\"></div>\n            </div>\n          </div>\n        `;\n        const popup = L.popup({\n          maxWidth: 400,\n          minWidth: 300,\n          autoClose: false,\n          closeOnClick: false\n        }).setContent(popupContent);\n        leafletMarker.bindPopup(popup);\n        leafletMarker.on('popupopen', () => {\n          makeDraggable(leafletMarker.getPopup());\n          setTimeout(() => {\n            const container = document.getElementById(`competencia-${uniqueId}`);\n            if (container && marker.pbl) {\n              container.innerHTML = `\n                <button class=\"btn-competencia\" onclick=\"window.handleShowCompetencia && window.handleShowCompetencia('${marker.pbl}')\">\n                  üîç Ver Competencia\n                </button>\n              `;\n            }\n          }, 150);\n        });\n        leafletMarker.on('click', function () {\n          leafletMarker.openPopup();\n        });\n        leafletMarker.addTo(map);\n        markersRef.current[markerId] = leafletMarker;\n      } catch (error) {\n        console.error('Error marcador:', error);\n      }\n    });\n    updateInProgressRef.current = false;\n  }, [map, clearCompetenciaMarkers, makeDraggable]);\n\n  // Actualizar cuando cambian marcadores\n  useEffect(() => {\n    if (!map || !markers || markers.length === 0) {\n      Object.values(markersRef.current).forEach(marker => {\n        try {\n          if (map.hasLayer(marker)) {\n            map.removeLayer(marker);\n          }\n        } catch (error) {\n          console.error('Error:', error);\n        }\n      });\n      markersRef.current = {};\n      clearCompetenciaMarkers();\n      return;\n    }\n    console.log(`‚úÖ Actualizando ${markers.length} marcadores`);\n    updateMarkers(markers);\n  }, [markers, selectedRegion, map, updateMarkers, clearCompetenciaMarkers]);\n\n  // Exponer funci√≥n globalmente\n  useEffect(() => {\n    window.handleShowCompetencia = handleShowCompetencia;\n    return () => {\n      delete window.handleShowCompetencia;\n    };\n  }, [handleShowCompetencia]);\n  return null;\n};\n_s(IconMarkersLayer, \"RJKOuzi6DYNsY1gYOAlrVfSiZqM=\", false, function () {\n  return [useMap];\n});\n_c = IconMarkersLayer;\nexport default IconMarkersLayer;\nvar _c;\n$RefreshReg$(_c, \"IconMarkersLayer\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","useMap","L","createCustomIcon","createBrandLogo","getDataBaseComp","IconMarkersLayer","markers","selectedRegion","_s","map","markersRef","competenciaMarkersRef","updateInProgressRef","baseCompData","setBaseCompData","showingCompetencia","setShowingCompetencia","currentPbl","setCurrentPbl","loadBaseComp","data","console","log","compData","Array","isArray","base_comp","error","makeDraggable","popup","_container","pos","latLngToLayerPoint","getLatLng","DomUtil","setPosition","_wrapper","parentNode","draggable","Draggable","enable","clearCompetenciaMarkers","Object","values","current","forEach","marker","hasLayer","removeLayer","handleShowCompetencia","pbl","competencia","filter","item","String","trim","length","comp","originalMarker","find","m","id","compId","leafletMarker","lat","lng","icon","Marca","title","popupContent","direccion","precio_g93","precio_g95","precio_diesel","maxWidth","autoClose","closeOnClick","setContent","bindPopup","on","getPopup","openPopup","addTo","updateMarkers","markersToShow","markerId","uniqueId","Date","now","Math","random","nombre","Region","Comuna","eds","Guerra_Precio","minWidth","setTimeout","container","document","getElementById","innerHTML","window","_c","$RefreshReg$"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/IconMarkersLayer.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { useMap } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport { createCustomIcon, createBrandLogo } from '../utils/iconHelpers';\r\nimport { getDataBaseComp } from '../services/apiService';\r\n\r\nconst IconMarkersLayer = ({ markers, selectedRegion }) => {\r\n  const map = useMap();\r\n  const markersRef = useRef({});\r\n  const competenciaMarkersRef = useRef({});\r\n  const updateInProgressRef = useRef(false);\r\n  const [baseCompData, setBaseCompData] = useState([]);\r\n  const [showingCompetencia, setShowingCompetencia] = useState(false);\r\n  const [currentPbl, setCurrentPbl] = useState(null);\r\n\r\n  // Cargar base_comp\r\n  useEffect(() => {\r\n    const loadBaseComp = async () => {\r\n      try {\r\n        const data = await getDataBaseComp();\r\n        console.log('‚úÖ Base competencia:', data);\r\n        \r\n        let compData = [];\r\n        if (Array.isArray(data)) {\r\n          compData = data;\r\n        } else if (data && data.base_comp && Array.isArray(data.base_comp)) {\r\n          compData = data.base_comp;\r\n        } else if (data && data.data && Array.isArray(data.data)) {\r\n          compData = data.data;\r\n        }\r\n        \r\n        setBaseCompData(compData);\r\n      } catch (error) {\r\n        console.error('‚ùå Error base_comp:', error);\r\n        setBaseCompData([]);\r\n      }\r\n    };\r\n    loadBaseComp();\r\n  }, []);\r\n\r\n  // Hacer draggable\r\n  const makeDraggable = useCallback((popup) => {\r\n    if (!map || !popup || !popup._container) return;\r\n\r\n    try {\r\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\r\n      L.DomUtil.setPosition(popup._wrapper.parentNode, pos);\r\n      const draggable = new L.Draggable(popup._container, popup._wrapper);\r\n      draggable.enable();\r\n    } catch (error) {\r\n      console.error('Error draggable:', error);\r\n    }\r\n  }, [map]);\r\n\r\n  // Limpiar competencia\r\n  const clearCompetenciaMarkers = useCallback(() => {\r\n    Object.values(competenciaMarkersRef.current).forEach(marker => {\r\n      try {\r\n        if (map && map.hasLayer(marker)) {\r\n          map.removeLayer(marker);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error removiendo:', error);\r\n      }\r\n    });\r\n    competenciaMarkersRef.current = {};\r\n  }, [map]);\r\n\r\n  // Ver/Ocultar competencia\r\n  const handleShowCompetencia = useCallback((pbl) => {\r\n    console.log(`üîç Competencia PBL: ${pbl}`);\r\n    \r\n    if (!Array.isArray(baseCompData)) return;\r\n\r\n    if (showingCompetencia && currentPbl === pbl) {\r\n      // Ocultar\r\n      clearCompetenciaMarkers();\r\n      setShowingCompetencia(false);\r\n      setCurrentPbl(null);\r\n      return;\r\n    }\r\n\r\n    clearCompetenciaMarkers();\r\n\r\n    // Obtener competencia de este PBL\r\n    const competencia = baseCompData.filter(item => \r\n      String(item.pbl).trim() === String(pbl).trim()\r\n    );\r\n\r\n    console.log(`üìç Competencia encontrada: ${competencia.length}`);\r\n\r\n    // Agregar cada competidor como marcador\r\n    competencia.forEach((comp) => {\r\n      try {\r\n        // Buscar coordenadas del marcador original\r\n        const originalMarker = markers.find(m => m.id === comp.id);\r\n        if (!originalMarker) return;\r\n\r\n        const compId = `comp-${comp.id}`;\r\n\r\n        const leafletMarker = L.marker([originalMarker.lat, originalMarker.lng], {\r\n          icon: createCustomIcon(comp.Marca),\r\n          title: `${comp.Marca} - ${comp.id}`\r\n        });\r\n\r\n        const popupContent = `\r\n          <div class=\"popup-container\">\r\n            <div class=\"popup-header\">\r\n              <img \r\n                src=\"${createBrandLogo(comp.Marca)}\"\r\n                alt=\"${comp.Marca}\"\r\n                style=\"width: 30px; height: 30px; border-radius: 50%; object-fit: cover; margin-right: 8px;\"\r\n                onerror=\"this.style.display='none'\"\r\n              />\r\n              <h3 style=\"margin: 0;\">üè™ ${comp.Marca}</h3>\r\n            </div>\r\n            <div class=\"popup-content\">\r\n              <div class=\"popup-data\">\r\n                <strong>ID:</strong> ${comp.id}<br />\r\n                <strong>PBL:</strong> ${comp.pbl}<br />\r\n                <strong>Marca:</strong> ${comp.Marca}<br />\r\n                ${comp.direccion ? `<strong>Direcci√≥n:</strong> ${comp.direccion}<br />` : ''}\r\n              </div>\r\n              <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\r\n              <div class=\"popup-data\">\r\n                <strong>Precios Actuales:</strong><br />\r\n                G93: ${comp.precio_g93 ? `$${comp.precio_g93}` : 'N/A'}<br />\r\n                G95: ${comp.precio_g95 ? `$${comp.precio_g95}` : 'N/A'}<br />\r\n                Diesel: ${comp.precio_diesel ? `$${comp.precio_diesel}` : 'N/A'}<br />\r\n              </div>\r\n            </div>\r\n          </div>\r\n        `;\r\n\r\n        const popup = L.popup({\r\n          maxWidth: 300,\r\n          autoClose: false,\r\n          closeOnClick: false\r\n        }).setContent(popupContent);\r\n\r\n        leafletMarker.bindPopup(popup);\r\n\r\n        leafletMarker.on('popupopen', () => {\r\n          makeDraggable(leafletMarker.getPopup());\r\n        });\r\n\r\n        leafletMarker.on('click', function() {\r\n          leafletMarker.openPopup();\r\n        });\r\n\r\n        leafletMarker.addTo(map);\r\n        competenciaMarkersRef.current[compId] = leafletMarker;\r\n\r\n      } catch (error) {\r\n        console.error('Error competencia:', error);\r\n      }\r\n    });\r\n\r\n    setShowingCompetencia(true);\r\n    setCurrentPbl(pbl);\r\n  }, [baseCompData, markers, map, clearCompetenciaMarkers, makeDraggable, showingCompetencia, currentPbl]);\r\n\r\n  // Actualizar marcadores principales\r\n  const updateMarkers = useCallback((markersToShow) => {\r\n    if (!map || updateInProgressRef.current) return;\r\n\r\n    updateInProgressRef.current = true;\r\n\r\n    // Limpiar anteriores\r\n    Object.values(markersRef.current).forEach(marker => {\r\n      try {\r\n        if (map.hasLayer(marker)) {\r\n          map.removeLayer(marker);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error removiendo:', error);\r\n      }\r\n    });\r\n    markersRef.current = {};\r\n\r\n    // Limpiar competencia\r\n    clearCompetenciaMarkers();\r\n    setShowingCompetencia(false);\r\n    setCurrentPbl(null);\r\n\r\n    console.log(`üìç Agregando ${markersToShow.length} marcadores`);\r\n\r\n    markersToShow.forEach((marker) => {\r\n      try {\r\n        const markerId = `${marker.id}-${marker.Marca}`;\r\n        const uniqueId = `marker-${Date.now()}-${Math.random()}`;\r\n\r\n        if (markersRef.current[markerId]) return;\r\n\r\n        const leafletMarker = L.marker([marker.lat, marker.lng], {\r\n          icon: createCustomIcon(marker.Marca),\r\n          title: marker.nombre\r\n        });\r\n\r\n        const popupContent = `\r\n          <div class=\"popup-container\">\r\n            <div class=\"popup-header\">\r\n              <img \r\n                src=\"${createBrandLogo(marker.Marca)}\"\r\n                alt=\"${marker.Marca}\"\r\n                style=\"width: 30px; height: 30px; border-radius: 50%; object-fit: cover; margin-right: 8px;\"\r\n                onerror=\"this.style.display='none'\"\r\n              />\r\n              <h3 style=\"margin: 0;\">${marker.nombre}</h3>\r\n            </div>\r\n            <div class=\"popup-content\">\r\n              <div class=\"popup-data\">\r\n                <strong>Marca:</strong> ${marker.Marca}<br />\r\n                <strong>PBL:</strong> ${marker.pbl || '-'}<br />\r\n                <strong>Region:</strong> ${marker.Region}<br />\r\n                <strong>Comuna:</strong> ${marker.Comuna}<br />\r\n                ${marker.direccion ? `<strong>Direcci√≥n:</strong> ${marker.direccion}<br />` : ''}\r\n                ${marker.eds ? `<strong>EDS:</strong> ${marker.eds}<br />` : ''}\r\n              </div>\r\n              <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\r\n              <div class=\"popup-data\">\r\n                <strong>Precios:</strong><br />\r\n                G93: ${marker.precio_g93 ? `$${marker.precio_g93}` : 'N/A'}<br />\r\n                G95: ${marker.precio_g95 ? `$${marker.precio_g95}` : 'N/A'}<br />\r\n                Diesel: ${marker.precio_diesel ? `$${marker.precio_diesel}` : 'N/A'}<br />\r\n              </div>\r\n              ${marker.Guerra_Precio === 'Si' ? `\r\n                <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\r\n                <div class=\"popup-data\" style=\"color: #d32f2f; font-weight: bold;\">\r\n                  ‚ö†Ô∏è Guerra de Precio Activa\r\n                </div>\r\n              ` : ''}\r\n              <hr style=\"margin: 10px 0; border: none; border-top: 1px solid #e0e0e0\" />\r\n              <div id=\"competencia-${uniqueId}\"></div>\r\n            </div>\r\n          </div>\r\n        `;\r\n\r\n        const popup = L.popup({\r\n          maxWidth: 400,\r\n          minWidth: 300,\r\n          autoClose: false,\r\n          closeOnClick: false\r\n        }).setContent(popupContent);\r\n\r\n        leafletMarker.bindPopup(popup);\r\n\r\n        leafletMarker.on('popupopen', () => {\r\n          makeDraggable(leafletMarker.getPopup());\r\n          \r\n          setTimeout(() => {\r\n            const container = document.getElementById(`competencia-${uniqueId}`);\r\n            if (container && marker.pbl) {\r\n              container.innerHTML = `\r\n                <button class=\"btn-competencia\" onclick=\"window.handleShowCompetencia && window.handleShowCompetencia('${marker.pbl}')\">\r\n                  üîç Ver Competencia\r\n                </button>\r\n              `;\r\n            }\r\n          }, 150);\r\n        });\r\n\r\n        leafletMarker.on('click', function() {\r\n          leafletMarker.openPopup();\r\n        });\r\n\r\n        leafletMarker.addTo(map);\r\n        markersRef.current[markerId] = leafletMarker;\r\n\r\n      } catch (error) {\r\n        console.error('Error marcador:', error);\r\n      }\r\n    });\r\n\r\n    updateInProgressRef.current = false;\r\n  }, [map, clearCompetenciaMarkers, makeDraggable]);\r\n\r\n  // Actualizar cuando cambian marcadores\r\n  useEffect(() => {\r\n    if (!map || !markers || markers.length === 0) {\r\n      Object.values(markersRef.current).forEach(marker => {\r\n        try {\r\n          if (map.hasLayer(marker)) {\r\n            map.removeLayer(marker);\r\n          }\r\n        } catch (error) {\r\n          console.error('Error:', error);\r\n        }\r\n      });\r\n      markersRef.current = {};\r\n      clearCompetenciaMarkers();\r\n      return;\r\n    }\r\n\r\n    console.log(`‚úÖ Actualizando ${markers.length} marcadores`);\r\n    updateMarkers(markers);\r\n\r\n  }, [markers, selectedRegion, map, updateMarkers, clearCompetenciaMarkers]);\r\n\r\n  // Exponer funci√≥n globalmente\r\n  useEffect(() => {\r\n    window.handleShowCompetencia = handleShowCompetencia;\r\n    return () => {\r\n      delete window.handleShowCompetencia;\r\n    };\r\n  }, [handleShowCompetencia]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default IconMarkersLayer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}