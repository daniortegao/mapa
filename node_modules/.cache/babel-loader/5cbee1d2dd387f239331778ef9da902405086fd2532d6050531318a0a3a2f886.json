{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\e08f\\\\Desktop\\\\Proyectos\\\\Resumen\\\\mapa-v2\\\\src\\\\components\\\\FilterPanel.jsx\",\n  _s = $RefreshSig$();\nimport React, { useMemo, useState } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FilterPanel = ({\n  markers,\n  allMarkers,\n  selectedRegion,\n  onFiltersChange,\n  onStationSelect\n}) => {\n  _s();\n  const [selectedComuna, setSelectedComuna] = useState('');\n  const [selectedMarca, setSelectedMarca] = useState('');\n  const [selectedJefeZona, setSelectedJefeZona] = useState('');\n  const [selectedEds, setSelectedEds] = useState('');\n  const [edsSearchTerm, setEdsSearchTerm] = useState('');\n  const [globalEdsSearch, setGlobalEdsSearch] = useState('');\n  const [soloGuerraPrecios, setSoloGuerraPrecios] = useState(false);\n  const [soloEstacionesPES, setSoloEstacionesPES] = useState(false);\n  const tuasMarcas = ['Aramco', 'Petrobras'];\n  const comunas = useMemo(() => {\n    const filtered = markers.filter(m => m.Region === selectedRegion);\n    return [...new Set(filtered.map(m => m.Comuna))].sort();\n  }, [markers, selectedRegion]);\n  const marcas = useMemo(() => {\n    const filtered = markers.filter(m => m.Region === selectedRegion);\n    return [...new Set(filtered.map(m => m.Marca))].sort();\n  }, [markers, selectedRegion]);\n  const jefesZona = useMemo(() => {\n    const filtered = markers.filter(m => m.Region === selectedRegion && m.nombre && tuasMarcas.includes(m.Marca));\n    return [...new Set(filtered.map(m => m.nombre))].sort();\n  }, [markers, selectedRegion, tuasMarcas]);\n  const comunasDelJefe = useMemo(() => {\n    if (!selectedJefeZona) return [];\n    const jefeMarkers = markers.filter(m => m.nombre === selectedJefeZona);\n    return [...new Set(jefeMarkers.map(m => m.Comuna))];\n  }, [markers, selectedJefeZona]);\n  const allEds = useMemo(() => {\n    let filtered = markers.filter(m => m.Region === selectedRegion);\n    if (selectedJefeZona) {\n      filtered = filtered.filter(m => comunasDelJefe.includes(m.Comuna));\n    }\n    if (selectedComuna) {\n      filtered = filtered.filter(m => m.Comuna === selectedComuna);\n    }\n    if (selectedMarca) {\n      filtered = filtered.filter(m => m.Marca === selectedMarca);\n    }\n    return [...new Set(filtered.map(m => m.eds))].filter(eds => eds).sort();\n  }, [markers, selectedRegion, selectedComuna, selectedMarca, selectedJefeZona, comunasDelJefe]);\n  const filteredEds = useMemo(() => {\n    return allEds.filter(eds => eds.toLowerCase().includes(edsSearchTerm.toLowerCase()));\n  }, [allEds, edsSearchTerm]);\n\n  // All stations from all regions for global search\n  const allStations = useMemo(() => {\n    const stationMap = new Map();\n    markers.forEach(m => {\n      if (m.eds && m.pbl) {\n        const key = m.pbl;\n        if (!stationMap.has(key)) {\n          stationMap.set(key, {\n            pbl: m.pbl,\n            eds: m.eds,\n            region: m.Region,\n            comuna: m.Comuna,\n            marca: m.Marca,\n            lat: m.lat,\n            lng: m.lng\n          });\n        }\n      }\n    });\n    return Array.from(stationMap.values()).sort((a, b) => a.eds.localeCompare(b.eds));\n  }, [markers]);\n\n  // Array CON filtro EDS para mostrar en mapa\n  const filteredMarkers = useMemo(() => {\n    return markers.filter(m => {\n      // Global EDS search (searches across all regions)\n      if (globalEdsSearch.trim()) {\n        const searchMatch = m.eds && m.eds.toLowerCase().includes(globalEdsSearch.toLowerCase());\n        if (!searchMatch) return false;\n      }\n      const regionMatch = m.Region === selectedRegion;\n      const edsMatch = !selectedEds || m.eds === selectedEds;\n      const guerraMatch = !soloGuerraPrecios || m.Guerra_Precio === 'Si';\n      const pesMatch = !soloEstacionesPES || m.Surtidores_Autoservicio && m.Surtidores_Autoservicio !== null && m.Surtidores_Autoservicio !== '';\n      if (selectedJefeZona) {\n        const esDelJefe = m.nombre === selectedJefeZona;\n        const esCompetenciaEnComunasDelJefe = comunasDelJefe.includes(m.Comuna);\n        const jefeMatch = esDelJefe || esCompetenciaEnComunasDelJefe;\n        return regionMatch && jefeMatch && edsMatch && guerraMatch && pesMatch;\n      }\n      if (selectedComuna) {\n        const todasLasEstacionesEnComuna = m.Comuna === selectedComuna;\n        const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\n        return regionMatch && todasLasEstacionesEnComuna && marcaMatch && edsMatch && guerraMatch && pesMatch;\n      }\n      const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\n      return regionMatch && marcaMatch && edsMatch && guerraMatch && pesMatch;\n    });\n  }, [markers, selectedRegion, selectedComuna, selectedMarca, selectedJefeZona, selectedEds, comunasDelJefe, soloGuerraPrecios, soloEstacionesPES, globalEdsSearch]);\n\n  // Array SIN filtro EDS para botón Mercado\n  const filteredMarkersForMercado = useMemo(() => {\n    return markers.filter(m => {\n      const regionMatch = m.Region === selectedRegion;\n      const guerraMatch = !soloGuerraPrecios || m.Guerra_Precio === 'Si';\n      const pesMatch = !soloEstacionesPES || m.Surtidores_Autoservicio && m.Surtidores_Autoservicio !== null && m.Surtidores_Autoservicio !== '';\n      if (selectedJefeZona) {\n        const esDelJefe = m.nombre === selectedJefeZona;\n        const esCompetenciaEnComunasDelJefe = comunasDelJefe.includes(m.Comuna);\n        const jefeMatch = esDelJefe || esCompetenciaEnComunasDelJefe;\n        return regionMatch && jefeMatch && guerraMatch && pesMatch;\n      }\n      if (selectedComuna) {\n        const todasLasEstacionesEnComuna = m.Comuna === selectedComuna;\n        const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\n        return regionMatch && todasLasEstacionesEnComuna && marcaMatch && guerraMatch && pesMatch;\n      }\n      const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\n      return regionMatch && marcaMatch && guerraMatch && pesMatch;\n    });\n  }, [markers, selectedRegion, selectedComuna, selectedMarca, selectedJefeZona, comunasDelJefe, soloGuerraPrecios, soloEstacionesPES]);\n\n  // ✅ DEDUPLICAR filteredMarkers para el mapa\n  const uniqueFilteredMarkers = useMemo(() => {\n    const uniqueMap = new Map();\n    filteredMarkers.forEach(marker => {\n      const key = marker.pbl || marker.id || `${marker.lat}_${marker.lng}`;\n      const existing = uniqueMap.get(key);\n      if (!existing) {\n        uniqueMap.set(key, marker);\n      } else {\n        const existingDate = existing.fecha_aplicacion ? new Date(existing.fecha_aplicacion) : new Date(0);\n        const currentDate = marker.fecha_aplicacion ? new Date(marker.fecha_aplicacion) : new Date(0);\n        if (currentDate > existingDate) {\n          uniqueMap.set(key, marker);\n        }\n      }\n    });\n    return Array.from(uniqueMap.values());\n  }, [filteredMarkers]);\n\n  // ✅ Enviar únicos al mapa, histórico completo para Mercado\n  React.useEffect(() => {\n    onFiltersChange(uniqueFilteredMarkers, filteredMarkersForMercado);\n  }, [uniqueFilteredMarkers, filteredMarkersForMercado, onFiltersChange]);\n\n  // Contador de marcas (solo estaciones únicas)\n  const markersByBrand = useMemo(() => {\n    const result = {};\n    uniqueFilteredMarkers.forEach(m => {\n      result[m.Marca] = (result[m.Marca] || 0) + 1;\n    });\n    return result;\n  }, [uniqueFilteredMarkers]);\n\n  // Contador total por marca en la región\n  const brandCounts = useMemo(() => {\n    const filtered = markers.filter(m => m.Region === selectedRegion);\n    const brandMap = new Map();\n    filtered.forEach(m => {\n      const brand = m.Marca || 'Sin marca';\n      const id = m.pbl || m.id || `${m.lat}_${m.lng}`;\n      if (!brandMap.has(brand)) {\n        brandMap.set(brand, new Set());\n      }\n      brandMap.get(brand).add(id);\n    });\n    return Object.fromEntries(Array.from(brandMap.entries()).map(([name, set]) => [name, set.size]));\n  }, [markers, selectedRegion]);\n  const handleClearFilters = () => {\n    setSelectedComuna('');\n    setSelectedMarca('');\n    setSelectedJefeZona('');\n    setSelectedEds('');\n    setEdsSearchTerm('');\n    setGlobalEdsSearch('');\n    setSoloGuerraPrecios(false);\n    setSoloEstacionesPES(false);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"filter-panel\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"comuna-select\",\n        children: \"Comuna\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"comuna-select\",\n        value: selectedComuna,\n        onChange: e => setSelectedComuna(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Todas las comunas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 11\n        }, this), comunas.map(comuna => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: comuna,\n          children: comuna\n        }, comuna, false, {\n          fileName: _jsxFileName,\n          lineNumber: 213,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 204,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"global-eds-search\",\n        children: \"Buscar Estaci\\xF3n (todas las regiones)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"global-eds-search\",\n        value: globalEdsSearch,\n        onChange: e => {\n          const selectedPbl = e.target.value;\n          setGlobalEdsSearch(selectedPbl);\n          if (selectedPbl && onStationSelect) {\n            const station = allStations.find(s => s.pbl === selectedPbl);\n            if (station) {\n              onStationSelect(station);\n            }\n          }\n        },\n        style: {\n          width: '100%',\n          padding: '8px',\n          fontSize: '13px',\n          border: '1px solid #ced4da',\n          borderRadius: '4px',\n          boxSizing: 'border-box'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Selecciona una estaci\\xF3n...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 11\n        }, this), allStations.map(station => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: station.pbl,\n          children: [station.eds, \" - \", station.comuna, \" (\", station.region, \")\"]\n        }, station.pbl, true, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 9\n      }, this), globalEdsSearch && /*#__PURE__*/_jsxDEV(\"small\", {\n        style: {\n          fontSize: '11px',\n          color: '#6c757d',\n          marginTop: '4px',\n          display: 'block'\n        },\n        children: \"Estaci\\xF3n seleccionada - El mapa se centrar\\xE1 en ella\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 250,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"marca-select\",\n        children: \"Marca\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"marca-select\",\n        value: selectedMarca,\n        onChange: e => setSelectedMarca(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Todas las marcas\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 11\n        }, this), marcas.map(marca => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: marca,\n          children: [marca, \" \", brandCounts[marca] ? `(${brandCounts[marca]})` : '']\n        }, marca, true, {\n          fileName: _jsxFileName,\n          lineNumber: 265,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"jefe-select\",\n        children: \"Jefe de Zona\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"jefe-select\",\n        value: selectedJefeZona,\n        onChange: e => setSelectedJefeZona(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Selecciona un Jefe de Zona\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 11\n        }, this), jefesZona.map(jefe => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: jefe,\n          children: jefe\n        }, jefe, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 274,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"eds-select\",\n        children: \"EDS\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"select\", {\n        id: \"eds-select\",\n        value: selectedEds,\n        onChange: e => setSelectedEds(e.target.value),\n        children: [/*#__PURE__*/_jsxDEV(\"option\", {\n          value: \"\",\n          children: \"Todas las EDS\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 11\n        }, this), filteredEds.map(eds => /*#__PURE__*/_jsxDEV(\"option\", {\n          value: eds,\n          children: eds\n        }, eds, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 13\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group filter-checkbox\",\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"guerra-precios-checkbox\",\n        className: \"checkbox-label\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"guerra-precios-checkbox\",\n          type: \"checkbox\",\n          checked: soloGuerraPrecios,\n          onChange: e => setSoloGuerraPrecios(e.target.checked)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 302,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"checkbox-text\",\n          children: \"Guerra de Precios\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 301,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 300,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"filter-group filter-checkbox filter-checkbox-pes\",\n      children: /*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"estaciones-pes-checkbox\",\n        className: \"checkbox-label\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"estaciones-pes-checkbox\",\n          type: \"checkbox\",\n          checked: soloEstacionesPES,\n          onChange: e => setSoloEstacionesPES(e.target.checked)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 314,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"checkbox-text\",\n          children: \"Estaciones PES\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 313,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 312,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 203,\n    columnNumber: 5\n  }, this);\n};\n_s(FilterPanel, \"jR/to9nNgpPf2HBY1Bd96x6uJ9g=\");\n_c = FilterPanel;\nexport default FilterPanel;\nvar _c;\n$RefreshReg$(_c, \"FilterPanel\");","map":{"version":3,"names":["React","useMemo","useState","jsxDEV","_jsxDEV","FilterPanel","markers","allMarkers","selectedRegion","onFiltersChange","onStationSelect","_s","selectedComuna","setSelectedComuna","selectedMarca","setSelectedMarca","selectedJefeZona","setSelectedJefeZona","selectedEds","setSelectedEds","edsSearchTerm","setEdsSearchTerm","globalEdsSearch","setGlobalEdsSearch","soloGuerraPrecios","setSoloGuerraPrecios","soloEstacionesPES","setSoloEstacionesPES","tuasMarcas","comunas","filtered","filter","m","Region","Set","map","Comuna","sort","marcas","Marca","jefesZona","nombre","includes","comunasDelJefe","jefeMarkers","allEds","eds","filteredEds","toLowerCase","allStations","stationMap","Map","forEach","pbl","key","has","set","region","comuna","marca","lat","lng","Array","from","values","a","b","localeCompare","filteredMarkers","trim","searchMatch","regionMatch","edsMatch","guerraMatch","Guerra_Precio","pesMatch","Surtidores_Autoservicio","esDelJefe","esCompetenciaEnComunasDelJefe","jefeMatch","todasLasEstacionesEnComuna","marcaMatch","filteredMarkersForMercado","uniqueFilteredMarkers","uniqueMap","marker","id","existing","get","existingDate","fecha_aplicacion","Date","currentDate","useEffect","markersByBrand","result","brandCounts","brandMap","brand","add","Object","fromEntries","entries","name","size","handleClearFilters","className","children","htmlFor","fileName","_jsxFileName","lineNumber","columnNumber","value","onChange","e","target","selectedPbl","station","find","s","style","width","padding","fontSize","border","borderRadius","boxSizing","color","marginTop","display","jefe","type","checked","_c","$RefreshReg$"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/FilterPanel.jsx"],"sourcesContent":["import React, { useMemo, useState } from 'react';\r\n\r\nconst FilterPanel = ({ markers, allMarkers, selectedRegion, onFiltersChange, onStationSelect }) => {\r\n  const [selectedComuna, setSelectedComuna] = useState('');\r\n  const [selectedMarca, setSelectedMarca] = useState('');\r\n  const [selectedJefeZona, setSelectedJefeZona] = useState('');\r\n  const [selectedEds, setSelectedEds] = useState('');\r\n  const [edsSearchTerm, setEdsSearchTerm] = useState('');\r\n  const [globalEdsSearch, setGlobalEdsSearch] = useState('');\r\n  const [soloGuerraPrecios, setSoloGuerraPrecios] = useState(false);\r\n  const [soloEstacionesPES, setSoloEstacionesPES] = useState(false);\r\n\r\n  const tuasMarcas = ['Aramco', 'Petrobras'];\r\n\r\n  const comunas = useMemo(() => {\r\n    const filtered = markers.filter(m => m.Region === selectedRegion);\r\n    return [...new Set(filtered.map(m => m.Comuna))].sort();\r\n  }, [markers, selectedRegion]);\r\n\r\n  const marcas = useMemo(() => {\r\n    const filtered = markers.filter(m => m.Region === selectedRegion);\r\n    return [...new Set(filtered.map(m => m.Marca))].sort();\r\n  }, [markers, selectedRegion]);\r\n\r\n  const jefesZona = useMemo(() => {\r\n    const filtered = markers.filter(\r\n      m => m.Region === selectedRegion && m.nombre && tuasMarcas.includes(m.Marca)\r\n    );\r\n    return [...new Set(filtered.map(m => m.nombre))].sort();\r\n  }, [markers, selectedRegion, tuasMarcas]);\r\n\r\n  const comunasDelJefe = useMemo(() => {\r\n    if (!selectedJefeZona) return [];\r\n    const jefeMarkers = markers.filter(m => m.nombre === selectedJefeZona);\r\n    return [...new Set(jefeMarkers.map(m => m.Comuna))];\r\n  }, [markers, selectedJefeZona]);\r\n\r\n  const allEds = useMemo(() => {\r\n    let filtered = markers.filter(m => m.Region === selectedRegion);\r\n    if (selectedJefeZona) {\r\n      filtered = filtered.filter(m => comunasDelJefe.includes(m.Comuna));\r\n    }\r\n    if (selectedComuna) {\r\n      filtered = filtered.filter(m => m.Comuna === selectedComuna);\r\n    }\r\n    if (selectedMarca) {\r\n      filtered = filtered.filter(m => m.Marca === selectedMarca);\r\n    }\r\n    return [...new Set(filtered.map(m => m.eds))].filter(eds => eds).sort();\r\n  }, [markers, selectedRegion, selectedComuna, selectedMarca, selectedJefeZona, comunasDelJefe]);\r\n\r\n  const filteredEds = useMemo(() => {\r\n    return allEds.filter(eds =>\r\n      eds.toLowerCase().includes(edsSearchTerm.toLowerCase())\r\n    );\r\n  }, [allEds, edsSearchTerm]);\r\n\r\n  // All stations from all regions for global search\r\n  const allStations = useMemo(() => {\r\n    const stationMap = new Map();\r\n    markers.forEach(m => {\r\n      if (m.eds && m.pbl) {\r\n        const key = m.pbl;\r\n        if (!stationMap.has(key)) {\r\n          stationMap.set(key, {\r\n            pbl: m.pbl,\r\n            eds: m.eds,\r\n            region: m.Region,\r\n            comuna: m.Comuna,\r\n            marca: m.Marca,\r\n            lat: m.lat,\r\n            lng: m.lng\r\n          });\r\n        }\r\n      }\r\n    });\r\n    return Array.from(stationMap.values()).sort((a, b) => a.eds.localeCompare(b.eds));\r\n  }, [markers]);\r\n\r\n  // Array CON filtro EDS para mostrar en mapa\r\n  const filteredMarkers = useMemo(() => {\r\n    return markers.filter(m => {\r\n      // Global EDS search (searches across all regions)\r\n      if (globalEdsSearch.trim()) {\r\n        const searchMatch = m.eds && m.eds.toLowerCase().includes(globalEdsSearch.toLowerCase());\r\n        if (!searchMatch) return false;\r\n      }\r\n\r\n      const regionMatch = m.Region === selectedRegion;\r\n      const edsMatch = !selectedEds || m.eds === selectedEds;\r\n      const guerraMatch = !soloGuerraPrecios || m.Guerra_Precio === 'Si';\r\n      const pesMatch = !soloEstacionesPES || (m.Surtidores_Autoservicio && m.Surtidores_Autoservicio !== null && m.Surtidores_Autoservicio !== '');\r\n\r\n      if (selectedJefeZona) {\r\n        const esDelJefe = m.nombre === selectedJefeZona;\r\n        const esCompetenciaEnComunasDelJefe = comunasDelJefe.includes(m.Comuna);\r\n        const jefeMatch = esDelJefe || esCompetenciaEnComunasDelJefe;\r\n        return regionMatch && jefeMatch && edsMatch && guerraMatch && pesMatch;\r\n      }\r\n\r\n      if (selectedComuna) {\r\n        const todasLasEstacionesEnComuna = m.Comuna === selectedComuna;\r\n        const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\r\n        return regionMatch && todasLasEstacionesEnComuna && marcaMatch && edsMatch && guerraMatch && pesMatch;\r\n      }\r\n\r\n      const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\r\n      return regionMatch && marcaMatch && edsMatch && guerraMatch && pesMatch;\r\n    });\r\n  }, [markers, selectedRegion, selectedComuna, selectedMarca, selectedJefeZona, selectedEds, comunasDelJefe, soloGuerraPrecios, soloEstacionesPES, globalEdsSearch]);\r\n\r\n  // Array SIN filtro EDS para botón Mercado\r\n  const filteredMarkersForMercado = useMemo(() => {\r\n    return markers.filter(m => {\r\n      const regionMatch = m.Region === selectedRegion;\r\n      const guerraMatch = !soloGuerraPrecios || m.Guerra_Precio === 'Si';\r\n      const pesMatch = !soloEstacionesPES || (m.Surtidores_Autoservicio && m.Surtidores_Autoservicio !== null && m.Surtidores_Autoservicio !== '');\r\n\r\n      if (selectedJefeZona) {\r\n        const esDelJefe = m.nombre === selectedJefeZona;\r\n        const esCompetenciaEnComunasDelJefe = comunasDelJefe.includes(m.Comuna);\r\n        const jefeMatch = esDelJefe || esCompetenciaEnComunasDelJefe;\r\n        return regionMatch && jefeMatch && guerraMatch && pesMatch;\r\n      }\r\n\r\n      if (selectedComuna) {\r\n        const todasLasEstacionesEnComuna = m.Comuna === selectedComuna;\r\n        const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\r\n        return regionMatch && todasLasEstacionesEnComuna && marcaMatch && guerraMatch && pesMatch;\r\n      }\r\n\r\n      const marcaMatch = !selectedMarca || m.Marca === selectedMarca;\r\n      return regionMatch && marcaMatch && guerraMatch && pesMatch;\r\n    });\r\n  }, [markers, selectedRegion, selectedComuna, selectedMarca, selectedJefeZona, comunasDelJefe, soloGuerraPrecios, soloEstacionesPES]);\r\n\r\n  // ✅ DEDUPLICAR filteredMarkers para el mapa\r\n  const uniqueFilteredMarkers = useMemo(() => {\r\n    const uniqueMap = new Map();\r\n\r\n    filteredMarkers.forEach(marker => {\r\n      const key = marker.pbl || marker.id || `${marker.lat}_${marker.lng}`;\r\n      const existing = uniqueMap.get(key);\r\n\r\n      if (!existing) {\r\n        uniqueMap.set(key, marker);\r\n      } else {\r\n        const existingDate = existing.fecha_aplicacion ? new Date(existing.fecha_aplicacion) : new Date(0);\r\n        const currentDate = marker.fecha_aplicacion ? new Date(marker.fecha_aplicacion) : new Date(0);\r\n\r\n        if (currentDate > existingDate) {\r\n          uniqueMap.set(key, marker);\r\n        }\r\n      }\r\n    });\r\n\r\n    return Array.from(uniqueMap.values());\r\n  }, [filteredMarkers]);\r\n\r\n  // ✅ Enviar únicos al mapa, histórico completo para Mercado\r\n  React.useEffect(() => {\r\n    onFiltersChange(uniqueFilteredMarkers, filteredMarkersForMercado);\r\n  }, [uniqueFilteredMarkers, filteredMarkersForMercado, onFiltersChange]);\r\n\r\n  // Contador de marcas (solo estaciones únicas)\r\n  const markersByBrand = useMemo(() => {\r\n    const result = {};\r\n    uniqueFilteredMarkers.forEach(m => {\r\n      result[m.Marca] = (result[m.Marca] || 0) + 1;\r\n    });\r\n    return result;\r\n  }, [uniqueFilteredMarkers]);\r\n\r\n  // Contador total por marca en la región\r\n  const brandCounts = useMemo(() => {\r\n    const filtered = markers.filter(m => m.Region === selectedRegion);\r\n    const brandMap = new Map();\r\n    filtered.forEach(m => {\r\n      const brand = m.Marca || 'Sin marca';\r\n      const id = m.pbl || m.id || `${m.lat}_${m.lng}`;\r\n      if (!brandMap.has(brand)) {\r\n        brandMap.set(brand, new Set());\r\n      }\r\n      brandMap.get(brand).add(id);\r\n    });\r\n    return Object.fromEntries(\r\n      Array.from(brandMap.entries()).map(([name, set]) => [name, set.size])\r\n    );\r\n  }, [markers, selectedRegion]);\r\n\r\n  const handleClearFilters = () => {\r\n    setSelectedComuna('');\r\n    setSelectedMarca('');\r\n    setSelectedJefeZona('');\r\n    setSelectedEds('');\r\n    setEdsSearchTerm('');\r\n    setGlobalEdsSearch('');\r\n    setSoloGuerraPrecios(false);\r\n    setSoloEstacionesPES(false);\r\n  };\r\n\r\n  return (\r\n    <div className=\"filter-panel\">\r\n      <div className=\"filter-group\">\r\n        <label htmlFor=\"comuna-select\">Comuna</label>\r\n        <select\r\n          id=\"comuna-select\"\r\n          value={selectedComuna}\r\n          onChange={(e) => setSelectedComuna(e.target.value)}\r\n        >\r\n          <option value=\"\">Todas las comunas</option>\r\n          {comunas.map(comuna => (\r\n            <option key={comuna} value={comuna}>{comuna}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"filter-group\">\r\n        <label htmlFor=\"global-eds-search\">Buscar Estación (todas las regiones)</label>\r\n        <select\r\n          id=\"global-eds-search\"\r\n          value={globalEdsSearch}\r\n          onChange={(e) => {\r\n            const selectedPbl = e.target.value;\r\n            setGlobalEdsSearch(selectedPbl);\r\n            if (selectedPbl && onStationSelect) {\r\n              const station = allStations.find(s => s.pbl === selectedPbl);\r\n              if (station) {\r\n                onStationSelect(station);\r\n              }\r\n            }\r\n          }}\r\n          style={{\r\n            width: '100%',\r\n            padding: '8px',\r\n            fontSize: '13px',\r\n            border: '1px solid #ced4da',\r\n            borderRadius: '4px',\r\n            boxSizing: 'border-box'\r\n          }}\r\n        >\r\n          <option value=\"\">Selecciona una estación...</option>\r\n          {allStations.map(station => (\r\n            <option key={station.pbl} value={station.pbl}>\r\n              {station.eds} - {station.comuna} ({station.region})\r\n            </option>\r\n          ))}\r\n        </select>\r\n        {globalEdsSearch && (\r\n          <small style={{ fontSize: '11px', color: '#6c757d', marginTop: '4px', display: 'block' }}>\r\n            Estación seleccionada - El mapa se centrará en ella\r\n          </small>\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"filter-group\">\r\n        <label htmlFor=\"marca-select\">Marca</label>\r\n        <select\r\n          id=\"marca-select\"\r\n          value={selectedMarca}\r\n          onChange={(e) => setSelectedMarca(e.target.value)}\r\n        >\r\n          <option value=\"\">Todas las marcas</option>\r\n          {marcas.map(marca => (\r\n            <option key={marca} value={marca}>\r\n              {marca} {brandCounts[marca] ? `(${brandCounts[marca]})` : ''}\r\n            </option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"filter-group\">\r\n        <label htmlFor=\"jefe-select\">Jefe de Zona</label>\r\n        <select\r\n          id=\"jefe-select\"\r\n          value={selectedJefeZona}\r\n          onChange={(e) => setSelectedJefeZona(e.target.value)}\r\n        >\r\n          <option value=\"\">Selecciona un Jefe de Zona</option>\r\n          {jefesZona.map(jefe => (\r\n            <option key={jefe} value={jefe}>{jefe}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"filter-group\">\r\n        <label htmlFor=\"eds-select\">EDS</label>\r\n        <select\r\n          id=\"eds-select\"\r\n          value={selectedEds}\r\n          onChange={(e) => setSelectedEds(e.target.value)}\r\n        >\r\n          <option value=\"\">Todas las EDS</option>\r\n          {filteredEds.map(eds => (\r\n            <option key={eds} value={eds}>{eds}</option>\r\n          ))}\r\n        </select>\r\n      </div>\r\n\r\n      <div className=\"filter-group filter-checkbox\">\r\n        <label htmlFor=\"guerra-precios-checkbox\" className=\"checkbox-label\">\r\n          <input\r\n            id=\"guerra-precios-checkbox\"\r\n            type=\"checkbox\"\r\n            checked={soloGuerraPrecios}\r\n            onChange={(e) => setSoloGuerraPrecios(e.target.checked)}\r\n          />\r\n          <span className=\"checkbox-text\">Guerra de Precios</span>\r\n        </label>\r\n      </div>\r\n\r\n      <div className=\"filter-group filter-checkbox filter-checkbox-pes\">\r\n        <label htmlFor=\"estaciones-pes-checkbox\" className=\"checkbox-label\">\r\n          <input\r\n            id=\"estaciones-pes-checkbox\"\r\n            type=\"checkbox\"\r\n            checked={soloEstacionesPES}\r\n            onChange={(e) => setSoloEstacionesPES(e.target.checked)}\r\n          />\r\n          <span className=\"checkbox-text\">Estaciones PES</span>\r\n        </label>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default FilterPanel;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}