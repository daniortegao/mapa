{"ast":null,"code":"import React,{useState,useMemo,useEffect}from'react';import'./styles/globals.css';import'./styles/layout.css';import'./styles/markers.css';import MapComponent from'./components/MapComponent';import FilterPanel from'./components/FilterPanel';import AlertPanel from'./components/AlertPanel';import StatisticsPanel from'./components/StatisticsPanel';import{REGION_COORDINATES,REGIONES_ORDENADAS}from'./utils/constants';import{useMapData}from'./hooks/useMapData';import{getDataBaseComp,getMercadoAlerta,getMarcasCompartidas,guardarMarcasCompartidas}from'./services/apiService';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function App(){const[sidebarVisible,setSidebarVisible]=useState(false);const[rightPanelVisible,setRightPanelVisible]=useState(false);const[alertPanelVisible,setAlertPanelVisible]=useState(false);const[alertCount,setAlertCount]=useState(0);const[selectedRegion,setSelectedRegion]=useState('Metropolitana de Santiago');const[filteredMarkers,setFilteredMarkers]=useState([]);const[filteredMarkersForMercado,setFilteredMarkersForMercado]=useState([]);const[baseCompData,setBaseCompData]=useState([]);const{markers,lastUpdateTime}=useMapData();// Estado para estaciones marcadas como \"Nivel 2 en Nivel 1\"\nconst[nivel2EnNivel1Stations,setNivel2EnNivel1Stations]=useState([]);// Cargar marcas compartidas al iniciar\nuseEffect(()=>{const loadMarcas=async()=>{try{const marcas=await getMarcasCompartidas();if(Array.isArray(marcas)){setNivel2EnNivel1Stations(marcas);}}catch(err){console.error('Error cargando marcas compartidas:',err);}};loadMarcas();},[]);const regions=useMemo(()=>{const regionesConDatos=new Set(markers.map(m=>m.Region));return REGIONES_ORDENADAS.filter(region=>regionesConDatos.has(region));},[markers]);const regionMarkers=useMemo(()=>{return markers.filter(m=>m.Region===selectedRegion);},[markers,selectedRegion]);// ‚úÖ AGREGA ESTO (marcadores √∫nicos SOLO para el mapa):\nconst uniqueRegionMarkers=useMemo(()=>{const filtered=markers.filter(m=>m.Region===selectedRegion);// Deduplicar: mantener solo el m√°s reciente por estaci√≥n\nconst uniqueMap=new Map();filtered.forEach(marker=>{const key=marker.pbl||marker.id||\"\".concat(marker.lat,\"_\").concat(marker.lng);const existing=uniqueMap.get(key);if(!existing){uniqueMap.set(key,marker);}else{const existingDate=existing.fecha_aplicacion?new Date(existing.fecha_aplicacion):new Date(0);const currentDate=marker.fecha_aplicacion?new Date(marker.fecha_aplicacion):new Date(0);if(currentDate>existingDate){uniqueMap.set(key,marker);}}});const unique=Array.from(uniqueMap.values());console.log(\"\\uD83D\\uDCCD \".concat(selectedRegion,\": \").concat(unique.length,\" estaciones \\xFAnicas de \").concat(filtered.length,\" registros\"));return unique;},[markers,selectedRegion]);useEffect(()=>{const loadIt=async()=>{try{const data=await getDataBaseComp();const final=(data===null||data===void 0?void 0:data.bascomp)||(data===null||data===void 0?void 0:data.base_comp)||(data===null||data===void 0?void 0:data.data)||[];setBaseCompData(final);}catch(err){console.error('Error:',err);}};loadIt();},[]);// NOTA: Ya no usamos localStorage para persistencia local\n// La persistencia se maneja directamente al actualizar el estado\nuseEffect(()=>{const loadAlertCount=async()=>{try{const alertas=await getMercadoAlerta();const getStationCount=alerts=>{const estaciones={};alerts.forEach(a=>{estaciones[a.Nom_Eds||'Sin nombre']=true;});return Object.keys(estaciones).length;};const count=getStationCount(alertas);setAlertCount(count);}catch(err){console.error('Error al cargar alertas:',err);setAlertCount(0);}};loadAlertCount();const interval=setInterval(loadAlertCount,60000);return()=>clearInterval(interval);},[]);const handleFiltersChange=React.useCallback((filtered,filteredForMercado)=>{setFilteredMarkers(filtered);// ‚Üê √önicos para visualizar\nsetFilteredMarkersForMercado(filteredForMercado);// ‚Üê Hist√≥rico completo filtrado\n},[]);const handleStationSelect=station=>{if(station&&window.leafletMap){// Change region if needed\nif(station.region!==selectedRegion){setSelectedRegion(station.region);}// Center map on station with zoom\nsetTimeout(()=>{window.leafletMap.setView([station.lat,station.lng],15);},100);}};const toggleSidebar=()=>{setSidebarVisible(!sidebarVisible);setTimeout(()=>{if(window.leafletMap){window.leafletMap.invalidateSize();}},300);};const toggleRightPanel=()=>{setRightPanelVisible(!rightPanelVisible);setTimeout(()=>{if(window.leafletMap){window.leafletMap.invalidateSize();}},300);};const toggleAlertPanel=()=>{setAlertPanelVisible(!alertPanelVisible);};const toggleNivel2EnNivel1=async stationId=>{// Actualizaci√≥n optimista\nlet newStations=[];setNivel2EnNivel1Stations(prev=>{if(prev.includes(stationId)){newStations=prev.filter(id=>id!==stationId);}else{newStations=[...prev,stationId];}return newStations;});// Guardar en backend\ntry{await guardarMarcasCompartidas(newStations);}catch(err){console.error('Error guardando marcas compartidas:',err);// Revertir en caso de error (opcional, pero recomendado)\n// Por simplicidad, recargamos del servidor\nconst marcas=await getMarcasCompartidas();if(Array.isArray(marcas)){setNivel2EnNivel1Stations(marcas);}}};// Estado para intercambiar aplicaciones\nconst[activeApp,setActiveApp]=useState('mapa');// 'mapa' | 'calculos'\n// Usuario autenticado para mostrar en navbar\nconst[loggedUser,setLoggedUser]=useState(()=>{try{return localStorage.getItem('user_calc')||null;}catch(e){return null;}});// Estado para Login antes de entrar a Precios\nconst[showLogin,setShowLogin]=useState(false);const[loginUser,setLoginUser]=useState('');const[loginPassword,setLoginPassword]=useState('');const[loginError,setLoginError]=useState('');const[loginLoading,setLoginLoading]=useState(false);// URL base del proyecto frontend (Calculos)\n// Desarrollo: normalmente corre en localhost:3002 (verificar puerto correcto seg√∫n orden de inicio)\n// Producci√≥n: Carpeta hermana '../Calculos/' (Asumiendo que Mapa est√° en /Mapa/ y Calculos en /Calculos/)\nconst CALCULOS_APP_BASE_URL=process.env.NODE_ENV==='development'?'http://localhost:3002':'../Calculos/';// URL base del proyecto Ajuste Semanal\nconst AJUSTE_APP_BASE_URL=process.env.NODE_ENV==='development'?'http://localhost:3001':'../ajuste-semanal/';const calculosSrc=useMemo(()=>{const params=new URLSearchParams();params.set('mode','embed');if(loggedUser){params.set('user',loggedUser);}return\"\".concat(CALCULOS_APP_BASE_URL,\"?\").concat(params.toString());},[CALCULOS_APP_BASE_URL,loggedUser]);const ajusteSrc=useMemo(()=>{return\"\".concat(AJUSTE_APP_BASE_URL,\"?mode=embed\");},[AJUSTE_APP_BASE_URL]);const handleOpenPrecios=()=>{setLoginUser('');setLoginPassword('');setLoginError('');setShowLogin(true);};const handleLoginSubmit=async e=>{e.preventDefault();setLoginError('');setLoginLoading(true);const url='http://DE250329.esmax.cl/calculos/api/login.php';try{const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({user:loginUser,password:loginPassword})});if(!response.ok){let errorMessage='Error de autenticaci√≥n';try{const errorData=await response.json();errorMessage=errorData.error||errorData.message||errorMessage;}catch(e){// Si no es JSON, leer como texto\nconst errorText=await response.text();errorMessage=errorText||errorMessage;}throw new Error(errorMessage);}const data=await response.json();if(data.success){try{localStorage.setItem('user_calc',data.user);}catch(e){// ignoramos errores de localStorage\n}const nombre=data.user||loginUser;setLoggedUser(nombre);setShowLogin(false);setActiveApp('calculos');}else{setLoginError(data.error||'Usuario o contrase√±a incorrectos');}}catch(err){// Limpiar mensaje si contiene JSON\nlet msg=err.message||'Error al conectar con el servidor';if(msg.startsWith('{')&&msg.includes('error')){try{const parsed=JSON.parse(msg);msg=parsed.error||msg;}catch(e){}}setLoginError(msg);}finally{setLoginLoading(false);}};// Escuchar mensajes desde el iframe de c√°lculos (logout, etc.)\nuseEffect(()=>{const handleMessage=event=>{const{data}=event;if(!data||typeof data!=='object')return;if(data.type==='CALCULOS_LOGOUT'){// Volver al mapa y limpiar usuario local\nsetActiveApp('mapa');setLoggedUser(null);try{localStorage.removeItem('user_calc');}catch(e){// ignoramos errores\n}}};window.addEventListener('message',handleMessage);return()=>window.removeEventListener('message',handleMessage);},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"app-container\",children:[showLogin&&/*#__PURE__*/_jsx(\"div\",{style:{position:'fixed',top:'90px',right:'24px',zIndex:9999},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:'white',borderRadius:'16px',padding:'24px 28px',width:'100%',maxWidth:'380px',boxShadow:'0 25px 50px -12px rgba(15,23,42,0.5)',border:'1px solid #e2e8f0'},children:[/*#__PURE__*/_jsx(\"h2\",{style:{margin:0,marginBottom:'4px',fontSize:'20px',fontWeight:700,color:'#0f172a'},children:\"Iniciar sesi\\xF3n\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:0,marginBottom:'16px',fontSize:'13px',color:'#64748b'},children:\"Acceso a m\\xF3dulo de C\\xE1lculo de Precios\"}),loginError&&/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'12px',padding:'8px 10px',borderRadius:'8px',background:'#fee2e2',color:'#b91c1c',fontSize:'12px'},children:loginError}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleLoginSubmit,children:[/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'12px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Usuario\",value:loginUser,onChange:e=>setLoginUser(e.target.value),required:true,style:{width:'100%',padding:'8px 10px',borderRadius:'8px',border:'1px solid #cbd5e1',fontSize:'13px'}})}),/*#__PURE__*/_jsx(\"div\",{style:{marginBottom:'16px'},children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"Contrase\\xF1a\",value:loginPassword,onChange:e=>setLoginPassword(e.target.value),required:true,style:{width:'100%',padding:'8px 10px',borderRadius:'8px',border:'1px solid #cbd5e1',fontSize:'13px'}})}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowLogin(false),style:{flex:1,padding:'8px 10px',borderRadius:'999px',border:'1px solid #cbd5e1',background:'white',color:'#0f172a',fontSize:'13px',cursor:'pointer'},children:\"Cancelar\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",disabled:loginLoading,style:{flex:1,padding:'8px 10px',borderRadius:'999px',border:'none',background:'#0ea5e9',color:'white',fontSize:'13px',fontWeight:600,cursor:loginLoading?'default':'pointer',opacity:loginLoading?0.7:1},children:loginLoading?'Validando...':'Entrar'})]})]})]})}),/*#__PURE__*/_jsx(\"nav\",{className:\"navbar\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-container\",style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-left\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"navbar-title\",children:\"S.I.M.E\"}),/*#__PURE__*/_jsx(\"span\",{className:\"navbar-subtitle\",children:\"Sistema Integrado de Mercado y Estrategia\"}),lastUpdateTime&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',color:'rgba(12, 12, 12, 0.85)',marginTop:'2px'},children:[/*#__PURE__*/_jsx(\"span\",{style:{fontWeight:'bold'},children:\"Actualizado: \"}),/*#__PURE__*/_jsx(\"span\",{children:typeof lastUpdateTime==='string'?lastUpdateTime:new Date(lastUpdateTime).toLocaleTimeString('es-CL',{hour:'2-digit',minute:'2-digit',hour12:false})})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px',alignItems:'center'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveApp('mapa'),style:{background:activeApp==='mapa'?'rgba(255,255,255,0.25)':'transparent',color:'white',border:'1px solid rgba(255,255,255,0.5)',borderRadius:'12px',padding:'6px 16px',fontSize:'13px',cursor:'pointer',fontWeight:activeApp==='mapa'?'bold':'normal',transition:'all 0.2s'},children:\"\\uD83D\\uDDFA\\uFE0F Mapa\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setActiveApp('ajuste'),style:{background:activeApp==='ajuste'?'rgba(255,255,255,0.25)':'transparent',color:'white',border:'1px solid rgba(255,255,255,0.5)',borderRadius:'12px',padding:'6px 16px',fontSize:'13px',cursor:'pointer',fontWeight:activeApp==='ajuste'?'bold':'normal',transition:'all 0.2s'},children:\"\\uD83D\\uDCCA Ajuste Semanal\"}),/*#__PURE__*/_jsx(\"button\",{onClick:handleOpenPrecios,style:{background:activeApp==='calculos'?'rgba(255,255,255,0.25)':'transparent',color:'white',border:'1px solid rgba(255,255,255,0.5)',borderRadius:'12px',padding:'6px 16px',fontSize:'13px',cursor:'pointer',fontWeight:activeApp==='calculos'?'bold':'normal',transition:'all 0.2s'},children:\"\\uD83D\\uDD22 Calculo Precios\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"navbar-right\",style:{display:'flex',gap:'15px',alignItems:'center'},children:[activeApp==='mapa'&&/*#__PURE__*/_jsxs(\"button\",{className:\"navbar-alert-btn\",onClick:toggleAlertPanel,\"aria-label\":\"Ver alertas de mercado\",title:\"Alertas de mercado\",children:[\"\\uD83D\\uDD14\",alertCount>0&&/*#__PURE__*/_jsx(\"span\",{className:\"alert-badge\",children:alertCount})]}),/*#__PURE__*/_jsx(\"img\",{src:\"\".concat(process.env.PUBLIC_URL,\"/iconos/aramco.jpg\"),alt:\"Aramco Logo\",className:\"navbar-logo\",onError:e=>e.target.style.display='none'})]})]})}),activeApp==='mapa'&&/*#__PURE__*/_jsxs(\"div\",{className:\"panel-tabs-horizontal\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"vertical-tab-btn \".concat(sidebarVisible?'active':''),onClick:toggleSidebar,children:/*#__PURE__*/_jsx(\"div\",{className:\"vertical-tab-label\",children:sidebarVisible?'OCULTAR FILTROS':'MOSTRAR FILTROS'})}),/*#__PURE__*/_jsx(\"button\",{className:\"vertical-tab-btn \".concat(rightPanelVisible?'active':''),onClick:toggleRightPanel,children:/*#__PURE__*/_jsx(\"div\",{className:\"vertical-tab-label\",children:rightPanelVisible?'OCULTAR DATOS':'MOSTRAR DATOS'})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"main-container\",children:activeApp==='mapa'?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"aside\",{className:\"sidebar \".concat(!sidebarVisible?'hidden':''),children:[/*#__PURE__*/_jsx(\"h3\",{className:\"sidebar-title\",children:\"Filtros\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"filter-group\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"Regi\\xF3n\"}),/*#__PURE__*/_jsx(\"select\",{value:selectedRegion,onChange:e=>setSelectedRegion(e.target.value),children:regions.map(region=>/*#__PURE__*/_jsx(\"option\",{value:region,children:region},region))})]}),/*#__PURE__*/_jsx(FilterPanel,{markers:regionMarkers,allMarkers:markers,selectedRegion:selectedRegion,onFiltersChange:handleFiltersChange,onStationSelect:handleStationSelect})]}),(()=>{const markersToMap=filteredMarkers.length>0?filteredMarkers:uniqueRegionMarkers;return null;})(),/*#__PURE__*/_jsx(MapComponent,{selectedRegion:selectedRegion,regionCenter:REGION_COORDINATES[selectedRegion],markers:filteredMarkers.length>0?filteredMarkers:uniqueRegionMarkers,markersForMercado:filteredMarkers.length>0?filteredMarkersForMercado:regionMarkers,baseCompData:baseCompData,onToggleSidebar:toggleSidebar,onToggleRightPanel:toggleRightPanel,sidebarVisible:sidebarVisible,rightPanelVisible:rightPanelVisible,nivel2EnNivel1Stations:nivel2EnNivel1Stations,onToggleNivel2EnNivel1:toggleNivel2EnNivel1}),/*#__PURE__*/_jsx(\"aside\",{className:\"right-panel \".concat(!rightPanelVisible?'hidden':''),children:/*#__PURE__*/_jsx(StatisticsPanel,{markers:filteredMarkers.length>0?filteredMarkers:uniqueRegionMarkers,historicalMarkers:filteredMarkersForMercado.length>0?filteredMarkersForMercado:regionMarkers,allMarkers:markers})}),/*#__PURE__*/_jsx(AlertPanel,{isVisible:alertPanelVisible,onClose:toggleAlertPanel})]}):activeApp==='calculos'?/*#__PURE__*/// IFRAME CALCULOS\n_jsx(\"iframe\",{src:calculosSrc,title:\"Calculadora Precios\",style:{width:'100%',height:'100%',border:'none',display:'block'}}):/*#__PURE__*/// IFRAME AJUSTE SEMANAL\n_jsx(\"iframe\",{src:ajusteSrc,title:\"Ajuste Semanal\",style:{width:'100%',height:'100%',border:'none',display:'block'}})}),/*#__PURE__*/_jsx(\"div\",{className:\"navbar-version\",children:\"V3.0\"})]});}export default App;","map":{"version":3,"names":["React","useState","useMemo","useEffect","MapComponent","FilterPanel","AlertPanel","StatisticsPanel","REGION_COORDINATES","REGIONES_ORDENADAS","useMapData","getDataBaseComp","getMercadoAlerta","getMarcasCompartidas","guardarMarcasCompartidas","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","App","sidebarVisible","setSidebarVisible","rightPanelVisible","setRightPanelVisible","alertPanelVisible","setAlertPanelVisible","alertCount","setAlertCount","selectedRegion","setSelectedRegion","filteredMarkers","setFilteredMarkers","filteredMarkersForMercado","setFilteredMarkersForMercado","baseCompData","setBaseCompData","markers","lastUpdateTime","nivel2EnNivel1Stations","setNivel2EnNivel1Stations","loadMarcas","marcas","Array","isArray","err","console","error","regions","regionesConDatos","Set","map","m","Region","filter","region","has","regionMarkers","uniqueRegionMarkers","filtered","uniqueMap","Map","forEach","marker","key","pbl","id","concat","lat","lng","existing","get","set","existingDate","fecha_aplicacion","Date","currentDate","unique","from","values","log","length","loadIt","data","final","bascomp","base_comp","loadAlertCount","alertas","getStationCount","alerts","estaciones","a","Nom_Eds","Object","keys","count","interval","setInterval","clearInterval","handleFiltersChange","useCallback","filteredForMercado","handleStationSelect","station","window","leafletMap","setTimeout","setView","toggleSidebar","invalidateSize","toggleRightPanel","toggleAlertPanel","toggleNivel2EnNivel1","stationId","newStations","prev","includes","activeApp","setActiveApp","loggedUser","setLoggedUser","localStorage","getItem","e","showLogin","setShowLogin","loginUser","setLoginUser","loginPassword","setLoginPassword","loginError","setLoginError","loginLoading","setLoginLoading","CALCULOS_APP_BASE_URL","process","env","NODE_ENV","AJUSTE_APP_BASE_URL","calculosSrc","params","URLSearchParams","toString","ajusteSrc","handleOpenPrecios","handleLoginSubmit","preventDefault","url","response","fetch","method","headers","body","JSON","stringify","user","password","ok","errorMessage","errorData","json","message","errorText","text","Error","success","setItem","nombre","msg","startsWith","parsed","parse","handleMessage","event","type","removeItem","addEventListener","removeEventListener","className","children","style","position","top","right","zIndex","background","borderRadius","padding","width","maxWidth","boxShadow","border","margin","marginBottom","fontSize","fontWeight","color","onSubmit","placeholder","value","onChange","target","required","display","justifyContent","gap","onClick","flex","cursor","disabled","opacity","alignItems","marginTop","toLocaleTimeString","hour","minute","hour12","transition","title","src","PUBLIC_URL","alt","onError","allMarkers","onFiltersChange","onStationSelect","markersToMap","regionCenter","markersForMercado","onToggleSidebar","onToggleRightPanel","onToggleNivel2EnNivel1","historicalMarkers","isVisible","onClose","height"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/App.js"],"sourcesContent":["import React, { useState, useMemo, useEffect } from 'react';\r\nimport './styles/globals.css';\r\nimport './styles/layout.css';\r\nimport './styles/markers.css';\r\nimport MapComponent from './components/MapComponent';\r\nimport FilterPanel from './components/FilterPanel';\r\nimport AlertPanel from './components/AlertPanel';\r\nimport StatisticsPanel from './components/StatisticsPanel';\r\nimport { REGION_COORDINATES, REGIONES_ORDENADAS } from './utils/constants';\r\nimport { useMapData } from './hooks/useMapData';\r\nimport { getDataBaseComp, getMercadoAlerta, getMarcasCompartidas, guardarMarcasCompartidas } from './services/apiService';\r\n\r\nfunction App() {\r\n  const [sidebarVisible, setSidebarVisible] = useState(false);\r\n  const [rightPanelVisible, setRightPanelVisible] = useState(false);\r\n  const [alertPanelVisible, setAlertPanelVisible] = useState(false);\r\n  const [alertCount, setAlertCount] = useState(0);\r\n  const [selectedRegion, setSelectedRegion] = useState('Metropolitana de Santiago');\r\n  const [filteredMarkers, setFilteredMarkers] = useState([]);\r\n  const [filteredMarkersForMercado, setFilteredMarkersForMercado] = useState([]);\r\n  const [baseCompData, setBaseCompData] = useState([]);\r\n  const { markers, lastUpdateTime } = useMapData();\r\n\r\n  // Estado para estaciones marcadas como \"Nivel 2 en Nivel 1\"\r\n  const [nivel2EnNivel1Stations, setNivel2EnNivel1Stations] = useState([]);\r\n\r\n  // Cargar marcas compartidas al iniciar\r\n  useEffect(() => {\r\n    const loadMarcas = async () => {\r\n      try {\r\n        const marcas = await getMarcasCompartidas();\r\n        if (Array.isArray(marcas)) {\r\n          setNivel2EnNivel1Stations(marcas);\r\n        }\r\n      } catch (err) {\r\n        console.error('Error cargando marcas compartidas:', err);\r\n      }\r\n    };\r\n    loadMarcas();\r\n  }, []);\r\n\r\n  const regions = useMemo(() => {\r\n    const regionesConDatos = new Set(markers.map(m => m.Region));\r\n    return REGIONES_ORDENADAS.filter(region => regionesConDatos.has(region));\r\n  }, [markers]);\r\n\r\n  const regionMarkers = useMemo(() => {\r\n    return markers.filter(m => m.Region === selectedRegion);\r\n  }, [markers, selectedRegion]);\r\n\r\n  // ‚úÖ AGREGA ESTO (marcadores √∫nicos SOLO para el mapa):\r\n  const uniqueRegionMarkers = useMemo(() => {\r\n    const filtered = markers.filter(m => m.Region === selectedRegion);\r\n\r\n    // Deduplicar: mantener solo el m√°s reciente por estaci√≥n\r\n    const uniqueMap = new Map();\r\n\r\n    filtered.forEach(marker => {\r\n      const key = marker.pbl || marker.id || `${marker.lat}_${marker.lng}`;\r\n      const existing = uniqueMap.get(key);\r\n\r\n      if (!existing) {\r\n        uniqueMap.set(key, marker);\r\n      } else {\r\n        const existingDate = existing.fecha_aplicacion ? new Date(existing.fecha_aplicacion) : new Date(0);\r\n        const currentDate = marker.fecha_aplicacion ? new Date(marker.fecha_aplicacion) : new Date(0);\r\n\r\n        if (currentDate > existingDate) {\r\n          uniqueMap.set(key, marker);\r\n        }\r\n      }\r\n    });\r\n\r\n    const unique = Array.from(uniqueMap.values());\r\n    console.log(`üìç ${selectedRegion}: ${unique.length} estaciones √∫nicas de ${filtered.length} registros`);\r\n\r\n    return unique;\r\n  }, [markers, selectedRegion]);\r\n\r\n\r\n  useEffect(() => {\r\n    const loadIt = async () => {\r\n      try {\r\n        const data = await getDataBaseComp();\r\n        const final = data?.bascomp || data?.base_comp || data?.data || [];\r\n        setBaseCompData(final);\r\n      } catch (err) {\r\n        console.error('Error:', err);\r\n      }\r\n    };\r\n    loadIt();\r\n  }, []);\r\n\r\n  // NOTA: Ya no usamos localStorage para persistencia local\r\n  // La persistencia se maneja directamente al actualizar el estado\r\n\r\n  useEffect(() => {\r\n    const loadAlertCount = async () => {\r\n      try {\r\n        const alertas = await getMercadoAlerta();\r\n        const getStationCount = (alerts) => {\r\n          const estaciones = {};\r\n          alerts.forEach(a => {\r\n            estaciones[a.Nom_Eds || 'Sin nombre'] = true;\r\n          });\r\n          return Object.keys(estaciones).length;\r\n        };\r\n        const count = getStationCount(alertas);\r\n        setAlertCount(count);\r\n      } catch (err) {\r\n        console.error('Error al cargar alertas:', err);\r\n        setAlertCount(0);\r\n      }\r\n    };\r\n    loadAlertCount();\r\n    const interval = setInterval(loadAlertCount, 60000);\r\n    return () => clearInterval(interval);\r\n  }, []);\r\n\r\n  const handleFiltersChange = React.useCallback((filtered, filteredForMercado) => {\r\n    setFilteredMarkers(filtered); // ‚Üê √önicos para visualizar\r\n    setFilteredMarkersForMercado(filteredForMercado); // ‚Üê Hist√≥rico completo filtrado\r\n  }, []);\r\n\r\n  const handleStationSelect = (station) => {\r\n    if (station && window.leafletMap) {\r\n      // Change region if needed\r\n      if (station.region !== selectedRegion) {\r\n        setSelectedRegion(station.region);\r\n      }\r\n      // Center map on station with zoom\r\n      setTimeout(() => {\r\n        window.leafletMap.setView([station.lat, station.lng], 15);\r\n      }, 100);\r\n    }\r\n  };\r\n\r\n  const toggleSidebar = () => {\r\n    setSidebarVisible(!sidebarVisible);\r\n    setTimeout(() => {\r\n      if (window.leafletMap) {\r\n        window.leafletMap.invalidateSize();\r\n      }\r\n    }, 300);\r\n  };\r\n\r\n  const toggleRightPanel = () => {\r\n    setRightPanelVisible(!rightPanelVisible);\r\n    setTimeout(() => {\r\n      if (window.leafletMap) {\r\n        window.leafletMap.invalidateSize();\r\n      }\r\n    }, 300);\r\n  };\r\n\r\n  const toggleAlertPanel = () => {\r\n    setAlertPanelVisible(!alertPanelVisible);\r\n  };\r\n\r\n  const toggleNivel2EnNivel1 = async (stationId) => {\r\n    // Actualizaci√≥n optimista\r\n    let newStations = [];\r\n    setNivel2EnNivel1Stations(prev => {\r\n      if (prev.includes(stationId)) {\r\n        newStations = prev.filter(id => id !== stationId);\r\n      } else {\r\n        newStations = [...prev, stationId];\r\n      }\r\n      return newStations;\r\n    });\r\n\r\n    // Guardar en backend\r\n    try {\r\n      await guardarMarcasCompartidas(newStations);\r\n    } catch (err) {\r\n      console.error('Error guardando marcas compartidas:', err);\r\n      // Revertir en caso de error (opcional, pero recomendado)\r\n      // Por simplicidad, recargamos del servidor\r\n      const marcas = await getMarcasCompartidas();\r\n      if (Array.isArray(marcas)) {\r\n        setNivel2EnNivel1Stations(marcas);\r\n      }\r\n    }\r\n  };\r\n\r\n  // Estado para intercambiar aplicaciones\r\n  const [activeApp, setActiveApp] = useState('mapa'); // 'mapa' | 'calculos'\r\n\r\n  // Usuario autenticado para mostrar en navbar\r\n  const [loggedUser, setLoggedUser] = useState(() => {\r\n    try {\r\n      return localStorage.getItem('user_calc') || null;\r\n    } catch (e) {\r\n      return null;\r\n    }\r\n  });\r\n\r\n  // Estado para Login antes de entrar a Precios\r\n  const [showLogin, setShowLogin] = useState(false);\r\n  const [loginUser, setLoginUser] = useState('');\r\n  const [loginPassword, setLoginPassword] = useState('');\r\n  const [loginError, setLoginError] = useState('');\r\n  const [loginLoading, setLoginLoading] = useState(false);\r\n\r\n  // URL base del proyecto frontend (Calculos)\r\n  // Desarrollo: normalmente corre en localhost:3002 (verificar puerto correcto seg√∫n orden de inicio)\r\n  // Producci√≥n: Carpeta hermana '../Calculos/' (Asumiendo que Mapa est√° en /Mapa/ y Calculos en /Calculos/)\r\n  const CALCULOS_APP_BASE_URL = process.env.NODE_ENV === 'development'\r\n    ? 'http://localhost:3002'\r\n    : '../Calculos/';\r\n\r\n  // URL base del proyecto Ajuste Semanal\r\n  const AJUSTE_APP_BASE_URL = process.env.NODE_ENV === 'development'\r\n    ? 'http://localhost:3001'\r\n    : '../ajuste-semanal/';\r\n\r\n  const calculosSrc = useMemo(() => {\r\n    const params = new URLSearchParams();\r\n    params.set('mode', 'embed');\r\n    if (loggedUser) {\r\n      params.set('user', loggedUser);\r\n    }\r\n    return `${CALCULOS_APP_BASE_URL}?${params.toString()}`;\r\n  }, [CALCULOS_APP_BASE_URL, loggedUser]);\r\n\r\n  const ajusteSrc = useMemo(() => {\r\n    return `${AJUSTE_APP_BASE_URL}?mode=embed`;\r\n  }, [AJUSTE_APP_BASE_URL]);\r\n\r\n  const handleOpenPrecios = () => {\r\n    setLoginUser('');\r\n    setLoginPassword('');\r\n    setLoginError('');\r\n    setShowLogin(true);\r\n  };\r\n\r\n  const handleLoginSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setLoginError('');\r\n    setLoginLoading(true);\r\n\r\n    const url = 'http://DE250329.esmax.cl/calculos/api/login.php';\r\n\r\n    try {\r\n      const response = await fetch(url, {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify({ user: loginUser, password: loginPassword })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        let errorMessage = 'Error de autenticaci√≥n';\r\n        try {\r\n          const errorData = await response.json();\r\n          errorMessage = errorData.error || errorData.message || errorMessage;\r\n        } catch (e) {\r\n          // Si no es JSON, leer como texto\r\n          const errorText = await response.text();\r\n          errorMessage = errorText || errorMessage;\r\n        }\r\n        throw new Error(errorMessage);\r\n      }\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        try {\r\n          localStorage.setItem('user_calc', data.user);\r\n        } catch (e) {\r\n          // ignoramos errores de localStorage\r\n        }\r\n        const nombre = data.user || loginUser;\r\n        setLoggedUser(nombre);\r\n        setShowLogin(false);\r\n        setActiveApp('calculos');\r\n      } else {\r\n        setLoginError(data.error || 'Usuario o contrase√±a incorrectos');\r\n      }\r\n    } catch (err) {\r\n      // Limpiar mensaje si contiene JSON\r\n      let msg = err.message || 'Error al conectar con el servidor';\r\n      if (msg.startsWith('{') && msg.includes('error')) {\r\n        try {\r\n          const parsed = JSON.parse(msg);\r\n          msg = parsed.error || msg;\r\n        } catch (e) { }\r\n      }\r\n      setLoginError(msg);\r\n    } finally {\r\n      setLoginLoading(false);\r\n    }\r\n  };\r\n\r\n  // Escuchar mensajes desde el iframe de c√°lculos (logout, etc.)\r\n  useEffect(() => {\r\n    const handleMessage = (event) => {\r\n      const { data } = event;\r\n      if (!data || typeof data !== 'object') return;\r\n\r\n      if (data.type === 'CALCULOS_LOGOUT') {\r\n        // Volver al mapa y limpiar usuario local\r\n        setActiveApp('mapa');\r\n        setLoggedUser(null);\r\n        try {\r\n          localStorage.removeItem('user_calc');\r\n        } catch (e) {\r\n          // ignoramos errores\r\n        }\r\n      }\r\n    };\r\n\r\n    window.addEventListener('message', handleMessage);\r\n    return () => window.removeEventListener('message', handleMessage);\r\n  }, []);\r\n\r\n  return (\r\n    <div className=\"app-container\">\r\n      {/* LOGIN COMO PANTALLA FLOTANTE PARA PRECIOS */}\r\n      {showLogin && (\r\n        <div\r\n          style={{\r\n            position: 'fixed',\r\n            top: '90px',\r\n            right: '24px',\r\n            zIndex: 9999\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: 'white',\r\n              borderRadius: '16px',\r\n              padding: '24px 28px',\r\n              width: '100%',\r\n              maxWidth: '380px',\r\n              boxShadow: '0 25px 50px -12px rgba(15,23,42,0.5)',\r\n              border: '1px solid #e2e8f0'\r\n            }}\r\n          >\r\n            <h2 style={{ margin: 0, marginBottom: '4px', fontSize: '20px', fontWeight: 700, color: '#0f172a' }}>Iniciar sesi√≥n</h2>\r\n            <p style={{ margin: 0, marginBottom: '16px', fontSize: '13px', color: '#64748b' }}>Acceso a m√≥dulo de C√°lculo de Precios</p>\r\n\r\n            {loginError && (\r\n              <div style={{ marginBottom: '12px', padding: '8px 10px', borderRadius: '8px', background: '#fee2e2', color: '#b91c1c', fontSize: '12px' }}>\r\n                {loginError}\r\n              </div>\r\n            )}\r\n\r\n            <form onSubmit={handleLoginSubmit}>\r\n              <div style={{ marginBottom: '12px' }}>\r\n                <input\r\n                  type=\"text\"\r\n                  placeholder=\"Usuario\"\r\n                  value={loginUser}\r\n                  onChange={(e) => setLoginUser(e.target.value)}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '8px 10px',\r\n                    borderRadius: '8px',\r\n                    border: '1px solid #cbd5e1',\r\n                    fontSize: '13px'\r\n                  }}\r\n                />\r\n              </div>\r\n              <div style={{ marginBottom: '16px' }}>\r\n                <input\r\n                  type=\"password\"\r\n                  placeholder=\"Contrase√±a\"\r\n                  value={loginPassword}\r\n                  onChange={(e) => setLoginPassword(e.target.value)}\r\n                  required\r\n                  style={{\r\n                    width: '100%',\r\n                    padding: '8px 10px',\r\n                    borderRadius: '8px',\r\n                    border: '1px solid #cbd5e1',\r\n                    fontSize: '13px'\r\n                  }}\r\n                />\r\n              </div>\r\n\r\n              <div style={{ display: 'flex', justifyContent: 'space-between', gap: '8px' }}>\r\n                <button\r\n                  type=\"button\"\r\n                  onClick={() => setShowLogin(false)}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '8px 10px',\r\n                    borderRadius: '999px',\r\n                    border: '1px solid #cbd5e1',\r\n                    background: 'white',\r\n                    color: '#0f172a',\r\n                    fontSize: '13px',\r\n                    cursor: 'pointer'\r\n                  }}\r\n                >\r\n                  Cancelar\r\n                </button>\r\n                <button\r\n                  type=\"submit\"\r\n                  disabled={loginLoading}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: '8px 10px',\r\n                    borderRadius: '999px',\r\n                    border: 'none',\r\n                    background: '#0ea5e9',\r\n                    color: 'white',\r\n                    fontSize: '13px',\r\n                    fontWeight: 600,\r\n                    cursor: loginLoading ? 'default' : 'pointer',\r\n                    opacity: loginLoading ? 0.7 : 1\r\n                  }}\r\n                >\r\n                  {loginLoading ? 'Validando...' : 'Entrar'}\r\n                </button>\r\n              </div>\r\n            </form>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {/* ========== NAVBAR ========== */}\r\n      <nav className=\"navbar\">\r\n        <div className=\"navbar-container\" style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\r\n          {/* LEFT: Logo y T√≠tulo */}\r\n          <div className=\"navbar-left\">\r\n            <h1 className=\"navbar-title\">S.I.M.E</h1>\r\n            <span className=\"navbar-subtitle\">Sistema Integrado de Mercado y Estrategia</span>\r\n            {/* Hora de Actualizaci√≥n */}\r\n            {lastUpdateTime && (\r\n              <div style={{\r\n                fontSize: '12px',\r\n                color: 'rgba(12, 12, 12, 0.85)',\r\n                marginTop: '2px'\r\n              }}>\r\n                <span style={{ fontWeight: 'bold' }}>Actualizado: </span>\r\n                <span>{typeof lastUpdateTime === 'string' ? lastUpdateTime : new Date(lastUpdateTime).toLocaleTimeString('es-CL', { hour: '2-digit', minute: '2-digit', hour12: false })}</span>\r\n              </div>\r\n            )}\r\n          </div>\r\n\r\n          {/* CENTER: App Switcher */}\r\n          <div style={{ display: 'flex', gap: '10px', alignItems: 'center' }}>\r\n            <button\r\n              onClick={() => setActiveApp('mapa')}\r\n              style={{\r\n                background: activeApp === 'mapa' ? 'rgba(255,255,255,0.25)' : 'transparent',\r\n                color: 'white',\r\n                border: '1px solid rgba(255,255,255,0.5)',\r\n                borderRadius: '12px',\r\n                padding: '6px 16px',\r\n                fontSize: '13px',\r\n                cursor: 'pointer',\r\n                fontWeight: activeApp === 'mapa' ? 'bold' : 'normal',\r\n                transition: 'all 0.2s'\r\n              }}\r\n            >\r\n              üó∫Ô∏è Mapa\r\n            </button>\r\n            <button\r\n              onClick={() => setActiveApp('ajuste')}\r\n              style={{\r\n                background: activeApp === 'ajuste' ? 'rgba(255,255,255,0.25)' : 'transparent',\r\n                color: 'white',\r\n                border: '1px solid rgba(255,255,255,0.5)',\r\n                borderRadius: '12px',\r\n                padding: '6px 16px',\r\n                fontSize: '13px',\r\n                cursor: 'pointer',\r\n                fontWeight: activeApp === 'ajuste' ? 'bold' : 'normal',\r\n                transition: 'all 0.2s'\r\n              }}\r\n            >\r\n              üìä Ajuste Semanal\r\n            </button>\r\n            <button\r\n              onClick={handleOpenPrecios}\r\n              style={{\r\n                background: activeApp === 'calculos' ? 'rgba(255,255,255,0.25)' : 'transparent',\r\n                color: 'white',\r\n                border: '1px solid rgba(255,255,255,0.5)',\r\n                borderRadius: '12px',\r\n                padding: '6px 16px',\r\n                fontSize: '13px',\r\n                cursor: 'pointer',\r\n                fontWeight: activeApp === 'calculos' ? 'bold' : 'normal',\r\n                transition: 'all 0.2s'\r\n              }}\r\n            >\r\n              üî¢ Calculo Precios\r\n            </button>\r\n          </div>\r\n\r\n          {/* RIGHT: Alertas y Logo */}\r\n          <div className=\"navbar-right\" style={{ display: 'flex', gap: '15px', alignItems: 'center' }}>\r\n            {/* Alertas (solo en mapa) */}\r\n            {activeApp === 'mapa' && (\r\n              <button\r\n                className=\"navbar-alert-btn\"\r\n                onClick={toggleAlertPanel}\r\n                aria-label=\"Ver alertas de mercado\"\r\n                title=\"Alertas de mercado\"\r\n              >\r\n                üîî\r\n                {alertCount > 0 && (\r\n                  <span className=\"alert-badge\">{alertCount}</span>\r\n                )}\r\n              </button>\r\n            )}\r\n\r\n            <img\r\n              src={`${process.env.PUBLIC_URL}/iconos/aramco.jpg`}\r\n              alt=\"Aramco Logo\"\r\n              className=\"navbar-logo\"\r\n              onError={(e) => e.target.style.display = 'none'}\r\n            />\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      {/* ========== PESTA√ëAS HORIZONTALES (Solo Mapa) ========== */}\r\n      {activeApp === 'mapa' && (\r\n        <div className=\"panel-tabs-horizontal\">\r\n          <button\r\n            className={`vertical-tab-btn ${sidebarVisible ? 'active' : ''}`}\r\n            onClick={toggleSidebar}\r\n          >\r\n            <div className=\"vertical-tab-label\">\r\n              {sidebarVisible ? 'OCULTAR FILTROS' : 'MOSTRAR FILTROS'}\r\n            </div>\r\n          </button>\r\n\r\n          <button\r\n            className={`vertical-tab-btn ${rightPanelVisible ? 'active' : ''}`}\r\n            onClick={toggleRightPanel}\r\n          >\r\n            <div className=\"vertical-tab-label\">\r\n              {rightPanelVisible ? 'OCULTAR DATOS' : 'MOSTRAR DATOS'}\r\n            </div>\r\n          </button>\r\n        </div>\r\n      )}\r\n\r\n      {/* ========== MAIN CONTAINER ========== */}\r\n      <div className=\"main-container\">\r\n\r\n        {/* Renderizado Condicional: MAPA vs CALCULOS */}\r\n        {activeApp === 'mapa' ? (\r\n          <>\r\n            <aside className={`sidebar ${!sidebarVisible ? 'hidden' : ''}`}>\r\n              <h3 className=\"sidebar-title\">Filtros</h3>\r\n              <div className=\"filter-group\">\r\n                <label>Regi√≥n</label>\r\n                <select\r\n                  value={selectedRegion}\r\n                  onChange={(e) => setSelectedRegion(e.target.value)}\r\n                >\r\n                  {regions.map(region => (\r\n                    <option key={region} value={region}>\r\n                      {region}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              <FilterPanel\r\n                markers={regionMarkers}\r\n                allMarkers={markers}\r\n                selectedRegion={selectedRegion}\r\n                onFiltersChange={handleFiltersChange}\r\n                onStationSelect={handleStationSelect}\r\n              />\r\n            </aside>\r\n\r\n            {(() => {\r\n              const markersToMap = filteredMarkers.length > 0 ? filteredMarkers : uniqueRegionMarkers;\r\n              return null;\r\n            })()}\r\n\r\n            <MapComponent\r\n              selectedRegion={selectedRegion}\r\n              regionCenter={REGION_COORDINATES[selectedRegion]}\r\n              markers={filteredMarkers.length > 0 ? filteredMarkers : uniqueRegionMarkers}\r\n              markersForMercado={filteredMarkers.length > 0 ? filteredMarkersForMercado : regionMarkers}\r\n              baseCompData={baseCompData}\r\n              onToggleSidebar={toggleSidebar}\r\n              onToggleRightPanel={toggleRightPanel}\r\n              sidebarVisible={sidebarVisible}\r\n              rightPanelVisible={rightPanelVisible}\r\n              nivel2EnNivel1Stations={nivel2EnNivel1Stations}\r\n              onToggleNivel2EnNivel1={toggleNivel2EnNivel1}\r\n            />\r\n\r\n            <aside className={`right-panel ${!rightPanelVisible ? 'hidden' : ''}`}>\r\n              <StatisticsPanel\r\n                markers={filteredMarkers.length > 0 ? filteredMarkers : uniqueRegionMarkers}\r\n                historicalMarkers={filteredMarkersForMercado.length > 0 ? filteredMarkersForMercado : regionMarkers}\r\n                allMarkers={markers}\r\n              />\r\n            </aside>\r\n\r\n            <AlertPanel\r\n              isVisible={alertPanelVisible}\r\n              onClose={toggleAlertPanel}\r\n            />\r\n          </>\r\n        ) : activeApp === 'calculos' ? (\r\n          // IFRAME CALCULOS\r\n          <iframe\r\n            src={calculosSrc}\r\n            title=\"Calculadora Precios\"\r\n            style={{\r\n              width: '100%',\r\n              height: '100%',\r\n              border: 'none',\r\n              display: 'block'\r\n            }}\r\n          />\r\n        ) : (\r\n          // IFRAME AJUSTE SEMANAL\r\n          <iframe\r\n            src={ajusteSrc}\r\n            title=\"Ajuste Semanal\"\r\n            style={{\r\n              width: '100%',\r\n              height: '100%',\r\n              border: 'none',\r\n              display: 'block'\r\n            }}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"navbar-version\">V3.0</div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}