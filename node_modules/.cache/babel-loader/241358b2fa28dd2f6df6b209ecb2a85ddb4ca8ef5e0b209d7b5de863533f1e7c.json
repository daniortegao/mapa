{"ast":null,"code":"import React,{useMemo}from'react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const VolatilityStats=_ref=>{let{markers}=_ref;const volatilityData=useMemo(()=>{if(!markers||markers.length===0)return null;const brandPriceHistory={};// Group markers by brand and PBL to track price changes over time\nmarkers.forEach(m=>{const brand=m.Marca||'Otras';const pbl=m.pbl;const fecha=m.fecha_aplicacion;if(!brandPriceHistory[brand]){brandPriceHistory[brand]={};}if(!brandPriceHistory[brand][pbl]){brandPriceHistory[brand][pbl]=[];}brandPriceHistory[brand][pbl].push({fecha,g93:parseFloat(m.precio_g93||m.G93)||null});});// Calculate volatility metrics for each brand\nconst volatilityStats={};Object.keys(brandPriceHistory).forEach(brand=>{const stations=brandPriceHistory[brand];let totalChanges=0;let totalMagnitude=0;let allPrices=[];let stationCount=0;Object.keys(stations).forEach(pbl=>{const history=stations[pbl].sort((a,b)=>new Date(a.fecha)-new Date(b.fecha));if(history.length>1){stationCount++;// Count price changes for G93\nfor(let i=1;i<history.length;i++){if(history[i].g93!==null&&history[i-1].g93!==null){allPrices.push(history[i].g93);const change=Math.abs(history[i].g93-history[i-1].g93);if(change>0.5){// Consider changes > 0.5 as significant\ntotalChanges++;totalMagnitude+=change;}}}}});if(stationCount>0&&allPrices.length>0){// Calculate standard deviation\nconst mean=allPrices.reduce((sum,p)=>sum+p,0)/allPrices.length;const variance=allPrices.reduce((sum,p)=>sum+Math.pow(p-mean,2),0)/allPrices.length;const stdDev=Math.sqrt(variance);volatilityStats[brand]={changeFrequency:totalChanges/stationCount,avgMagnitude:totalChanges>0?totalMagnitude/totalChanges:0,stdDev:stdDev,stationCount:stationCount};}});return volatilityStats;},[markers]);if(!volatilityData||Object.keys(volatilityData).length===0){return/*#__PURE__*/_jsx(\"div\",{className:\"stats-empty\",children:\"Sin datos de volatilidad\"});}return/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-container\",children:[/*#__PURE__*/_jsx(\"h4\",{className:\"stats-title\",children:\"Volatilidad de Precios (G93)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"volatility-grid\",children:Object.keys(volatilityData).sort((a,b)=>volatilityData[b].changeFrequency-volatilityData[a].changeFrequency).map(brand=>{const vol=volatilityData[brand];return/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-card\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"volatility-brand\",children:brand}),/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-metrics\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-metric\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"metric-label\",children:\"Cambios/Estaci\\xF3n:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"metric-value\",children:vol.changeFrequency.toFixed(1)})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-metric\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"metric-label\",children:\"Magnitud Prom:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"metric-value\",children:[\"$\",vol.avgMagnitude.toFixed(0)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-metric\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"metric-label\",children:\"Desv. Est\\xE1ndar:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"metric-value\",children:[\"$\",vol.stdDev.toFixed(0)]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"volatility-metric\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"metric-label\",children:\"Estaciones:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"metric-value\",children:vol.stationCount})]})]})]},brand);})})]});};export default VolatilityStats;","map":{"version":3,"names":["React","useMemo","jsx","_jsx","jsxs","_jsxs","VolatilityStats","_ref","markers","volatilityData","length","brandPriceHistory","forEach","m","brand","Marca","pbl","fecha","fecha_aplicacion","push","g93","parseFloat","precio_g93","G93","volatilityStats","Object","keys","stations","totalChanges","totalMagnitude","allPrices","stationCount","history","sort","a","b","Date","i","change","Math","abs","mean","reduce","sum","p","variance","pow","stdDev","sqrt","changeFrequency","avgMagnitude","className","children","map","vol","toFixed"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/VolatilityStats.jsx"],"sourcesContent":["import React, { useMemo } from 'react';\r\n\r\nconst VolatilityStats = ({ markers }) => {\r\n    const volatilityData = useMemo(() => {\r\n        if (!markers || markers.length === 0) return null;\r\n\r\n        const brandPriceHistory = {};\r\n\r\n        // Group markers by brand and PBL to track price changes over time\r\n        markers.forEach(m => {\r\n            const brand = m.Marca || 'Otras';\r\n            const pbl = m.pbl;\r\n            const fecha = m.fecha_aplicacion;\r\n\r\n            if (!brandPriceHistory[brand]) {\r\n                brandPriceHistory[brand] = {};\r\n            }\r\n            if (!brandPriceHistory[brand][pbl]) {\r\n                brandPriceHistory[brand][pbl] = [];\r\n            }\r\n\r\n            brandPriceHistory[brand][pbl].push({\r\n                fecha,\r\n                g93: parseFloat(m.precio_g93 || m.G93) || null\r\n            });\r\n        });\r\n\r\n        // Calculate volatility metrics for each brand\r\n        const volatilityStats = {};\r\n        Object.keys(brandPriceHistory).forEach(brand => {\r\n            const stations = brandPriceHistory[brand];\r\n            let totalChanges = 0;\r\n            let totalMagnitude = 0;\r\n            let allPrices = [];\r\n            let stationCount = 0;\r\n\r\n            Object.keys(stations).forEach(pbl => {\r\n                const history = stations[pbl].sort((a, b) => new Date(a.fecha) - new Date(b.fecha));\r\n\r\n                if (history.length > 1) {\r\n                    stationCount++;\r\n\r\n                    // Count price changes for G93\r\n                    for (let i = 1; i < history.length; i++) {\r\n                        if (history[i].g93 !== null && history[i - 1].g93 !== null) {\r\n                            allPrices.push(history[i].g93);\r\n                            const change = Math.abs(history[i].g93 - history[i - 1].g93);\r\n                            if (change > 0.5) { // Consider changes > 0.5 as significant\r\n                                totalChanges++;\r\n                                totalMagnitude += change;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n\r\n            if (stationCount > 0 && allPrices.length > 0) {\r\n                // Calculate standard deviation\r\n                const mean = allPrices.reduce((sum, p) => sum + p, 0) / allPrices.length;\r\n                const variance = allPrices.reduce((sum, p) => sum + Math.pow(p - mean, 2), 0) / allPrices.length;\r\n                const stdDev = Math.sqrt(variance);\r\n\r\n                volatilityStats[brand] = {\r\n                    changeFrequency: totalChanges / stationCount,\r\n                    avgMagnitude: totalChanges > 0 ? totalMagnitude / totalChanges : 0,\r\n                    stdDev: stdDev,\r\n                    stationCount: stationCount\r\n                };\r\n            }\r\n        });\r\n\r\n        return volatilityStats;\r\n    }, [markers]);\r\n\r\n    if (!volatilityData || Object.keys(volatilityData).length === 0) {\r\n        return <div className=\"stats-empty\">Sin datos de volatilidad</div>;\r\n    }\r\n\r\n    return (\r\n        <div className=\"volatility-container\">\r\n            <h4 className=\"stats-title\">Volatilidad de Precios (G93)</h4>\r\n            <div className=\"volatility-grid\">\r\n                {Object.keys(volatilityData)\r\n                    .sort((a, b) => volatilityData[b].changeFrequency - volatilityData[a].changeFrequency)\r\n                    .map(brand => {\r\n                        const vol = volatilityData[brand];\r\n                        return (\r\n                            <div key={brand} className=\"volatility-card\">\r\n                                <div className=\"volatility-brand\">{brand}</div>\r\n                                <div className=\"volatility-metrics\">\r\n                                    <div className=\"volatility-metric\">\r\n                                        <span className=\"metric-label\">Cambios/Estación:</span>\r\n                                        <span className=\"metric-value\">{vol.changeFrequency.toFixed(1)}</span>\r\n                                    </div>\r\n                                    <div className=\"volatility-metric\">\r\n                                        <span className=\"metric-label\">Magnitud Prom:</span>\r\n                                        <span className=\"metric-value\">${vol.avgMagnitude.toFixed(0)}</span>\r\n                                    </div>\r\n                                    <div className=\"volatility-metric\">\r\n                                        <span className=\"metric-label\">Desv. Estándar:</span>\r\n                                        <span className=\"metric-value\">${vol.stdDev.toFixed(0)}</span>\r\n                                    </div>\r\n                                    <div className=\"volatility-metric\">\r\n                                        <span className=\"metric-label\">Estaciones:</span>\r\n                                        <span className=\"metric-value\">{vol.stationCount}</span>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        );\r\n                    })}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default VolatilityStats;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}