{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { useMap } from 'react-leaflet';\nimport L from 'leaflet';\nimport { createCustomIcon, createBrandLogo } from '../utils/iconHelpers';\nconst IconMarkersLayer = ({\n  markers,\n  selectedRegion,\n  baseCompData = []\n}) => {\n  _s();\n  const map = useMap();\n  const markersRef = useRef({}); // Markers actualmente visibles\n  const allMarkersRef = useRef({}); // TODOS los markers (visibles e invisibles)\n  const cacheRef = useRef({});\n  const updateInProgressRef = useRef(false);\n  const zoomUpdateRef = useRef(null);\n  const [showingAssociated, setShowingAssociated] = useState(false);\n  const [originalPopupMarker, setOriginalPopupMarker] = useState(null);\n  const makeDraggable = useCallback(popup => {\n    if (!map || !popup || !popup._container) return;\n    try {\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\n      L.DomUtil.setPosition(popup._wrapper.parentNode, pos);\n      const draggable = new L.Draggable(popup._container, popup._wrapper);\n      draggable.enable();\n    } catch (error) {\n      console.error('Error draggable:', error);\n    }\n  }, [map]);\n  const handleShowMercado = useCallback(marker => {\n    // Buscar la competencia en allMarkersRef (TODOS los markers)\n    const markersEnComunaDelEds = Object.values(allMarkersRef.current).filter(ref => ref.data.Comuna === marker.Comuna).map(ref => ref.data);\n\n    // Opacar todos\n    Object.values(allMarkersRef.current).forEach(markerRef => {\n      if (markerRef.marker) {\n        markerRef.marker.setOpacity(0.3);\n      }\n    });\n\n    // Mostrar solo los de la comuna\n    markersEnComunaDelEds.forEach(m => {\n      if (allMarkersRef.current[m.id] && allMarkersRef.current[m.id].marker) {\n        allMarkersRef.current[m.id].marker.setOpacity(1);\n      }\n    });\n    setShowingAssociated(true);\n    setOriginalPopupMarker(marker);\n    console.log(`Mostrando mercado para: ${marker.nombre} en Comuna: ${marker.Comuna}`);\n    console.log(`Total de estaciones en esta comuna: ${markersEnComunaDelEds.length}`);\n  }, []);\n  const handleBackFromMercado = useCallback(() => {\n    // Mostrar todos los que estaban visibles antes\n    Object.values(markersRef.current).forEach(markerRef => {\n      if (markerRef.marker) {\n        markerRef.marker.setOpacity(1);\n      }\n    });\n    // Ocultar los que no estaban visibles\n    Object.values(allMarkersRef.current).forEach(markerRef => {\n      if (!markersRef.current[markerRef.data.id] && markerRef.marker) {\n        markerRef.marker.setOpacity(0);\n      }\n    });\n    setShowingAssociated(false);\n    setOriginalPopupMarker(null);\n  }, []);\n  const createMarkerPopup = useCallback((marker, mapInstance) => {\n    const lat = parseFloat(marker.lat);\n    const lng = parseFloat(marker.lng);\n    if (isNaN(lat) || isNaN(lng)) return;\n    const iconUrl = createCustomIcon(marker.Marca);\n    const leafletMarker = L.marker([lat, lng], {\n      icon: iconUrl\n    }).addTo(mapInstance);\n    let popupContent = `\n      <div class=\"popup-content\">\n        <strong>${marker.nombre}</strong><br/>\n        Marca: ${marker.Marca}<br/>\n        EDS: ${marker.eds}<br/>\n        Comuna: ${marker.Comuna}<br/>\n        Región: ${marker.Region}\n        <button class=\"btn-mercado\" data-marker-id=\"${marker.id}\">Ver Mercado</button>\n      </div>\n    `;\n    const popup = L.popup({\n      maxWidth: 300\n    }).setContent(popupContent);\n    leafletMarker.bindPopup(popup);\n    leafletMarker.on('click', () => {\n      mapInstance.setView([lat, lng], mapInstance.getZoom());\n      setTimeout(() => {\n        makeDraggable(popup);\n        const btn = document.querySelector(`[data-marker-id=\"${marker.id}\"]`);\n        if (btn) {\n          btn.addEventListener('click', e => {\n            e.stopPropagation();\n            handleShowMercado(marker);\n          });\n        }\n      }, 100);\n    });\n    return {\n      marker: leafletMarker,\n      data: marker,\n      popup: popup\n    };\n  }, [makeDraggable, handleShowMercado]);\n\n  // Mantener TODOS los markers en allMarkersRef\n  useEffect(() => {\n    if (!map) return;\n\n    // Agregar markers que falten en allMarkersRef\n    const allMarkersData = baseCompData.length > 0 ? baseCompData : markers;\n    allMarkersData.forEach(marker => {\n      if (!allMarkersRef.current[marker.id]) {\n        const markerRef = createMarkerPopup(marker, map);\n        if (markerRef) {\n          allMarkersRef.current[marker.id] = markerRef;\n          // Inicialmente ocultos\n          markerRef.marker.setOpacity(0);\n        }\n      }\n    });\n  }, [map, markers, baseCompData, createMarkerPopup]);\n\n  // Mostrar/ocultar markers según el filtro actual\n  useEffect(() => {\n    if (!map) return;\n\n    // Limpiar markersRef\n    markersRef.current = {};\n\n    // Mostrar solo los markers filtrados\n    markers.forEach(marker => {\n      if (allMarkersRef.current[marker.id]) {\n        allMarkersRef.current[marker.id].marker.setOpacity(1);\n        markersRef.current[marker.id] = allMarkersRef.current[marker.id];\n      } else {\n        // Crear marker si no existe\n        const markerRef = createMarkerPopup(marker, map);\n        if (markerRef) {\n          allMarkersRef.current[marker.id] = markerRef;\n          markerRef.marker.setOpacity(1);\n          markersRef.current[marker.id] = markerRef;\n        }\n      }\n    });\n\n    // Ocultar markers que no están en el filtro actual\n    Object.keys(allMarkersRef.current).forEach(markerId => {\n      if (!markersRef.current[markerId]) {\n        if (!showingAssociated) {\n          allMarkersRef.current[markerId].marker.setOpacity(0);\n        }\n      }\n    });\n  }, [markers, map, showingAssociated, createMarkerPopup]);\n  useEffect(() => {\n    const handleBackClick = () => {\n      if (showingAssociated) {\n        handleBackFromMercado();\n      }\n    };\n    document.addEventListener('custom-back-mercado', handleBackClick);\n    return () => {\n      document.removeEventListener('custom-back-mercado', handleBackClick);\n    };\n  }, [showingAssociated, handleBackFromMercado]);\n  return null;\n};\n_s(IconMarkersLayer, \"XyZdD6T00DTSNFIb7dFBE6lWosE=\", false, function () {\n  return [useMap];\n});\n_c = IconMarkersLayer;\nexport default IconMarkersLayer;\nvar _c;\n$RefreshReg$(_c, \"IconMarkersLayer\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","useMap","L","createCustomIcon","createBrandLogo","IconMarkersLayer","markers","selectedRegion","baseCompData","_s","map","markersRef","allMarkersRef","cacheRef","updateInProgressRef","zoomUpdateRef","showingAssociated","setShowingAssociated","originalPopupMarker","setOriginalPopupMarker","makeDraggable","popup","_container","pos","latLngToLayerPoint","getLatLng","DomUtil","setPosition","_wrapper","parentNode","draggable","Draggable","enable","error","console","handleShowMercado","marker","markersEnComunaDelEds","Object","values","current","filter","ref","data","Comuna","forEach","markerRef","setOpacity","m","id","log","nombre","length","handleBackFromMercado","createMarkerPopup","mapInstance","lat","parseFloat","lng","isNaN","iconUrl","Marca","leafletMarker","icon","addTo","popupContent","eds","Region","maxWidth","setContent","bindPopup","on","setView","getZoom","setTimeout","btn","document","querySelector","addEventListener","e","stopPropagation","allMarkersData","keys","markerId","handleBackClick","removeEventListener","_c","$RefreshReg$"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/IconMarkersLayer.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { useMap } from 'react-leaflet';\r\nimport L from 'leaflet';\r\nimport { createCustomIcon, createBrandLogo } from '../utils/iconHelpers';\r\n\r\nconst IconMarkersLayer = ({ markers, selectedRegion, baseCompData = [] }) => {\r\n  const map = useMap();\r\n  const markersRef = useRef({}); // Markers actualmente visibles\r\n  const allMarkersRef = useRef({}); // TODOS los markers (visibles e invisibles)\r\n  const cacheRef = useRef({});\r\n  const updateInProgressRef = useRef(false);\r\n  const zoomUpdateRef = useRef(null);\r\n  const [showingAssociated, setShowingAssociated] = useState(false);\r\n  const [originalPopupMarker, setOriginalPopupMarker] = useState(null);\r\n\r\n  const makeDraggable = useCallback((popup) => {\r\n    if (!map || !popup || !popup._container) return;\r\n    try {\r\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\r\n      L.DomUtil.setPosition(popup._wrapper.parentNode, pos);\r\n      const draggable = new L.Draggable(popup._container, popup._wrapper);\r\n      draggable.enable();\r\n    } catch (error) {\r\n      console.error('Error draggable:', error);\r\n    }\r\n  }, [map]);\r\n\r\n  const handleShowMercado = useCallback((marker) => {\r\n    // Buscar la competencia en allMarkersRef (TODOS los markers)\r\n    const markersEnComunaDelEds = Object.values(allMarkersRef.current)\r\n      .filter(ref => ref.data.Comuna === marker.Comuna)\r\n      .map(ref => ref.data);\r\n\r\n    // Opacar todos\r\n    Object.values(allMarkersRef.current).forEach(markerRef => {\r\n      if (markerRef.marker) {\r\n        markerRef.marker.setOpacity(0.3);\r\n      }\r\n    });\r\n\r\n    // Mostrar solo los de la comuna\r\n    markersEnComunaDelEds.forEach(m => {\r\n      if (allMarkersRef.current[m.id] && allMarkersRef.current[m.id].marker) {\r\n        allMarkersRef.current[m.id].marker.setOpacity(1);\r\n      }\r\n    });\r\n\r\n    setShowingAssociated(true);\r\n    setOriginalPopupMarker(marker);\r\n\r\n    console.log(`Mostrando mercado para: ${marker.nombre} en Comuna: ${marker.Comuna}`);\r\n    console.log(`Total de estaciones en esta comuna: ${markersEnComunaDelEds.length}`);\r\n  }, []);\r\n\r\n  const handleBackFromMercado = useCallback(() => {\r\n    // Mostrar todos los que estaban visibles antes\r\n    Object.values(markersRef.current).forEach(markerRef => {\r\n      if (markerRef.marker) {\r\n        markerRef.marker.setOpacity(1);\r\n      }\r\n    });\r\n    // Ocultar los que no estaban visibles\r\n    Object.values(allMarkersRef.current).forEach(markerRef => {\r\n      if (!markersRef.current[markerRef.data.id] && markerRef.marker) {\r\n        markerRef.marker.setOpacity(0);\r\n      }\r\n    });\r\n    setShowingAssociated(false);\r\n    setOriginalPopupMarker(null);\r\n  }, []);\r\n\r\n  const createMarkerPopup = useCallback((marker, mapInstance) => {\r\n    const lat = parseFloat(marker.lat);\r\n    const lng = parseFloat(marker.lng);\r\n\r\n    if (isNaN(lat) || isNaN(lng)) return;\r\n\r\n    const iconUrl = createCustomIcon(marker.Marca);\r\n    const leafletMarker = L.marker([lat, lng], { icon: iconUrl }).addTo(mapInstance);\r\n\r\n    let popupContent = `\r\n      <div class=\"popup-content\">\r\n        <strong>${marker.nombre}</strong><br/>\r\n        Marca: ${marker.Marca}<br/>\r\n        EDS: ${marker.eds}<br/>\r\n        Comuna: ${marker.Comuna}<br/>\r\n        Región: ${marker.Region}\r\n        <button class=\"btn-mercado\" data-marker-id=\"${marker.id}\">Ver Mercado</button>\r\n      </div>\r\n    `;\r\n\r\n    const popup = L.popup({ maxWidth: 300 }).setContent(popupContent);\r\n    leafletMarker.bindPopup(popup);\r\n\r\n    leafletMarker.on('click', () => {\r\n      mapInstance.setView([lat, lng], mapInstance.getZoom());\r\n      setTimeout(() => {\r\n        makeDraggable(popup);\r\n        const btn = document.querySelector(`[data-marker-id=\"${marker.id}\"]`);\r\n        if (btn) {\r\n          btn.addEventListener('click', (e) => {\r\n            e.stopPropagation();\r\n            handleShowMercado(marker);\r\n          });\r\n        }\r\n      }, 100);\r\n    });\r\n\r\n    return { marker: leafletMarker, data: marker, popup: popup };\r\n  }, [makeDraggable, handleShowMercado]);\r\n\r\n  // Mantener TODOS los markers en allMarkersRef\r\n  useEffect(() => {\r\n    if (!map) return;\r\n\r\n    // Agregar markers que falten en allMarkersRef\r\n    const allMarkersData = baseCompData.length > 0 ? baseCompData : markers;\r\n    \r\n    allMarkersData.forEach(marker => {\r\n      if (!allMarkersRef.current[marker.id]) {\r\n        const markerRef = createMarkerPopup(marker, map);\r\n        if (markerRef) {\r\n          allMarkersRef.current[marker.id] = markerRef;\r\n          // Inicialmente ocultos\r\n          markerRef.marker.setOpacity(0);\r\n        }\r\n      }\r\n    });\r\n  }, [map, markers, baseCompData, createMarkerPopup]);\r\n\r\n  // Mostrar/ocultar markers según el filtro actual\r\n  useEffect(() => {\r\n    if (!map) return;\r\n\r\n    // Limpiar markersRef\r\n    markersRef.current = {};\r\n\r\n    // Mostrar solo los markers filtrados\r\n    markers.forEach(marker => {\r\n      if (allMarkersRef.current[marker.id]) {\r\n        allMarkersRef.current[marker.id].marker.setOpacity(1);\r\n        markersRef.current[marker.id] = allMarkersRef.current[marker.id];\r\n      } else {\r\n        // Crear marker si no existe\r\n        const markerRef = createMarkerPopup(marker, map);\r\n        if (markerRef) {\r\n          allMarkersRef.current[marker.id] = markerRef;\r\n          markerRef.marker.setOpacity(1);\r\n          markersRef.current[marker.id] = markerRef;\r\n        }\r\n      }\r\n    });\r\n\r\n    // Ocultar markers que no están en el filtro actual\r\n    Object.keys(allMarkersRef.current).forEach(markerId => {\r\n      if (!markersRef.current[markerId]) {\r\n        if (!showingAssociated) {\r\n          allMarkersRef.current[markerId].marker.setOpacity(0);\r\n        }\r\n      }\r\n    });\r\n  }, [markers, map, showingAssociated, createMarkerPopup]);\r\n\r\n  useEffect(() => {\r\n    const handleBackClick = () => {\r\n      if (showingAssociated) {\r\n        handleBackFromMercado();\r\n      }\r\n    };\r\n\r\n    document.addEventListener('custom-back-mercado', handleBackClick);\r\n    return () => {\r\n      document.removeEventListener('custom-back-mercado', handleBackClick);\r\n    };\r\n  }, [showingAssociated, handleBackFromMercado]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default IconMarkersLayer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}