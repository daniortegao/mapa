{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{getNotasCompartidas,guardarNotasCompartidas}from'../services/apiService';import'../styles/NotesModal.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const NotesModal=_ref=>{let{isOpen,onClose}=_ref;const[notes,setNotes]=useState('');const[loading,setLoading]=useState(true);const saveTimeoutRef=useRef(null);// Load notes from server on mount\nuseEffect(()=>{if(isOpen){loadNotes();}},[isOpen]);const loadNotes=async()=>{try{setLoading(true);const notasFromServer=await getNotasCompartidas();setNotes(notasFromServer||'');}catch(error){console.error('Error cargando notas:',error);setNotes('');}finally{setLoading(false);}};// Auto-save notes with debounce\nuseEffect(()=>{if(loading)return;// Don't save while loading\nif(saveTimeoutRef.current){clearTimeout(saveTimeoutRef.current);}saveTimeoutRef.current=setTimeout(async()=>{try{await guardarNotasCompartidas(notes);console.log('üìù Notas guardadas');}catch(error){console.error('Error guardando notas:',error);}},500);return()=>{if(saveTimeoutRef.current){clearTimeout(saveTimeoutRef.current);}};},[notes,loading]);const handleClearAll=async()=>{try{setNotes('');await guardarNotasCompartidas('');console.log('üìù Todas las notas borradas');}catch(error){console.error('Error borrando notas:',error);}};return/*#__PURE__*/_jsxs(\"aside\",{className:\"notes-panel\".concat(!isOpen?' hidden':''),children:[/*#__PURE__*/_jsxs(\"div\",{className:\"notes-panel-header\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"\\uD83D\\uDCDD Notas Compartidas\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notes-close-btn\",onClick:onClose,children:\"\\u2715\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"notes-panel-body\",children:loading?/*#__PURE__*/_jsx(\"div\",{className:\"notes-loading\",children:\"Cargando notas...\"}):/*#__PURE__*/_jsx(\"textarea\",{className:\"notes-textarea\",placeholder:\"Escribe tus notas aqu\\xED... Se guardar\\xE1n autom\\xE1ticamente y ser\\xE1n visibles para todos los usuarios.\",value:notes,onChange:e=>setNotes(e.target.value),autoFocus:true})}),/*#__PURE__*/_jsxs(\"div\",{className:\"notes-panel-footer\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"notes-autosave-indicator\",children:\"\\uD83D\\uDCBE Guardado autom\\xE1tico (compartido)\"}),/*#__PURE__*/_jsx(\"button\",{className:\"notes-clear-btn\",onClick:handleClearAll,children:\"\\uD83D\\uDDD1\\uFE0F Borrar todo\"})]})]});};export default NotesModal;","map":{"version":3,"names":["React","useState","useEffect","useRef","getNotasCompartidas","guardarNotasCompartidas","jsx","_jsx","jsxs","_jsxs","NotesModal","_ref","isOpen","onClose","notes","setNotes","loading","setLoading","saveTimeoutRef","loadNotes","notasFromServer","error","console","current","clearTimeout","setTimeout","log","handleClearAll","className","concat","children","onClick","placeholder","value","onChange","e","target","autoFocus"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/NotesModal.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { getNotasCompartidas, guardarNotasCompartidas } from '../services/apiService';\r\nimport '../styles/NotesModal.css';\r\n\r\nconst NotesModal = ({ isOpen, onClose }) => {\r\n    const [notes, setNotes] = useState('');\r\n    const [loading, setLoading] = useState(true);\r\n    const saveTimeoutRef = useRef(null);\r\n\r\n    // Load notes from server on mount\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            loadNotes();\r\n        }\r\n    }, [isOpen]);\r\n\r\n    const loadNotes = async () => {\r\n        try {\r\n            setLoading(true);\r\n            const notasFromServer = await getNotasCompartidas();\r\n            setNotes(notasFromServer || '');\r\n        } catch (error) {\r\n            console.error('Error cargando notas:', error);\r\n            setNotes('');\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    // Auto-save notes with debounce\r\n    useEffect(() => {\r\n        if (loading) return; // Don't save while loading\r\n\r\n        if (saveTimeoutRef.current) {\r\n            clearTimeout(saveTimeoutRef.current);\r\n        }\r\n\r\n        saveTimeoutRef.current = setTimeout(async () => {\r\n            try {\r\n                await guardarNotasCompartidas(notes);\r\n                console.log('üìù Notas guardadas');\r\n            } catch (error) {\r\n                console.error('Error guardando notas:', error);\r\n            }\r\n        }, 500);\r\n\r\n        return () => {\r\n            if (saveTimeoutRef.current) {\r\n                clearTimeout(saveTimeoutRef.current);\r\n            }\r\n        };\r\n    }, [notes, loading]);\r\n\r\n    const handleClearAll = async () => {\r\n        try {\r\n            setNotes('');\r\n            await guardarNotasCompartidas('');\r\n            console.log('üìù Todas las notas borradas');\r\n        } catch (error) {\r\n            console.error('Error borrando notas:', error);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <aside className={`notes-panel${!isOpen ? ' hidden' : ''}`}>\r\n            <div className=\"notes-panel-header\">\r\n                <h2>üìù Notas Compartidas</h2>\r\n                <button className=\"notes-close-btn\" onClick={onClose}>‚úï</button>\r\n            </div>\r\n            <div className=\"notes-panel-body\">\r\n                {loading ? (\r\n                    <div className=\"notes-loading\">Cargando notas...</div>\r\n                ) : (\r\n                    <textarea\r\n                        className=\"notes-textarea\"\r\n                        placeholder=\"Escribe tus notas aqu√≠... Se guardar√°n autom√°ticamente y ser√°n visibles para todos los usuarios.\"\r\n                        value={notes}\r\n                        onChange={(e) => setNotes(e.target.value)}\r\n                        autoFocus\r\n                    />\r\n                )}\r\n            </div>\r\n            <div className=\"notes-panel-footer\">\r\n                <span className=\"notes-autosave-indicator\">\r\n                    üíæ Guardado autom√°tico (compartido)\r\n                </span>\r\n                <button className=\"notes-clear-btn\" onClick={handleClearAll}>\r\n                    üóëÔ∏è Borrar todo\r\n                </button>\r\n            </div>\r\n        </aside>\r\n    );\r\n};\r\n\r\nexport default NotesModal;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}