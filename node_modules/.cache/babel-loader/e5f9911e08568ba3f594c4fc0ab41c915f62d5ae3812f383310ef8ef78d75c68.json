{"ast":null,"code":"var _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from \"react\";\nimport { useMap } from \"react-leaflet\";\nimport L from \"leaflet\";\nimport { createCustomIcon, createBrandLogo } from \"../utils/iconHelpers\";\nconst IconMarkersLayer = ({\n  markers,\n  // lista filtrada NORMAL (incluye EDS si está activo)\n  markersForMercado,\n  // lista filtrada SIN EDS (para Mercado)\n  selectedRegion,\n  baseCompData // base para competencia por PBL\n}) => {\n  _s();\n  const map = useMap();\n  const markersRef = useRef({});\n  const cacheRef = useRef({});\n  const updateInProgressRef = useRef(false);\n  const zoomUpdateRef = useRef(null);\n  const [showingAssociated, setShowingAssociated] = useState(false);\n  const [originalPopupMarker, setOriginalPopupMarker] = useState(null);\n  const makeDraggable = useCallback(popup => {\n    if (!map || !popup || !popup.container) return;\n    try {\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\n      L.DomUtil.setPosition(popup.wrapper.parentNode, pos);\n      const draggable = new L.Draggable(popup.container, popup.wrapper);\n      draggable.enable();\n    } catch (error) {\n      console.error(\"Error draggable\", error);\n    }\n  }, [map]);\n\n  // Añadir marcadores al mapa\n  const addMarkers = useCallback((data, mapInstance) => {\n    data.forEach(marker => {\n      const lat = parseFloat(marker.lat);\n      const lng = parseFloat(marker.lng);\n      if (!isNaN(lat) && !isNaN(lng)) {\n        const iconUrl = createCustomIcon(marker.Marca);\n        const leafletMarker = L.marker([lat, lng], {\n          icon: iconUrl\n        }).addTo(mapInstance);\n        let popupContent = `\n          <div class=\"popup-container\">\n            <div class=\"popup-header\">\n              <img src=\"${createBrandLogo(marker.Marca)}\" alt=\"${marker.Marca}\" style=\"width:30px;height:30px;border-radius:50%;object-fit:cover;margin-right:8px\" onerror=\"this.style.display='none'\"/>\n              <h3 style=\"margin:0\">${marker.nombre} - ${marker.Marca}</h3>\n            </div>\n            <div class=\"popup-content\">\n              <div class=\"popup-data\">\n                <strong>Marca</strong>: ${marker.Marca}<br/>\n                <strong>PBL</strong>: ${marker.pbl || '-'}<br/>\n                <strong>Región</strong>: ${marker.Region || '-'}<br/>\n                <strong>Comuna</strong>: ${marker.Comuna || '-'}<br/>\n                ${marker.direccion ? `<strong>Dirección</strong>: ${marker.direccion}<br/>` : ''}\n                ${marker.eds ? `<strong>EDS</strong>: ${marker.eds}<br/>` : ''}\n              </div>\n              <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\n              <div class=\"popup-data\">\n                <strong>Precios</strong><br/>\n                G93: ${marker.preciog93 ? marker.preciog93 : 'NA'}<br/>\n                G95: ${marker.preciog95 ? marker.preciog95 : 'NA'}<br/>\n                Diesel: ${marker.preciodiesel ? marker.preciodiesel : 'NA'}<br/>\n              </div>\n              ${marker.GuerraPrecio === \"Si\" ? `\n                <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\n                <div class=\"popup-data\" style=\"color:#d32f2f;font-weight:bold\">Guerra de Precio Activa</div>\n              ` : ''}\n              <div style=\"margin-top:10px; display:flex; gap:8px;\">\n                <button id=\"btn-mercado\" style=\"padding:6px 10px;border:1px solid #1976d2;color:#1976d2;background:#fff;border-radius:4px;cursor:pointer\">\n                  Mercado\n                </button>\n              </div>\n            </div>\n          </div>\n        `;\n        const popup = L.popup({\n          autoClose: false,\n          closeOnClick: false,\n          keepInView: true,\n          autoPan: false\n        }).setContent(popupContent);\n        leafletMarker.bindPopup(popup);\n        leafletMarker.on(\"popupopen\", () => {\n          makeDraggable(popup);\n          const container = popup.getElement();\n          if (!container) return;\n          const btnMercado = container.querySelector(\"#btn-mercado\");\n          if (btnMercado) {\n            btnMercado.addEventListener(\"click\", e => {\n              e.stopPropagation();\n              showAssociatedIds(marker.pbl, lat, lng, marker.id);\n            });\n          }\n        });\n        leafletMarker.on(\"click\", () => {\n          leafletMarker.openPopup();\n        });\n\n        // Index por coordenadas para evitar duplicados\n        const key = `${lat.toFixed(6)}_${lng.toFixed(6)}`;\n        markersRef.current[key] = leafletMarker;\n      }\n    });\n  }, [makeDraggable]);\n  const clearMarkers = useCallback(() => {\n    if (!map) return;\n    Object.values(markersRef.current).forEach(marker => {\n      try {\n        if (map.hasLayer(marker)) map.removeLayer(marker);\n      } catch {}\n    });\n    markersRef.current = {};\n  }, [map]);\n  const updateIconsInViewport = useCallback((data, clearFirst = false) => {\n    if (!map || updateInProgressRef.current) return;\n    updateInProgressRef.current = true;\n    try {\n      if (clearFirst) clearMarkers();\n      addMarkers(data, map);\n    } finally {\n      updateInProgressRef.current = false;\n    }\n  }, [map, addMarkers, clearMarkers]);\n\n  // CORRECCIÓN: usar SIEMPRE markersForMercado para Mercado (sin EDS)\n  const showAssociatedIds = useCallback((pbl, lat, lng, originalMarkerId) => {\n    const searchArray = Array.isArray(markersForMercado) ? markersForMercado : [];\n    if (showingAssociated) {\n      setShowingAssociated(false);\n      setOriginalPopupMarker(null);\n      if (map && Array.isArray(markers) && markers.length > 0) {\n        updateIconsInViewport(markers, true);\n      }\n      return;\n    }\n    const associatedData = Array.isArray(baseCompData) ? baseCompData.filter(item => String(item.pbl).trim() === String(pbl).trim()) : [];\n    if (associatedData.length === 0) {\n      console.warn(\"Sin competencia para PBL\", pbl);\n      return;\n    }\n    const ids = associatedData.map(item => item.id);\n\n    // Guardar popup abierto (si lo hay) para actualizarlo luego\n    let openPopup = null;\n    if (map) {\n      map.eachLayer(layer => {\n        if (layer instanceof L.Marker && layer.popup && layer.popup.isOpen()) {\n          openPopup = layer.popup;\n        }\n      });\n    }\n\n    // Limpiar del mapa todo lo que no sea parte de la competencia\n    if (map) {\n      map.eachLayer(layer => {\n        if (layer instanceof L.Marker) {\n          const ll = layer.getLatLng();\n          const keep = ids.some(id => {\n            const m = searchArray.find(x => x.id === id);\n            if (!m) return false;\n            const mlat = Number(m.lat);\n            const mlng = Number(m.lng);\n            return mlat === ll.lat && mlng === ll.lng || Math.abs(mlat - ll.lat) < 1e-6 && Math.abs(mlng - ll.lng) < 1e-6;\n          });\n          if (!keep) {\n            try {\n              map.removeLayer(layer);\n            } catch {}\n          }\n        }\n      });\n      Object.values(markersRef.current).forEach(markerLayer => {\n        const ll = markerLayer.getLatLng();\n        const keep = ids.some(id => {\n          const m = searchArray.find(x => x.id === id);\n          if (!m) return false;\n          const mlat = Number(m.lat);\n          const mlng = Number(m.lng);\n          return mlat === ll.lat && mlng === ll.lng || Math.abs(mlat - ll.lat) < 1e-6 && Math.abs(mlng - ll.lng) < 1e-6;\n        });\n        if (!keep) {\n          try {\n            if (map.hasLayer(markerLayer)) map.removeLayer(markerLayer);\n          } catch {}\n        }\n      });\n    }\n\n    // Agregar marcadores competidores faltantes (desde la lista sin EDS)\n    const associatedMarkers = searchArray.filter(item => ids.includes(item.id));\n    associatedMarkers.forEach(marker => {\n      const latNum = parseFloat(marker.lat);\n      const lngNum = parseFloat(marker.lng);\n      if (isNaN(latNum) || isNaN(lngNum)) return;\n\n      // Evitar duplicados por coordenadas ya presentes\n      let exists = false;\n      if (map) {\n        map.eachLayer(layer => {\n          if (layer instanceof L.Marker) {\n            const mll = layer.getLatLng();\n            if (Math.abs(mll.lat - latNum) < 1e-12 && Math.abs(mll.lng - lngNum) < 1e-12) {\n              exists = true;\n            }\n          }\n        });\n      }\n      if (exists) return;\n      const iconUrl = createCustomIcon(marker.Marca);\n      const leafletMarker = L.marker([latNum, lngNum], {\n        icon: iconUrl\n      }).addTo(map);\n      let popupContent = `\n        <div class=\"popup-container\">\n          <div class=\"popup-header\">\n            <img src=\"${createBrandLogo(marker.Marca)}\" alt=\"${marker.Marca}\" style=\"width:30px;height:30px;border-radius:50%;object-fit:cover;margin-right:8px\" onerror=\"this.style.display='none'\"/>\n            <h3 style=\"margin:0\">${marker.nombre} - ${marker.Marca}</h3>\n          </div>\n          <div class=\"popup-content\">\n            <div class=\"popup-data\">\n              <strong>Marca</strong>: ${marker.Marca}<br/>\n              <strong>PBL</strong>: ${marker.pbl || '-'}<br/>\n              <strong>Región</strong>: ${marker.Region || '-'}<br/>\n              <strong>Comuna</strong>: ${marker.Comuna || '-'}<br/>\n              ${marker.direccion ? `<strong>Dirección</strong>: ${marker.direccion}<br/>` : ''}\n              ${marker.eds ? `<strong>EDS</strong>: ${marker.eds}<br/>` : ''}\n            </div>\n            <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\n            <div class=\"popup-data\">\n              <strong>Precios</strong><br/>\n              G93: ${marker.preciog93 ? marker.preciog93 : 'NA'}<br/>\n              G95: ${marker.preciog95 ? marker.preciog95 : 'NA'}<br/>\n              Diesel: ${marker.preciodiesel ? marker.preciodiesel : 'NA'}<br/>\n            </div>\n            ${marker.GuerraPrecio === \"Si\" ? `\n              <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\n              <div class=\"popup-data\" style=\"color:#d32f2f;font-weight:bold\">Guerra de Precio Activa</div>\n            ` : ''}\n          </div>\n        </div>\n      `;\n      const popup = L.popup({\n        autoClose: false,\n        closeOnClick: false,\n        keepInView: true,\n        autoPan: false\n      }).setContent(popupContent);\n      leafletMarker.bindPopup(popup);\n      leafletMarker.on(\"popupopen\", () => makeDraggable(popup));\n      leafletMarker.on(\"click\", () => leafletMarker.openPopup());\n    });\n    if (openPopup) {\n      setTimeout(() => {\n        try {\n          openPopup.update();\n        } catch {}\n      }, 50);\n    }\n    setShowingAssociated(true);\n  }, [baseCompData, markers, markersForMercado, map, makeDraggable, updateIconsInViewport, showingAssociated]);\n\n  // Render inicial y cuando cambien los filtros normales\n  useEffect(() => {\n    if (!map) return;\n    if (showingAssociated) return; // no pisar la vista Mercado\n    if (!markers || markers.length === 0) {\n      clearMarkers();\n      return;\n    }\n    updateIconsInViewport(markers, true);\n  }, [map, markers, clearMarkers, updateIconsInViewport, showingAssociated]);\n\n  // Manejo en cambios de zoom/pan si se requiere\n  useEffect(() => {\n    if (!map) return;\n    const onMoveEnd = () => {\n      if (showingAssociated) return;\n      if (!markers || markers.length === 0) {\n        clearMarkers();\n        return;\n      }\n      if (zoomUpdateRef.current) {\n        clearTimeout(zoomUpdateRef.current);\n      }\n      zoomUpdateRef.current = setTimeout(() => {\n        updateIconsInViewport(markers, true);\n      }, 80);\n    };\n    map.on(\"moveend\", onMoveEnd);\n    return () => {\n      map.off(\"moveend\", onMoveEnd);\n    };\n  }, [map, markers, updateIconsInViewport, clearMarkers, showingAssociated]);\n  return null;\n};\n_s(IconMarkersLayer, \"3L3OuZVidVht2mBckkm8l+1BX/8=\", false, function () {\n  return [useMap];\n});\n_c = IconMarkersLayer;\nexport default IconMarkersLayer;\nvar _c;\n$RefreshReg$(_c, \"IconMarkersLayer\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","useMap","L","createCustomIcon","createBrandLogo","IconMarkersLayer","markers","markersForMercado","selectedRegion","baseCompData","_s","map","markersRef","cacheRef","updateInProgressRef","zoomUpdateRef","showingAssociated","setShowingAssociated","originalPopupMarker","setOriginalPopupMarker","makeDraggable","popup","container","pos","latLngToLayerPoint","getLatLng","DomUtil","setPosition","wrapper","parentNode","draggable","Draggable","enable","error","console","addMarkers","data","mapInstance","forEach","marker","lat","parseFloat","lng","isNaN","iconUrl","Marca","leafletMarker","icon","addTo","popupContent","nombre","pbl","Region","Comuna","direccion","eds","preciog93","preciog95","preciodiesel","GuerraPrecio","autoClose","closeOnClick","keepInView","autoPan","setContent","bindPopup","on","getElement","btnMercado","querySelector","addEventListener","e","stopPropagation","showAssociatedIds","id","openPopup","key","toFixed","current","clearMarkers","Object","values","hasLayer","removeLayer","updateIconsInViewport","clearFirst","originalMarkerId","searchArray","Array","isArray","length","associatedData","filter","item","String","trim","warn","ids","eachLayer","layer","Marker","isOpen","ll","keep","some","m","find","x","mlat","Number","mlng","Math","abs","markerLayer","associatedMarkers","includes","latNum","lngNum","exists","mll","setTimeout","update","onMoveEnd","clearTimeout","off","_c","$RefreshReg$"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/IconMarkersLayer.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from \"react\";\r\nimport { useMap } from \"react-leaflet\";\r\nimport L from \"leaflet\";\r\nimport { createCustomIcon, createBrandLogo } from \"../utils/iconHelpers\";\r\n\r\nconst IconMarkersLayer = ({\r\n  markers,              // lista filtrada NORMAL (incluye EDS si está activo)\r\n  markersForMercado,    // lista filtrada SIN EDS (para Mercado)\r\n  selectedRegion,\r\n  baseCompData          // base para competencia por PBL\r\n}) => {\r\n  const map = useMap();\r\n  const markersRef = useRef({});\r\n  const cacheRef = useRef({});\r\n  const updateInProgressRef = useRef(false);\r\n  const zoomUpdateRef = useRef(null);\r\n\r\n  const [showingAssociated, setShowingAssociated] = useState(false);\r\n  const [originalPopupMarker, setOriginalPopupMarker] = useState(null);\r\n\r\n  const makeDraggable = useCallback((popup) => {\r\n    if (!map || !popup || !popup.container) return;\r\n    try {\r\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\r\n      L.DomUtil.setPosition(popup.wrapper.parentNode, pos);\r\n      const draggable = new L.Draggable(popup.container, popup.wrapper);\r\n      draggable.enable();\r\n    } catch (error) {\r\n      console.error(\"Error draggable\", error);\r\n    }\r\n  }, [map]);\r\n\r\n  // Añadir marcadores al mapa\r\n  const addMarkers = useCallback((data, mapInstance) => {\r\n    data.forEach((marker) => {\r\n      const lat = parseFloat(marker.lat);\r\n      const lng = parseFloat(marker.lng);\r\n      if (!isNaN(lat) && !isNaN(lng)) {\r\n        const iconUrl = createCustomIcon(marker.Marca);\r\n\r\n        const leafletMarker = L.marker([lat, lng], { icon: iconUrl }).addTo(mapInstance);\r\n\r\n        let popupContent = `\r\n          <div class=\"popup-container\">\r\n            <div class=\"popup-header\">\r\n              <img src=\"${createBrandLogo(marker.Marca)}\" alt=\"${marker.Marca}\" style=\"width:30px;height:30px;border-radius:50%;object-fit:cover;margin-right:8px\" onerror=\"this.style.display='none'\"/>\r\n              <h3 style=\"margin:0\">${marker.nombre} - ${marker.Marca}</h3>\r\n            </div>\r\n            <div class=\"popup-content\">\r\n              <div class=\"popup-data\">\r\n                <strong>Marca</strong>: ${marker.Marca}<br/>\r\n                <strong>PBL</strong>: ${marker.pbl || '-'}<br/>\r\n                <strong>Región</strong>: ${marker.Region || '-'}<br/>\r\n                <strong>Comuna</strong>: ${marker.Comuna || '-'}<br/>\r\n                ${marker.direccion ? `<strong>Dirección</strong>: ${marker.direccion}<br/>` : ''}\r\n                ${marker.eds ? `<strong>EDS</strong>: ${marker.eds}<br/>` : ''}\r\n              </div>\r\n              <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\r\n              <div class=\"popup-data\">\r\n                <strong>Precios</strong><br/>\r\n                G93: ${marker.preciog93 ? marker.preciog93 : 'NA'}<br/>\r\n                G95: ${marker.preciog95 ? marker.preciog95 : 'NA'}<br/>\r\n                Diesel: ${marker.preciodiesel ? marker.preciodiesel : 'NA'}<br/>\r\n              </div>\r\n              ${marker.GuerraPrecio === \"Si\" ? `\r\n                <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\r\n                <div class=\"popup-data\" style=\"color:#d32f2f;font-weight:bold\">Guerra de Precio Activa</div>\r\n              ` : ''}\r\n              <div style=\"margin-top:10px; display:flex; gap:8px;\">\r\n                <button id=\"btn-mercado\" style=\"padding:6px 10px;border:1px solid #1976d2;color:#1976d2;background:#fff;border-radius:4px;cursor:pointer\">\r\n                  Mercado\r\n                </button>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        `;\r\n\r\n        const popup = L.popup({\r\n          autoClose: false,\r\n          closeOnClick: false,\r\n          keepInView: true,\r\n          autoPan: false\r\n        }).setContent(popupContent);\r\n\r\n        leafletMarker.bindPopup(popup);\r\n\r\n        leafletMarker.on(\"popupopen\", () => {\r\n          makeDraggable(popup);\r\n          const container = popup.getElement();\r\n          if (!container) return;\r\n\r\n          const btnMercado = container.querySelector(\"#btn-mercado\");\r\n          if (btnMercado) {\r\n            btnMercado.addEventListener(\"click\", (e) => {\r\n              e.stopPropagation();\r\n              showAssociatedIds(marker.pbl, lat, lng, marker.id);\r\n            });\r\n          }\r\n        });\r\n\r\n        leafletMarker.on(\"click\", () => {\r\n          leafletMarker.openPopup();\r\n        });\r\n\r\n        // Index por coordenadas para evitar duplicados\r\n        const key = `${lat.toFixed(6)}_${lng.toFixed(6)}`;\r\n        markersRef.current[key] = leafletMarker;\r\n      }\r\n    });\r\n  }, [makeDraggable]);\r\n\r\n  const clearMarkers = useCallback(() => {\r\n    if (!map) return;\r\n    Object.values(markersRef.current).forEach((marker) => {\r\n      try {\r\n        if (map.hasLayer(marker)) map.removeLayer(marker);\r\n      } catch {}\r\n    });\r\n    markersRef.current = {};\r\n  }, [map]);\r\n\r\n  const updateIconsInViewport = useCallback((data, clearFirst = false) => {\r\n    if (!map || updateInProgressRef.current) return;\r\n    updateInProgressRef.current = true;\r\n\r\n    try {\r\n      if (clearFirst) clearMarkers();\r\n      addMarkers(data, map);\r\n    } finally {\r\n      updateInProgressRef.current = false;\r\n    }\r\n  }, [map, addMarkers, clearMarkers]);\r\n\r\n  // CORRECCIÓN: usar SIEMPRE markersForMercado para Mercado (sin EDS)\r\n  const showAssociatedIds = useCallback((pbl, lat, lng, originalMarkerId) => {\r\n    const searchArray = Array.isArray(markersForMercado) ? markersForMercado : [];\r\n\r\n    if (showingAssociated) {\r\n      setShowingAssociated(false);\r\n      setOriginalPopupMarker(null);\r\n      if (map && Array.isArray(markers) && markers.length > 0) {\r\n        updateIconsInViewport(markers, true);\r\n      }\r\n      return;\r\n    }\r\n\r\n    const associatedData = Array.isArray(baseCompData)\r\n      ? baseCompData.filter(item => String(item.pbl).trim() === String(pbl).trim())\r\n      : [];\r\n\r\n    if (associatedData.length === 0) {\r\n      console.warn(\"Sin competencia para PBL\", pbl);\r\n      return;\r\n    }\r\n\r\n    const ids = associatedData.map(item => item.id);\r\n\r\n    // Guardar popup abierto (si lo hay) para actualizarlo luego\r\n    let openPopup = null;\r\n    if (map) {\r\n      map.eachLayer(layer => {\r\n        if (layer instanceof L.Marker && layer.popup && layer.popup.isOpen()) {\r\n          openPopup = layer.popup;\r\n        }\r\n      });\r\n    }\r\n\r\n    // Limpiar del mapa todo lo que no sea parte de la competencia\r\n    if (map) {\r\n      map.eachLayer(layer => {\r\n        if (layer instanceof L.Marker) {\r\n          const ll = layer.getLatLng();\r\n          const keep = ids.some(id => {\r\n            const m = searchArray.find(x => x.id === id);\r\n            if (!m) return false;\r\n            const mlat = Number(m.lat);\r\n            const mlng = Number(m.lng);\r\n            return (\r\n              (mlat === ll.lat && mlng === ll.lng) ||\r\n              (Math.abs(mlat - ll.lat) < 1e-6 && Math.abs(mlng - ll.lng) < 1e-6)\r\n            );\r\n          });\r\n          if (!keep) {\r\n            try { map.removeLayer(layer); } catch {}\r\n          }\r\n        }\r\n      });\r\n\r\n      Object.values(markersRef.current).forEach(markerLayer => {\r\n        const ll = markerLayer.getLatLng();\r\n        const keep = ids.some(id => {\r\n          const m = searchArray.find(x => x.id === id);\r\n          if (!m) return false;\r\n          const mlat = Number(m.lat);\r\n          const mlng = Number(m.lng);\r\n          return (\r\n            (mlat === ll.lat && mlng === ll.lng) ||\r\n            (Math.abs(mlat - ll.lat) < 1e-6 && Math.abs(mlng - ll.lng) < 1e-6)\r\n          );\r\n        });\r\n        if (!keep) {\r\n          try {\r\n            if (map.hasLayer(markerLayer)) map.removeLayer(markerLayer);\r\n          } catch {}\r\n        }\r\n      });\r\n    }\r\n\r\n    // Agregar marcadores competidores faltantes (desde la lista sin EDS)\r\n    const associatedMarkers = searchArray.filter(item => ids.includes(item.id));\r\n\r\n    associatedMarkers.forEach(marker => {\r\n      const latNum = parseFloat(marker.lat);\r\n      const lngNum = parseFloat(marker.lng);\r\n      if (isNaN(latNum) || isNaN(lngNum)) return;\r\n\r\n      // Evitar duplicados por coordenadas ya presentes\r\n      let exists = false;\r\n      if (map) {\r\n        map.eachLayer(layer => {\r\n          if (layer instanceof L.Marker) {\r\n            const mll = layer.getLatLng();\r\n            if (Math.abs(mll.lat - latNum) < 1e-12 && Math.abs(mll.lng - lngNum) < 1e-12) {\r\n              exists = true;\r\n            }\r\n          }\r\n        });\r\n      }\r\n      if (exists) return;\r\n\r\n      const iconUrl = createCustomIcon(marker.Marca);\r\n      const leafletMarker = L.marker([latNum, lngNum], { icon: iconUrl }).addTo(map);\r\n\r\n      let popupContent = `\r\n        <div class=\"popup-container\">\r\n          <div class=\"popup-header\">\r\n            <img src=\"${createBrandLogo(marker.Marca)}\" alt=\"${marker.Marca}\" style=\"width:30px;height:30px;border-radius:50%;object-fit:cover;margin-right:8px\" onerror=\"this.style.display='none'\"/>\r\n            <h3 style=\"margin:0\">${marker.nombre} - ${marker.Marca}</h3>\r\n          </div>\r\n          <div class=\"popup-content\">\r\n            <div class=\"popup-data\">\r\n              <strong>Marca</strong>: ${marker.Marca}<br/>\r\n              <strong>PBL</strong>: ${marker.pbl || '-'}<br/>\r\n              <strong>Región</strong>: ${marker.Region || '-'}<br/>\r\n              <strong>Comuna</strong>: ${marker.Comuna || '-'}<br/>\r\n              ${marker.direccion ? `<strong>Dirección</strong>: ${marker.direccion}<br/>` : ''}\r\n              ${marker.eds ? `<strong>EDS</strong>: ${marker.eds}<br/>` : ''}\r\n            </div>\r\n            <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\r\n            <div class=\"popup-data\">\r\n              <strong>Precios</strong><br/>\r\n              G93: ${marker.preciog93 ? marker.preciog93 : 'NA'}<br/>\r\n              G95: ${marker.preciog95 ? marker.preciog95 : 'NA'}<br/>\r\n              Diesel: ${marker.preciodiesel ? marker.preciodiesel : 'NA'}<br/>\r\n            </div>\r\n            ${marker.GuerraPrecio === \"Si\" ? `\r\n              <hr style=\"margin:10px 0;border:none;border-top:1px solid #e0e0e0\"/>\r\n              <div class=\"popup-data\" style=\"color:#d32f2f;font-weight:bold\">Guerra de Precio Activa</div>\r\n            ` : ''}\r\n          </div>\r\n        </div>\r\n      `;\r\n\r\n      const popup = L.popup({\r\n        autoClose: false,\r\n        closeOnClick: false,\r\n        keepInView: true,\r\n        autoPan: false\r\n      }).setContent(popupContent);\r\n\r\n      leafletMarker.bindPopup(popup);\r\n      leafletMarker.on(\"popupopen\", () => makeDraggable(popup));\r\n      leafletMarker.on(\"click\", () => leafletMarker.openPopup());\r\n    });\r\n\r\n    if (openPopup) {\r\n      setTimeout(() => {\r\n        try { openPopup.update(); } catch {}\r\n      }, 50);\r\n    }\r\n\r\n    setShowingAssociated(true);\r\n  }, [baseCompData, markers, markersForMercado, map, makeDraggable, updateIconsInViewport, showingAssociated]);\r\n\r\n  // Render inicial y cuando cambien los filtros normales\r\n  useEffect(() => {\r\n    if (!map) return;\r\n    if (showingAssociated) return; // no pisar la vista Mercado\r\n    if (!markers || markers.length === 0) {\r\n      clearMarkers();\r\n      return;\r\n    }\r\n    updateIconsInViewport(markers, true);\r\n  }, [map, markers, clearMarkers, updateIconsInViewport, showingAssociated]);\r\n\r\n  // Manejo en cambios de zoom/pan si se requiere\r\n  useEffect(() => {\r\n    if (!map) return;\r\n\r\n    const onMoveEnd = () => {\r\n      if (showingAssociated) return;\r\n      if (!markers || markers.length === 0) {\r\n        clearMarkers();\r\n        return;\r\n      }\r\n      if (zoomUpdateRef.current) {\r\n        clearTimeout(zoomUpdateRef.current);\r\n      }\r\n      zoomUpdateRef.current = setTimeout(() => {\r\n        updateIconsInViewport(markers, true);\r\n      }, 80);\r\n    };\r\n\r\n    map.on(\"moveend\", onMoveEnd);\r\n    return () => {\r\n      map.off(\"moveend\", onMoveEnd);\r\n    };\r\n  }, [map, markers, updateIconsInViewport, clearMarkers, showingAssociated]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default IconMarkersLayer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}