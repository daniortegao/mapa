{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\e08f\\\\Desktop\\\\Proyectos\\\\Resumen\\\\mapa-v2\\\\src\\\\components\\\\IconMarkersLayer.jsx\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { useMap } from 'react-leaflet';\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\nimport L from 'leaflet';\nimport ReactDOM from 'react-dom/client';\nimport { createCustomIcon } from '../utils/iconHelpers';\nimport { guardarCoordenadaCorregida } from '../services/apiService';\nimport TrendChart from '../components/TrendChart';\nimport '../styles/iconMarkersLayer.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.css';\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst IconMarkersLayer = ({\n  markers,\n  markersForMercado = null,\n  selectedRegion,\n  baseCompData = []\n}) => {\n  _s();\n  const map = useMap();\n  const markersRef = useRef({});\n  const guerraMarkersRef = useRef({});\n  const cacheRef = useRef({});\n  const updateInProgressRef = useRef(false);\n  const zoomUpdateRef = useRef(null);\n  const [showingAssociated, setShowingAssociated] = useState(false);\n  const [originalPopupMarker, setOriginalPopupMarker] = useState(null);\n  const [activeMercadoPbl, setActiveMercadoPbl] = useState(null);\n  const competenciaMarkersRef = useRef([]);\n  const polylineRef = useRef([]);\n  const [debugTable, setDebugTable] = useState(null);\n  const [maxHeight, setMaxHeight] = useState(500);\n  const [activeTab, setActiveTab] = useState('precios');\n  const [modoCorreccion, setModoCorreccion] = useState(null);\n\n  // Hacer popup draggable\n  const makeDraggable = useCallback(popup => {\n    if (!map || !popup || !popup._container) return;\n    try {\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\n      L.DomUtil.setPosition(popup._wrapper.parentNode, pos);\n      const draggable = new L.Draggable(popup._container, popup._wrapper);\n      draggable.enable();\n    } catch (error) {\n      console.error('Error draggable:', error);\n    }\n  }, [map]);\n  const clearCompetenciaMarkers = useCallback(() => {\n    competenciaMarkersRef.current.forEach(marker => {\n      try {\n        if (map && map.hasLayer(marker)) {\n          map.removeLayer(marker);\n        }\n      } catch (e) {\n        console.error('Error limpiando competencia:', e);\n      }\n    });\n    competenciaMarkersRef.current = [];\n  }, [map]);\n  const clearPolylines = useCallback(() => {\n    polylineRef.current.forEach(polyline => {\n      try {\n        if (map && map.hasLayer(polyline)) {\n          map.removeLayer(polyline);\n        }\n      } catch (e) {\n        console.error('Error limpiando polyline:', e);\n      }\n    });\n    polylineRef.current = [];\n  }, [map]);\n  const clearAssociatedMarkers = useCallback(() => {\n    clearCompetenciaMarkers();\n    clearPolylines();\n    setShowingAssociated(false);\n    setOriginalPopupMarker(null);\n    setActiveMercadoPbl(null);\n  }, [clearCompetenciaMarkers, clearPolylines]);\n  const showAssociatedMarkers = useCallback((markerData, markerInstance) => {\n    if (showingAssociated) {\n      clearAssociatedMarkers();\n      return;\n    }\n    const pblNumber = String(markerData.pbl);\n    const mercadoData = markersForMercado && markersForMercado[pblNumber];\n    if (!mercadoData || mercadoData.length === 0) {\n      alert('No hay marcadores asociados para este punto.');\n      return;\n    }\n    setShowingAssociated(true);\n    setOriginalPopupMarker(markerInstance);\n    setActiveMercadoPbl(pblNumber);\n    mercadoData.forEach(comp => {\n      const compMarker = L.marker([comp.lat, comp.lng], {\n        icon: createCustomIcon(comp.logo),\n        zIndexOffset: 1000\n      }).addTo(map);\n      const popupContent = `\n        <div style=\"min-width: 200px;\">\n          <strong>${comp.nombre || 'Estación'}</strong><br/>\n          <b>Marca:</b> ${comp.Marca}<br/>\n          <b>Comuna:</b> ${comp.Comuna}<br/>\n          <b>Dirección:</b> ${comp.direccion}<br/>\n        </div>\n      `;\n      compMarker.bindPopup(popupContent);\n      competenciaMarkersRef.current.push(compMarker);\n      const polyline = L.polyline([[markerData.lat, markerData.lng], [comp.lat, comp.lng]], {\n        color: 'blue',\n        weight: 2,\n        opacity: 0.6,\n        dashArray: '5, 10'\n      }).addTo(map);\n      polylineRef.current.push(polyline);\n    });\n  }, [map, markersForMercado, showingAssociated, clearAssociatedMarkers]);\n  const handleCorreccionClick = useCallback(marker => {\n    if (modoCorreccion === marker.pbl) {\n      setModoCorreccion(null);\n      map.off('click');\n    } else {\n      setModoCorreccion(marker.pbl);\n      const onMapClick = async e => {\n        const {\n          lat,\n          lng\n        } = e.latlng;\n        const confirmed = window.confirm(`¿Guardar nueva coordenada para ${marker.nombre}?\\nLat: ${lat.toFixed(6)}, Lng: ${lng.toFixed(6)}`);\n        if (confirmed) {\n          try {\n            await guardarCoordenadaCorregida({\n              pbl: marker.pbl,\n              id: marker.id,\n              latcorregida: lat,\n              loncorregida: lng\n            });\n            alert('Coordenada guardada correctamente');\n            setModoCorreccion(null);\n            map.off('click', onMapClick);\n            window.location.reload();\n          } catch (error) {\n            console.error('Error guardando coordenada:', error);\n            alert('Error al guardar la coordenada');\n          }\n        }\n      };\n      map.on('click', onMapClick);\n    }\n  }, [map, modoCorreccion]);\n  const createPopupContent = useCallback((marker, markerInstance) => {\n    const container = document.createElement('div');\n    container.style.minWidth = '270px';\n    const headerDiv = document.createElement('div');\n    headerDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;';\n    const title = document.createElement('strong');\n    title.textContent = marker.nombre || 'Estación';\n    headerDiv.appendChild(title);\n    const gripDiv = document.createElement('div');\n    gripDiv.className = 'popup-grip';\n    gripDiv.innerHTML = '⋮⋮';\n    gripDiv.style.cssText = 'cursor: move; font-size: 18px; color: #666;';\n    headerDiv.appendChild(gripDiv);\n    container.appendChild(headerDiv);\n    const tabsDiv = document.createElement('div');\n    tabsDiv.className = 'popup-tabs';\n    tabsDiv.style.cssText = 'display: flex; gap: 5px; margin-bottom: 10px; border-bottom: 1px solid #ddd;';\n    const tabPrecios = document.createElement('button');\n    tabPrecios.textContent = 'Precios';\n    tabPrecios.className = activeTab === 'precios' ? 'active-tab' : '';\n    tabPrecios.onclick = () => {\n      setActiveTab('precios');\n      createPopupContent(marker, markerInstance);\n    };\n    const tabInfo = document.createElement('button');\n    tabInfo.textContent = 'Info';\n    tabInfo.className = activeTab === 'info' ? 'active-tab' : '';\n    tabInfo.onclick = () => {\n      setActiveTab('info');\n      createPopupContent(marker, markerInstance);\n    };\n    tabsDiv.appendChild(tabPrecios);\n    tabsDiv.appendChild(tabInfo);\n    container.appendChild(tabsDiv);\n    const contentDiv = document.createElement('div');\n    if (activeTab === 'precios') {\n      contentDiv.innerHTML = `\n          <div><b>G93:</b> $${marker.preciog93 || '-'}</div>\n          <div><b>G95:</b> $${marker.preciog95 || '-'}</div>\n          <div><b>G97:</b> $${marker.preciog97 || '-'}</div>\n          <div><b>Diesel:</b> $${marker.preciodiesel || '-'}</div>\n          <div><b>Kerosene:</b> $${marker.preciokero || '-'}</div>\n          <div style=\"margin-top: 8px;\"><b>Actualización:</b> ${marker.Actualizacion || '-'}</div>\n        `;\n      if (marker.Guerra_Precio === 'Si') {\n        const warningDiv = document.createElement('div');\n        warningDiv.style.cssText = 'color: red; margin-top: 8px; font-weight: bold;';\n        warningDiv.textContent = '⚠️ Guerra de Precio';\n        contentDiv.appendChild(warningDiv);\n      }\n      if (baseCompData && baseCompData.length > 0) {\n        const chartContainer = document.createElement('div');\n        chartContainer.id = `chart-${marker.pbl}`;\n        chartContainer.style.cssText = 'margin-top: 10px; max-height: 200px;';\n        contentDiv.appendChild(chartContainer);\n        setTimeout(() => {\n          const root = ReactDOM.createRoot(chartContainer);\n          root.render(/*#__PURE__*/_jsxDEV(TrendChart, {\n            datos: baseCompData\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 25\n          }, this));\n        }, 100);\n      }\n    } else if (activeTab === 'info') {\n      var _marker$lat, _marker$lng;\n      contentDiv.innerHTML = `\n          <div><b>Marca:</b> ${marker.Marca || '-'}</div>\n          <div><b>Dirección:</b> ${marker.direccion || '-'}</div>\n          <div><b>Región:</b> ${marker.Region || '-'}</div>\n          <div><b>Comuna:</b> ${marker.Comuna || '-'}</div>\n          <div><b>PBL:</b> ${marker.pbl || '-'}</div>\n          <div style=\"margin-top: 8px;\">\n            <b>Coordenadas:</b><br/>\n            Lat: ${((_marker$lat = marker.lat) === null || _marker$lat === void 0 ? void 0 : _marker$lat.toFixed(6)) || '-'}<br/>\n            Lng: ${((_marker$lng = marker.lng) === null || _marker$lng === void 0 ? void 0 : _marker$lng.toFixed(6)) || '-'}\n          </div>\n        `;\n    }\n    container.appendChild(contentDiv);\n    const actionsDiv = document.createElement('div');\n    actionsDiv.style.cssText = 'margin-top: 10px; display: flex; gap: 5px; flex-wrap: wrap;';\n    const btnMercado = document.createElement('button');\n    btnMercado.textContent = showingAssociated && activeMercadoPbl === String(marker.pbl) ? 'Ocultar Mercado' : 'Ver Mercado';\n    btnMercado.onclick = () => showAssociatedMarkers(marker, markerInstance);\n    btnMercado.style.cssText = 'padding: 5px 10px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer;';\n    actionsDiv.appendChild(btnMercado);\n    const btnCorregir = document.createElement('button');\n    btnCorregir.textContent = modoCorreccion === marker.pbl ? 'Cancelar Corrección' : 'Corregir Coordenada';\n    btnCorregir.onclick = () => handleCorreccionClick(marker);\n    btnCorregir.style.cssText = `padding: 5px 10px; background: ${modoCorreccion === marker.pbl ? '#dc3545' : '#28a745'}; color: white; border: none; border-radius: 3px; cursor: pointer;`;\n    actionsDiv.appendChild(btnCorregir);\n    container.appendChild(actionsDiv);\n    return container;\n  }, [activeTab, baseCompData, showingAssociated, activeMercadoPbl, modoCorreccion, showAssociatedMarkers, handleCorreccionClick]);\n  useEffect(() => {\n    if (!map || !markers || markers.length === 0) return;\n    if (updateInProgressRef.current) return;\n    updateInProgressRef.current = true;\n    Object.values(markersRef.current).forEach(marker => {\n      try {\n        if (map.hasLayer(marker)) {\n          map.removeLayer(marker);\n        }\n      } catch (e) {\n        console.error('Error removiendo marker:', e);\n      }\n    });\n    markersRef.current = {};\n    guerraMarkersRef.current = {};\n    const clusterGroup = L.markerClusterGroup({\n      showCoverageOnHover: false,\n      maxClusterRadius: 50,\n      spiderfyOnMaxZoom: true,\n      disableClusteringAtZoom: 15\n    });\n    markers.forEach(marker => {\n      if (!marker.lat || !marker.lng) return;\n      const customIcon = createCustomIcon(marker.logo);\n      const leafletMarker = L.marker([marker.lat, marker.lng], {\n        icon: customIcon\n      });\n      leafletMarker.on('click', () => {\n        const popupContent = createPopupContent(marker, leafletMarker);\n        leafletMarker.unbindPopup();\n        const popup = L.popup({\n          maxWidth: 350,\n          minWidth: 270,\n          maxHeight: maxHeight,\n          className: 'custom-popup'\n        }).setLatLng([marker.lat, marker.lng]).setContent(popupContent).openOn(map);\n        popup.on('remove', () => {\n          if (activeMercadoPbl === String(marker.pbl)) {\n            clearAssociatedMarkers();\n          }\n        });\n        setTimeout(() => {\n          makeDraggable(popup);\n        }, 100);\n      });\n      clusterGroup.addLayer(leafletMarker);\n      markersRef.current[marker.id] = leafletMarker;\n      if (marker.Guerra_Precio === 'Si') {\n        guerraMarkersRef.current[marker.id] = leafletMarker;\n      }\n    });\n    map.addLayer(clusterGroup);\n    updateInProgressRef.current = false;\n    return () => {\n      try {\n        if (map.hasLayer(clusterGroup)) {\n          map.removeLayer(clusterGroup);\n        }\n      } catch (e) {\n        console.error('Error en cleanup:', e);\n      }\n    };\n  }, [markers, map, createPopupContent, makeDraggable, maxHeight, clearAssociatedMarkers, activeMercadoPbl]);\n  useEffect(() => {\n    return () => {\n      clearAssociatedMarkers();\n      if (modoCorreccion) {\n        map.off('click');\n      }\n    };\n  }, [clearAssociatedMarkers, modoCorreccion, map]);\n  return null;\n};\n_s(IconMarkersLayer, \"1osh3HecBoBhWUIf/bcCXSvI3tQ=\", false, function () {\n  return [useMap];\n});\n_c = IconMarkersLayer;\nexport default IconMarkersLayer;\nvar _c;\n$RefreshReg$(_c, \"IconMarkersLayer\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","useMap","MarkerClusterGroup","L","ReactDOM","createCustomIcon","guardarCoordenadaCorregida","TrendChart","jsxDEV","_jsxDEV","IconMarkersLayer","markers","markersForMercado","selectedRegion","baseCompData","_s","map","markersRef","guerraMarkersRef","cacheRef","updateInProgressRef","zoomUpdateRef","showingAssociated","setShowingAssociated","originalPopupMarker","setOriginalPopupMarker","activeMercadoPbl","setActiveMercadoPbl","competenciaMarkersRef","polylineRef","debugTable","setDebugTable","maxHeight","setMaxHeight","activeTab","setActiveTab","modoCorreccion","setModoCorreccion","makeDraggable","popup","_container","pos","latLngToLayerPoint","getLatLng","DomUtil","setPosition","_wrapper","parentNode","draggable","Draggable","enable","error","console","clearCompetenciaMarkers","current","forEach","marker","hasLayer","removeLayer","e","clearPolylines","polyline","clearAssociatedMarkers","showAssociatedMarkers","markerData","markerInstance","pblNumber","String","pbl","mercadoData","length","alert","comp","compMarker","lat","lng","icon","logo","zIndexOffset","addTo","popupContent","nombre","Marca","Comuna","direccion","bindPopup","push","color","weight","opacity","dashArray","handleCorreccionClick","off","onMapClick","latlng","confirmed","window","confirm","toFixed","id","latcorregida","loncorregida","location","reload","on","createPopupContent","container","document","createElement","style","minWidth","headerDiv","cssText","title","textContent","appendChild","gripDiv","className","innerHTML","tabsDiv","tabPrecios","onclick","tabInfo","contentDiv","preciog93","preciog95","preciog97","preciodiesel","preciokero","Actualizacion","Guerra_Precio","warningDiv","chartContainer","setTimeout","root","createRoot","render","datos","fileName","_jsxFileName","lineNumber","columnNumber","_marker$lat","_marker$lng","Region","actionsDiv","btnMercado","btnCorregir","Object","values","clusterGroup","markerClusterGroup","showCoverageOnHover","maxClusterRadius","spiderfyOnMaxZoom","disableClusteringAtZoom","customIcon","leafletMarker","unbindPopup","maxWidth","setLatLng","setContent","openOn","addLayer","_c","$RefreshReg$"],"sources":["C:/Users/e08f/Desktop/Proyectos/Resumen/mapa-v2/src/components/IconMarkersLayer.jsx"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { useMap } from 'react-leaflet';\r\nimport MarkerClusterGroup from 'react-leaflet-markercluster';\r\nimport L from 'leaflet';\r\nimport ReactDOM from 'react-dom/client';\r\nimport { createCustomIcon } from '../utils/iconHelpers';\r\nimport { guardarCoordenadaCorregida } from '../services/apiService';\r\nimport TrendChart from '../components/TrendChart';\r\nimport '../styles/iconMarkersLayer.css';\r\nimport 'leaflet.markercluster/dist/MarkerCluster.css';\r\nimport 'leaflet.markercluster/dist/MarkerCluster.Default.css';\r\n\r\nconst IconMarkersLayer = ({ markers, markersForMercado = null, selectedRegion, baseCompData = [] }) => {\r\n  const map = useMap();\r\n  const markersRef = useRef({});\r\n  const guerraMarkersRef = useRef({});\r\n  const cacheRef = useRef({});\r\n  const updateInProgressRef = useRef(false);\r\n  const zoomUpdateRef = useRef(null);\r\n\r\n  const [showingAssociated, setShowingAssociated] = useState(false);\r\n  const [originalPopupMarker, setOriginalPopupMarker] = useState(null);\r\n  const [activeMercadoPbl, setActiveMercadoPbl] = useState(null);\r\n\r\n  const competenciaMarkersRef = useRef([]);\r\n  const polylineRef = useRef([]);\r\n\r\n  const [debugTable, setDebugTable] = useState(null);\r\n  const [maxHeight, setMaxHeight] = useState(500);\r\n  const [activeTab, setActiveTab] = useState('precios');\r\n  const [modoCorreccion, setModoCorreccion] = useState(null);\r\n\r\n  // Hacer popup draggable\r\n  const makeDraggable = useCallback((popup) => {\r\n    if (!map || !popup || !popup._container) return;\r\n    try {\r\n      const pos = map.latLngToLayerPoint(popup.getLatLng());\r\n      L.DomUtil.setPosition(popup._wrapper.parentNode, pos);\r\n      const draggable = new L.Draggable(popup._container, popup._wrapper);\r\n      draggable.enable();\r\n    } catch (error) {\r\n      console.error('Error draggable:', error);\r\n    }\r\n  }, [map]);\r\n\r\n  const clearCompetenciaMarkers = useCallback(() => {\r\n    competenciaMarkersRef.current.forEach(marker => {\r\n      try {\r\n        if (map && map.hasLayer(marker)) {\r\n          map.removeLayer(marker);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error limpiando competencia:', e);\r\n      }\r\n    });\r\n    competenciaMarkersRef.current = [];\r\n  }, [map]);\r\n\r\n  const clearPolylines = useCallback(() => {\r\n    polylineRef.current.forEach(polyline => {\r\n      try {\r\n        if (map && map.hasLayer(polyline)) {\r\n          map.removeLayer(polyline);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error limpiando polyline:', e);\r\n      }\r\n    });\r\n    polylineRef.current = [];\r\n  }, [map]);\r\n\r\n  const clearAssociatedMarkers = useCallback(() => {\r\n    clearCompetenciaMarkers();\r\n    clearPolylines();\r\n    setShowingAssociated(false);\r\n    setOriginalPopupMarker(null);\r\n    setActiveMercadoPbl(null);\r\n  }, [clearCompetenciaMarkers, clearPolylines]);\r\n\r\n    const showAssociatedMarkers = useCallback((markerData, markerInstance) => {\r\n    if (showingAssociated) {\r\n      clearAssociatedMarkers();\r\n      return;\r\n    }\r\n\r\n    const pblNumber = String(markerData.pbl);\r\n    const mercadoData = markersForMercado && markersForMercado[pblNumber];\r\n\r\n    if (!mercadoData || mercadoData.length === 0) {\r\n      alert('No hay marcadores asociados para este punto.');\r\n      return;\r\n    }\r\n\r\n    setShowingAssociated(true);\r\n    setOriginalPopupMarker(markerInstance);\r\n    setActiveMercadoPbl(pblNumber);\r\n\r\n    mercadoData.forEach((comp) => {\r\n      const compMarker = L.marker([comp.lat, comp.lng], {\r\n        icon: createCustomIcon(comp.logo),\r\n        zIndexOffset: 1000,\r\n      }).addTo(map);\r\n\r\n      const popupContent = `\r\n        <div style=\"min-width: 200px;\">\r\n          <strong>${comp.nombre || 'Estación'}</strong><br/>\r\n          <b>Marca:</b> ${comp.Marca}<br/>\r\n          <b>Comuna:</b> ${comp.Comuna}<br/>\r\n          <b>Dirección:</b> ${comp.direccion}<br/>\r\n        </div>\r\n      `;\r\n\r\n      compMarker.bindPopup(popupContent);\r\n      competenciaMarkersRef.current.push(compMarker);\r\n\r\n      const polyline = L.polyline(\r\n        [\r\n          [markerData.lat, markerData.lng],\r\n          [comp.lat, comp.lng],\r\n        ],\r\n        {\r\n          color: 'blue',\r\n          weight: 2,\r\n          opacity: 0.6,\r\n          dashArray: '5, 10',\r\n        }\r\n      ).addTo(map);\r\n\r\n      polylineRef.current.push(polyline);\r\n    });\r\n  }, [map, markersForMercado, showingAssociated, clearAssociatedMarkers]);\r\n\r\n  const handleCorreccionClick = useCallback((marker) => {\r\n    if (modoCorreccion === marker.pbl) {\r\n      setModoCorreccion(null);\r\n      map.off('click');\r\n    } else {\r\n      setModoCorreccion(marker.pbl);\r\n\r\n      const onMapClick = async (e) => {\r\n        const { lat, lng } = e.latlng;\r\n        const confirmed = window.confirm(\r\n          `¿Guardar nueva coordenada para ${marker.nombre}?\\nLat: ${lat.toFixed(6)}, Lng: ${lng.toFixed(6)}`\r\n        );\r\n\r\n        if (confirmed) {\r\n          try {\r\n            await guardarCoordenadaCorregida({\r\n              pbl: marker.pbl,\r\n              id: marker.id,\r\n              latcorregida: lat,\r\n              loncorregida: lng,\r\n            });\r\n            alert('Coordenada guardada correctamente');\r\n            setModoCorreccion(null);\r\n            map.off('click', onMapClick);\r\n            window.location.reload();\r\n          } catch (error) {\r\n            console.error('Error guardando coordenada:', error);\r\n            alert('Error al guardar la coordenada');\r\n          }\r\n        }\r\n      };\r\n\r\n      map.on('click', onMapClick);\r\n    }\r\n  }, [map, modoCorreccion]);\r\n\r\n  const createPopupContent = useCallback(\r\n    (marker, markerInstance) => {\r\n      const container = document.createElement('div');\r\n      container.style.minWidth = '270px';\r\n\r\n      const headerDiv = document.createElement('div');\r\n      headerDiv.style.cssText = 'display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;';\r\n\r\n      const title = document.createElement('strong');\r\n      title.textContent = marker.nombre || 'Estación';\r\n      headerDiv.appendChild(title);\r\n\r\n      const gripDiv = document.createElement('div');\r\n      gripDiv.className = 'popup-grip';\r\n      gripDiv.innerHTML = '⋮⋮';\r\n      gripDiv.style.cssText = 'cursor: move; font-size: 18px; color: #666;';\r\n      headerDiv.appendChild(gripDiv);\r\n\r\n      container.appendChild(headerDiv);\r\n\r\n      const tabsDiv = document.createElement('div');\r\n      tabsDiv.className = 'popup-tabs';\r\n      tabsDiv.style.cssText = 'display: flex; gap: 5px; margin-bottom: 10px; border-bottom: 1px solid #ddd;';\r\n\r\n      const tabPrecios = document.createElement('button');\r\n      tabPrecios.textContent = 'Precios';\r\n      tabPrecios.className = activeTab === 'precios' ? 'active-tab' : '';\r\n      tabPrecios.onclick = () => {\r\n        setActiveTab('precios');\r\n        createPopupContent(marker, markerInstance);\r\n      };\r\n\r\n      const tabInfo = document.createElement('button');\r\n      tabInfo.textContent = 'Info';\r\n      tabInfo.className = activeTab === 'info' ? 'active-tab' : '';\r\n      tabInfo.onclick = () => {\r\n        setActiveTab('info');\r\n        createPopupContent(marker, markerInstance);\r\n      };\r\n\r\n      tabsDiv.appendChild(tabPrecios);\r\n      tabsDiv.appendChild(tabInfo);\r\n      container.appendChild(tabsDiv);\r\n\r\n      const contentDiv = document.createElement('div');\r\n\r\n      if (activeTab === 'precios') {\r\n        contentDiv.innerHTML = `\r\n          <div><b>G93:</b> $${marker.preciog93 || '-'}</div>\r\n          <div><b>G95:</b> $${marker.preciog95 || '-'}</div>\r\n          <div><b>G97:</b> $${marker.preciog97 || '-'}</div>\r\n          <div><b>Diesel:</b> $${marker.preciodiesel || '-'}</div>\r\n          <div><b>Kerosene:</b> $${marker.preciokero || '-'}</div>\r\n          <div style=\"margin-top: 8px;\"><b>Actualización:</b> ${marker.Actualizacion || '-'}</div>\r\n        `;\r\n\r\n        if (marker.Guerra_Precio === 'Si') {\r\n          const warningDiv = document.createElement('div');\r\n          warningDiv.style.cssText = 'color: red; margin-top: 8px; font-weight: bold;';\r\n          warningDiv.textContent = '⚠️ Guerra de Precio';\r\n          contentDiv.appendChild(warningDiv);\r\n        }\r\n\r\n        if (baseCompData && baseCompData.length > 0) {\r\n          const chartContainer = document.createElement('div');\r\n          chartContainer.id = `chart-${marker.pbl}`;\r\n          chartContainer.style.cssText = 'margin-top: 10px; max-height: 200px;';\r\n          contentDiv.appendChild(chartContainer);\r\n\r\n          setTimeout(() => {\r\n            const root = ReactDOM.createRoot(chartContainer);\r\n            root.render(<TrendChart datos={baseCompData} />);\r\n          }, 100);\r\n        }\r\n      } else if (activeTab === 'info') {\r\n        contentDiv.innerHTML = `\r\n          <div><b>Marca:</b> ${marker.Marca || '-'}</div>\r\n          <div><b>Dirección:</b> ${marker.direccion || '-'}</div>\r\n          <div><b>Región:</b> ${marker.Region || '-'}</div>\r\n          <div><b>Comuna:</b> ${marker.Comuna || '-'}</div>\r\n          <div><b>PBL:</b> ${marker.pbl || '-'}</div>\r\n          <div style=\"margin-top: 8px;\">\r\n            <b>Coordenadas:</b><br/>\r\n            Lat: ${marker.lat?.toFixed(6) || '-'}<br/>\r\n            Lng: ${marker.lng?.toFixed(6) || '-'}\r\n          </div>\r\n        `;\r\n      }\r\n\r\n      container.appendChild(contentDiv);\r\n\r\n      const actionsDiv = document.createElement('div');\r\n      actionsDiv.style.cssText = 'margin-top: 10px; display: flex; gap: 5px; flex-wrap: wrap;';\r\n\r\n      const btnMercado = document.createElement('button');\r\n      btnMercado.textContent = showingAssociated && activeMercadoPbl === String(marker.pbl) \r\n        ? 'Ocultar Mercado' \r\n        : 'Ver Mercado';\r\n      btnMercado.onclick = () => showAssociatedMarkers(marker, markerInstance);\r\n      btnMercado.style.cssText = 'padding: 5px 10px; background: #007bff; color: white; border: none; border-radius: 3px; cursor: pointer;';\r\n      actionsDiv.appendChild(btnMercado);\r\n\r\n      const btnCorregir = document.createElement('button');\r\n      btnCorregir.textContent = modoCorreccion === marker.pbl ? 'Cancelar Corrección' : 'Corregir Coordenada';\r\n      btnCorregir.onclick = () => handleCorreccionClick(marker);\r\n      btnCorregir.style.cssText = `padding: 5px 10px; background: ${modoCorreccion === marker.pbl ? '#dc3545' : '#28a745'}; color: white; border: none; border-radius: 3px; cursor: pointer;`;\r\n      actionsDiv.appendChild(btnCorregir);\r\n\r\n      container.appendChild(actionsDiv);\r\n\r\n      return container;\r\n    },\r\n    [activeTab, baseCompData, showingAssociated, activeMercadoPbl, modoCorreccion, showAssociatedMarkers, handleCorreccionClick]\r\n  );\r\n\r\n    useEffect(() => {\r\n    if (!map || !markers || markers.length === 0) return;\r\n\r\n    if (updateInProgressRef.current) return;\r\n    updateInProgressRef.current = true;\r\n\r\n    Object.values(markersRef.current).forEach((marker) => {\r\n      try {\r\n        if (map.hasLayer(marker)) {\r\n          map.removeLayer(marker);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error removiendo marker:', e);\r\n      }\r\n    });\r\n\r\n    markersRef.current = {};\r\n    guerraMarkersRef.current = {};\r\n\r\n    const clusterGroup = L.markerClusterGroup({\r\n      showCoverageOnHover: false,\r\n      maxClusterRadius: 50,\r\n      spiderfyOnMaxZoom: true,\r\n      disableClusteringAtZoom: 15,\r\n    });\r\n\r\n    markers.forEach((marker) => {\r\n      if (!marker.lat || !marker.lng) return;\r\n\r\n      const customIcon = createCustomIcon(marker.logo);\r\n      const leafletMarker = L.marker([marker.lat, marker.lng], {\r\n        icon: customIcon,\r\n      });\r\n\r\n      leafletMarker.on('click', () => {\r\n        const popupContent = createPopupContent(marker, leafletMarker);\r\n\r\n        leafletMarker.unbindPopup();\r\n        const popup = L.popup({\r\n          maxWidth: 350,\r\n          minWidth: 270,\r\n          maxHeight: maxHeight,\r\n          className: 'custom-popup',\r\n        })\r\n          .setLatLng([marker.lat, marker.lng])\r\n          .setContent(popupContent)\r\n          .openOn(map);\r\n\r\n        popup.on('remove', () => {\r\n          if (activeMercadoPbl === String(marker.pbl)) {\r\n            clearAssociatedMarkers();\r\n          }\r\n        });\r\n\r\n        setTimeout(() => {\r\n          makeDraggable(popup);\r\n        }, 100);\r\n      });\r\n\r\n      clusterGroup.addLayer(leafletMarker);\r\n      markersRef.current[marker.id] = leafletMarker;\r\n\r\n      if (marker.Guerra_Precio === 'Si') {\r\n        guerraMarkersRef.current[marker.id] = leafletMarker;\r\n      }\r\n    });\r\n\r\n    map.addLayer(clusterGroup);\r\n\r\n    updateInProgressRef.current = false;\r\n\r\n    return () => {\r\n      try {\r\n        if (map.hasLayer(clusterGroup)) {\r\n          map.removeLayer(clusterGroup);\r\n        }\r\n      } catch (e) {\r\n        console.error('Error en cleanup:', e);\r\n      }\r\n    };\r\n  }, [markers, map, createPopupContent, makeDraggable, maxHeight, clearAssociatedMarkers, activeMercadoPbl]);\r\n  useEffect(() => {\r\n    return () => {\r\n      clearAssociatedMarkers();\r\n      if (modoCorreccion) {\r\n        map.off('click');\r\n      }\r\n    };\r\n  }, [clearAssociatedMarkers, modoCorreccion, map]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default IconMarkersLayer;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}